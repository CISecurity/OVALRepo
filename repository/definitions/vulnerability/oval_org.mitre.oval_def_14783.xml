<definition xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5" class="vulnerability" id="oval:org.mitre.oval:def:14783" version="18">
  <metadata>
    <title>ADO Cachesize Heap Overflow RCE Vulnerability - MS12-045</title>
    <affected family="windows">
      <platform>Microsoft Windows XP</platform>
      <platform>Microsoft Windows Server 2003</platform>
      <platform>Microsoft Windows Server 2008</platform>
      <platform>Microsoft Windows Server 2008 R2</platform>
      <platform>Microsoft Windows Vista</platform>
      <platform>Microsoft Windows 7</platform>
      <product>Microsoft Data Access Components</product>
    </affected>
    <reference ref_id="CVE-2012-1891" ref_url="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-1891" source="CVE" />
    <description>Heap-based buffer overflow in Microsoft Data Access Components (MDAC) 2.8 SP1 and SP2 and Windows Data Access Components (WDAC) 6.0 allows remote attackers to execute arbitrary code via crafted XML data that triggers access to an uninitialized object in memory, aka "ADO Cachesize Heap Overflow RCE Vulnerability."</description>
    <oval_repository>
      <dates>
        <submitted date="2012-07-13T13:50:14">
          <contributor organization="SecPod Technologies">SecPod Team</contributor>
        </submitted>
        <status_change date="2012-07-13T11:30:10.553-04:00">DRAFT</status_change>
        <modified comment="EDITED oval:org.mitre.oval:ste:12418 - Patch Tuesday - 7/2012 - also added comment to state." date="2012-07-13T11:28:00.032-04:00">
          <contributor organization="SecPod Technologies">Chandan S</contributor>
        </modified>
        <status_change date="2012-07-30T04:00:10.777-04:00">INTERIM</status_change>
        <status_change date="2012-08-20T04:00:04.866-04:00">ACCEPTED</status_change>
        <modified comment="EDITED oval:org.mitre.oval:tst:42207 - contains tests with modified comments and all dependences" date="2014-02-13T12:19:00.287-05:00">
          <contributor organization="ALTX-SOFT">Maria Mikhno</contributor>
        </modified>
        <status_change date="2014-02-13T12:22:36.216-05:00">INTERIM</status_change>
        <status_change date="2014-03-03T04:00:46.945-05:00">ACCEPTED</status_change>
        <modified comment="EDITED oval:org.mitre.oval:def:14783 - extended definitions of OS are without SP checks" date="2014-07-28T17:52:00.359-04:00">
          <contributor organization="ALTX-SOFT">Maria Mikhno</contributor>
        </modified>
        <status_change date="2014-07-28T17:54:18.917-04:00">INTERIM</status_change>
        <status_change date="2014-08-18T04:01:08.096-04:00">ACCEPTED</status_change>
        <modified comment="EDITED oval:org.mitre.oval:def:14783 - Modified vulnerabilities - a lot of fixes" date="2015-07-22T13:37:00.619-04:00">
          <contributor organization="ALTX-SOFT">Maria Mikhno</contributor>
        </modified>
        <status_change date="2015-07-22T13:39:51.110-04:00">INTERIM</status_change>
        <status_change date="2015-08-10T04:00:17.131-04:00">ACCEPTED</status_change>
      </dates>
      <status>ACCEPTED</status>
      <min_schema_version>5.4</min_schema_version>
    </oval_repository>
  </metadata>
  <criteria>
    <extend_definition comment="Microsoft Data Access Components is installed" definition_ref="oval:org.mitre.oval:def:29323" />
    <criteria operator="OR">
      <criteria comment="Win XP and vulnerable version of MDAC" operator="AND">
        <criterion comment="Check if the version of msado15.dll is less than 2.81.3014.0" test_ref="oval:org.mitre.oval:tst:79768" />
        <extend_definition comment="Microsoft Windows XP (32-bit) is installed" definition_ref="oval:org.mitre.oval:def:1353" />
      </criteria>
      <criteria comment="Win XP X64/ 2K3 and vuln version of MDAC" operator="AND">
        <criteria comment="Win XP X64/2K3" operator="OR">
          <extend_definition comment="Microsoft Windows XP x64 is installed" definition_ref="oval:org.mitre.oval:def:15247" />
          <extend_definition comment="Microsoft Windows Server 2003 (32-bit) is installed" definition_ref="oval:org.mitre.oval:def:1870" />
          <extend_definition comment="Microsoft Windows Server 2003 (ia64) Gold is installed" definition_ref="oval:org.mitre.oval:def:396" />
          <extend_definition comment="Microsoft Windows Server 2003 (x64) is installed" definition_ref="oval:org.mitre.oval:def:730" />
        </criteria>
        <criterion comment="Check if the version of Msado15.dll is less than 2.82.5011.0" test_ref="oval:org.mitre.oval:tst:79883" />
      </criteria>
      <criteria comment="Vista /2K8 and vulnerable version of WDAC" operator="AND">
        <criteria comment="Win 2k8 / Vista" operator="OR">
          <extend_definition comment="Microsoft Windows Vista (32-bit) is installed" definition_ref="oval:org.mitre.oval:def:1282" />
          <extend_definition comment="Microsoft Windows Server 2008 (32-bit) is installed" definition_ref="oval:org.mitre.oval:def:4870" />
          <extend_definition comment="Microsoft Windows Server 2008 (64-bit) is installed" definition_ref="oval:org.mitre.oval:def:5356" />
          <extend_definition comment="Microsoft Windows Vista x64 Edition is installed" definition_ref="oval:org.mitre.oval:def:2041" />
          <extend_definition comment="Microsoft Windows Server 2008 (ia-64) is installed" definition_ref="oval:org.mitre.oval:def:5667" />
        </criteria>
        <criteria comment="Check for vulnerable version of WDAC" operator="OR">
          <criterion comment="Check if the version of Msado15.dll is less than 6.0.6002.18644" test_ref="oval:org.mitre.oval:tst:79662" />
          <criteria comment="Check for LDR" operator="AND">
            <criterion comment="Check if the version of Msado15.dll is less than 6.0.6002.22869" test_ref="oval:org.mitre.oval:tst:79399" />
            <criterion comment="the version of msado15.dll is greater than or equal 6.0.6002.22000" test_ref="oval:org.mitre.oval:tst:42108" />
          </criteria>
        </criteria>
      </criteria>
      <criteria comment="Win 7 / 2k8 R2 and vulnerable WDAC version" operator="AND">
        <criteria comment="Win 7 / 2K8 R2" operator="OR">
          <extend_definition comment="Microsoft Windows 7 is installed" definition_ref="oval:org.mitre.oval:def:12541" />
          <extend_definition comment="Microsoft Windows Server 2008 R2 x64 Edition is installed" definition_ref="oval:org.mitre.oval:def:6438" />
          <extend_definition comment="Microsoft Windows Server 2008 R2 Itanium-Based Edition is installed" definition_ref="oval:org.mitre.oval:def:5954" />
        </criteria>
        <criteria comment="Check for vulnerable version" operator="OR">
          <criterion comment="Check if the version of Msado15.dll is less than 6.1.7600.17036" test_ref="oval:org.mitre.oval:tst:79859" />
          <criteria comment="Check for LDR" operator="AND">
            <criterion comment="Check if the version of Msado15.dll is less than 6.1.7600.21227" test_ref="oval:org.mitre.oval:tst:79593" />
            <criterion comment="the version of msado15.dll is greater than or equal 6.1.7600.20000" test_ref="oval:org.mitre.oval:tst:42207" />
          </criteria>
        </criteria>
      </criteria>
      <criteria comment="Win 7 / 2K8 R2 and vulnerable WDAC version" operator="AND">
        <criteria comment="Win 7 / Win 2k8 R2" operator="OR">
          <extend_definition comment="Microsoft Windows 7 x64 Edition is installed" definition_ref="oval:org.mitre.oval:def:5950" />
          <extend_definition comment="Microsoft Windows Server 2008 R2 Itanium-Based Edition is installed" definition_ref="oval:org.mitre.oval:def:5954" />
          <extend_definition comment="Microsoft Windows Server 2008 R2 x64 Edition is installed" definition_ref="oval:org.mitre.oval:def:6438" />
        </criteria>
        <criteria comment="Check for vulnerable WDAC version" operator="OR">
          <criterion comment="Check if the version of Msado15.dll is less than 6.1.7601.17857" test_ref="oval:org.mitre.oval:tst:79958" />
          <criteria comment="Check for LDR" operator="AND">
            <criterion comment="Check if the version of Msado15.dll is greater than or equal to 6.1.7601.21000" test_ref="oval:org.mitre.oval:tst:79243" />
            <criterion comment="Check if the version of Msado15.dll is less than 6.1.7601.22012" test_ref="oval:org.mitre.oval:tst:79737" />
          </criteria>
        </criteria>
      </criteria>
    </criteria>
  </criteria>
</definition>
