<definition xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5" class="vulnerability" id="oval:org.mitre.oval:def:15621" version="64">
  <metadata>
    <title>GDI+ Record Type Vulnerability</title>
    <affected family="windows">
      <platform>Microsoft Windows XP</platform>
      <platform>Microsoft Windows Vista</platform>
      <platform>Microsoft Windows 7</platform>
      <platform>Microsoft Windows Server 2003</platform>
      <platform>Microsoft Windows Server 2008</platform>
      <platform>Microsoft Windows Server 2008 R2</platform>
      <product>Microsoft Office 2003</product>
      <product>Microsoft Office 2007</product>
      <product>Microsoft Office 2010</product>
    </affected>
    <reference ref_id="CVE-2012-0165" ref_url="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-0165" source="CVE" />
    <description>GDI+ in Microsoft Windows Vista SP2 and Server 2008 SP2 and Office 2003 SP3, 2007 SP2 and SP3, and 2010 Gold and SP1 does not properly validate record types in EMF images, which allows remote attackers to execute arbitrary code via a crafted image, aka "GDI+ Record Type Vulnerability."</description>
    <oval_repository>
      <dates>
        <submitted date="2012-05-08T13:00:00">
          <contributor organization="Symantec Corporation">Dragos Prisaca</contributor>
        </submitted>
        <status_change date="2012-05-18T16:55:21.613-04:00">DRAFT</status_change>
        <status_change date="2012-06-04T04:01:12.225-04:00">INTERIM</status_change>
        <status_change date="2012-06-25T04:00:32.594-04:00">ACCEPTED</status_change>
        <modified comment="EDITED oval:org.mitre.oval:obj:7442 - The test with object obj:7442 on 32-bit system returned &quot;error&quot;" date="2013-08-07T15:55:00.393-04:00">
          <contributor organization="ALTX-SOFT">Maria Kedovskaya</contributor>
        </modified>
        <status_change date="2013-08-07T15:56:56.014-04:00">INTERIM</status_change>
        <status_change date="2013-08-26T04:00:08.457-04:00">ACCEPTED</status_change>
        <modified comment="EDITED oval:org.mitre.oval:obj:26264 - Negate=&quot;true&quot; was removed because of returning &quot;true&quot; value if the file gdiplus.dll does not exists." date="2013-11-01T13:11:00.105-04:00">
          <contributor organization="ALTX-SOFT">Maria Kedovskaya</contributor>
        </modified>
        <status_change date="2013-11-01T13:13:43.574-04:00">INTERIM</status_change>
        <status_change date="2013-11-18T04:00:07.661-05:00">ACCEPTED</status_change>
        <modified comment="EDITED oval:org.mitre.oval:tst:79868 - False Positive - MS12-034 oval:org.mitre.oval:def:15466" date="2013-11-21T13:18:00.738-05:00">
          <contributor organization="ALTX-SOFT">Maria Kedovskaya</contributor>
        </modified>
        <status_change date="2013-11-21T13:21:15.593-05:00">INTERIM</status_change>
        <status_change date="2013-12-09T04:00:07.388-05:00">ACCEPTED</status_change>
        <modified comment="EDITED oval:org.mitre.oval:var:1887 - Updating criterion logic and check attributes for Gdiplus.dll related Objects." date="2013-12-30T09:14:00.018-05:00">
          <contributor organization="ALTX-SOFT">Maria Kedovskaya</contributor>
        </modified>
        <status_change date="2013-12-30T09:17:40.680-05:00">INTERIM</status_change>
        <status_change date="2014-01-20T04:00:14.468-05:00">ACCEPTED</status_change>
        <modified comment="EDITED oval:org.mitre.oval:ste:19061 - modified states" date="2014-02-13T12:23:00.044-05:00">
          <contributor organization="ALTX-SOFT">Maria Mikhno</contributor>
        </modified>
        <status_change date="2014-02-13T12:24:18.619-05:00">INTERIM</status_change>
        <status_change date="2014-03-03T04:00:52.519-05:00">ACCEPTED</status_change>
        <modified comment="EDITED oval:org.mitre.oval:tst:79597 - check=&quot;all&quot; was replased with check=&quot;at least one&quot; because all objects have the set of objects." date="2014-03-21T13:14:00.094-04:00">
          <contributor organization="ALTX-SOFT">Maria Mikhno</contributor>
        </modified>
        <status_change date="2014-03-21T13:17:54.842-04:00">INTERIM</status_change>
        <status_change date="2014-04-07T04:01:58.221-04:00">ACCEPTED</status_change>
        <modified comment="EDITED oval:org.mitre.oval:obj:309 - Modified criteria to match MS bulletin" date="2014-06-13T14:52:00.642-04:00">
          <contributor organization="ALTX-SOFT">Maria Mikhno</contributor>
        </modified>
        <status_change date="2014-06-13T14:56:16.197-04:00">INTERIM</status_change>
        <status_change date="2014-06-30T04:05:55.745-04:00">ACCEPTED</status_change>
        <modified comment="EDITED oval:org.mitre.oval:def:15621 - extended definitions of OS are without SP checks" date="2014-07-28T17:34:00.316-04:00">
          <contributor organization="ALTX-SOFT">Maria Mikhno</contributor>
        </modified>
        <status_change date="2014-07-28T17:36:12.015-04:00">INTERIM</status_change>
        <status_change date="2014-08-18T04:01:20.803-04:00">ACCEPTED</status_change>
        <modified comment="EDITED oval:org.mitre.oval:obj:23616 - Updated to check both registry branches." date="2015-02-02T15:28:00.070-05:00">
          <contributor organization="ALTX-SOFT">Maria Mikhno</contributor>
        </modified>
        <status_change date="2015-02-02T15:30:37.096-05:00">INTERIM</status_change>
        <status_change date="2015-02-23T04:00:42.257-05:00">ACCEPTED</status_change>
      </dates>
      <status>ACCEPTED</status>
      <min_schema_version>5.10</min_schema_version>
    </oval_repository>
  </metadata>
  <criteria operator="OR">
    <criteria comment="Vulnerable Windows Vista x86/x64, Server 2008 x86/x64 (KB2659262)" operator="AND">
      <criteria comment="Windows Vista x86/x64, Server 2008 x86/x64" operator="OR">
        <extend_definition comment="Microsoft Windows Vista (32-bit) is installed" definition_ref="oval:org.mitre.oval:def:1282" />
        <extend_definition comment="Microsoft Windows Vista x64 Edition is installed" definition_ref="oval:org.mitre.oval:def:2041" />
        <extend_definition comment="Microsoft Windows Server 2008 (32-bit) is installed" definition_ref="oval:org.mitre.oval:def:4870" />
        <extend_definition comment="Microsoft Windows Server 2008 (64-bit) is installed" definition_ref="oval:org.mitre.oval:def:5356" />
      </criteria>
      <criteria comment="GDR or LDR Service branch" operator="OR">
        <criterion comment="the version of Jntfiltr.dll is less than 6.0.6002.18579" test_ref="oval:org.mitre.oval:tst:79914" />
        <criteria comment="LDR" operator="AND">
          <criterion comment="the version of Jntfiltr.dll is greater than or equal 6.0.6002.22000" test_ref="oval:org.mitre.oval:tst:79483" />
          <criterion comment="the version of Jntfiltr.dll is less than 6.0.6002.22789" test_ref="oval:org.mitre.oval:tst:79965" />
        </criteria>
      </criteria>
    </criteria>
    <criteria comment="Vulnerable Windows Vista x86/x64, Server 2008 x86/x64/ia64 (KB2659262)" operator="AND">
      <criteria comment="Windows Vista x86/x64, Server 2008 x86/x64/ia64" operator="OR">
        <extend_definition comment="Microsoft Windows Vista (32-bit) is installed" definition_ref="oval:org.mitre.oval:def:1282" />
        <extend_definition comment="Microsoft Windows Vista x64 Edition is installed" definition_ref="oval:org.mitre.oval:def:2041" />
        <extend_definition comment="Microsoft Windows Server 2008 (32-bit) is installed" definition_ref="oval:org.mitre.oval:def:4870" />
        <extend_definition comment="Microsoft Windows Server 2008 (64-bit) is installed" definition_ref="oval:org.mitre.oval:def:5356" />
        <extend_definition comment="Microsoft Windows Server 2008 (ia-64) is installed" definition_ref="oval:org.mitre.oval:def:5667" />
      </criteria>
      <criterion comment="the version of gdiplus.dll is less than 6.0.6002.22795" test_ref="oval:org.mitre.oval:tst:79868" />
    </criteria>
    <criteria comment="Vulnerable Microsoft Windows Vista x86/x64, Server 2008 32bit/x64/ia64 (KB2676562)" operator="AND">
      <criteria comment="Windows Vista x86/x64, Server 2008 32bit/x64/ia64" operator="OR">
        <extend_definition comment="Microsoft Windows Vista (32-bit) is installed" definition_ref="oval:org.mitre.oval:def:1282" />
        <extend_definition comment="Microsoft Windows Vista x64 Edition is installed" definition_ref="oval:org.mitre.oval:def:2041" />
        <extend_definition comment="Microsoft Windows Server 2008 (32-bit) is installed" definition_ref="oval:org.mitre.oval:def:4870" />
        <extend_definition comment="Microsoft Windows Server 2008 (64-bit) is installed" definition_ref="oval:org.mitre.oval:def:5356" />
        <extend_definition comment="Microsoft Windows Server 2008 (ia-64) is installed" definition_ref="oval:org.mitre.oval:def:5667" />
      </criteria>
      <criteria comment="GDR or LDR Service branch" operator="OR">
        <criterion comment="the version of win32k.sys is less than 6.0.6002.18607" test_ref="oval:org.mitre.oval:tst:79496" />
        <criteria comment="LDR" operator="AND">
          <criterion comment="the version of win32k.sys is less than 6.0.6002.22831" test_ref="oval:org.mitre.oval:tst:79932" />
          <criterion comment="the version of win32k.sys is greater than or equal to 6.0.6002.22000" test_ref="oval:org.mitre.oval:tst:43635" />
        </criteria>
      </criteria>
    </criteria>
    <criteria comment="Microsoft Office 2003 (KB2598253)" operator="AND">
      <extend_definition comment="Microsoft Office 2003 is installed" definition_ref="oval:org.mitre.oval:def:233" />
      <criterion comment="GDIPlus.dll version is less than 11.0.8345.0" test_ref="oval:org.mitre.oval:tst:79288" />
    </criteria>
    <criteria comment="Microsoft Office 2007 (KB2596672/KB2596792)" operator="AND">
      <extend_definition comment="Microsoft Office 2007 is installed" definition_ref="oval:org.mitre.oval:def:1211" />
      <criteria comment="KB2596672/KB2596792" operator="OR">
        <criterion comment="the version of Mspcore.dll is less than 12.0.6658.5001" test_ref="oval:org.mitre.oval:tst:79597" />
        <criterion comment="the version of Ogl.dll is less than 12.0.6659.5000" test_ref="oval:org.mitre.oval:tst:79830" />
      </criteria>
    </criteria>
    <criteria comment="Microsoft Office 2010 (KB2589337)" operator="AND">
      <extend_definition comment="Microsoft Office 2010 is installed" definition_ref="oval:org.mitre.oval:def:12061" />
      <criterion comment="the version of Ogl.dll is less than 14.0.6117.5001" test_ref="oval:org.mitre.oval:tst:79894" />
    </criteria>
  </criteria>
</definition>
