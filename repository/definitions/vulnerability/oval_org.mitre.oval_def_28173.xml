<?xml version="1.0" encoding="UTF-8"?>
<definition id="oval:org.mitre.oval:def:28173" version="4" class="vulnerability" xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:oval="http://oval.mitre.org/XMLSchema/oval-common-5" xmlns:oval-def="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <metadata>
    <title>Active Directory Federation Services information disclosure vulnerability - CVE-2014-6331 (MS14-077)</title>
    <affected family="windows">
      <platform>Microsoft Windows Server 2008</platform>
      <platform>Microsoft Windows Server 2008 R2</platform>
      <platform>Microsoft Windows Server 2012</platform>
      <platform>Microsoft Windows Server 2012 R2</platform>
      <product>Microsoft Active Directory Federation Services</product>
    </affected>
    <reference source="CVE" ref_id="CVE-2014-6331" ref_url="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-6331"/>
    <description>Microsoft Active Directory Federation Services (AD FS) 2.0, 2.1, and 3.0, when a configured SAML Relying Party lacks a sign-out endpoint, does not properly process logoff actions, which makes it easier for remote attackers to obtain access by leveraging an unattended workstation, aka "Active Directory Federation Services Information Disclosure Vulnerability."</description>
    <oval_repository>
      <dates>
        <submitted date="2014-11-17T18:08:29">
          <contributor organization="SecPod Technologies">SecPod Team</contributor>
        </submitted>
        <status_change date="2014-11-20T22:58:21.687-05:00">DRAFT</status_change>
        <modified comment="EDITED oval:org.mitre.oval:var:1686 - New Vulnerability Definition for MS14-077. Update to MS13-066 bulletin." date="2014-11-20T22:54:00.583-05:00">
          <contributor organization="SecPod Technologies">Saurabh Kumar</contributor>
        </modified>
        <status_change date="2014-12-08T04:00:57.358-05:00">INTERIM</status_change>
        <status_change date="2014-12-29T04:00:32.671-05:00">ACCEPTED</status_change>
      </dates>
      <status>ACCEPTED</status>
      <min_schema_version>5.10</min_schema_version>
    </oval_repository>
  </metadata>
  <criteria operator="OR">
    <criteria operator="AND" comment="2.0/2008 x86/version">
      <criteria operator="OR" comment="ldr/gdr">
        <criterion comment="Check if the version of microsoft.identityserver.dll is less than 6.1.7601.18622" test_ref="oval:org.mitre.oval:tst:135725"/>
        <criteria operator="AND" comment="LDR ranges">
          <criterion comment="Check if the version of microsoft.identityserver.dll is less than 6.1.7601.22828" test_ref="oval:org.mitre.oval:tst:135751"/>
          <criterion comment="Check if the version of microsoft.identityserver.dll is greater than or equal to 6.1.7601.22000" test_ref="oval:org.mitre.oval:tst:86583"/>
        </criteria>
      </criteria>
      <extend_definition comment="Microsoft Windows Server 2008 (32-bit) is installed" definition_ref="oval:org.mitre.oval:def:4870"/>
      <criterion comment="Check if Active Directory Federation Services 2.x is installed (server 2008 and R2)" test_ref="oval:org.mitre.oval:tst:135175"/>
    </criteria>
    <criteria operator="AND" comment="2.0/2008 x64/ 2008 R2/version">
      <criteria operator="OR" comment="either os">
        <extend_definition comment="Microsoft Windows Server 2008 (64-bit) is installed" definition_ref="oval:org.mitre.oval:def:5356"/>
        <extend_definition comment="Microsoft Windows Server 2008 R2 x64 Edition is installed" definition_ref="oval:org.mitre.oval:def:6438"/>
      </criteria>
      <criteria operator="OR" comment="ldr/gdr">
        <criterion comment="Check if the version of microsoft.identityserver.dll is less than 6.1.7601.18620" test_ref="oval:org.mitre.oval:tst:135535"/>
        <criteria operator="AND" comment="LDR ranges">
          <criterion comment="Check if the version of microsoft.identityserver.dll is less than 6.1.7601.22827" test_ref="oval:org.mitre.oval:tst:135656"/>
          <criterion comment="Check if the version of microsoft.identityserver.dll is greater than or equal to 6.1.7601.22000" test_ref="oval:org.mitre.oval:tst:86583"/>
        </criteria>
      </criteria>
      <criterion comment="Check if Active Directory Federation Services 2.x is installed (server 2008 and R2)" test_ref="oval:org.mitre.oval:tst:135175"/>
    </criteria>
    <criteria operator="AND" comment="2.0/2012/version">
      <extend_definition comment="Microsoft Windows Server 2012 (64-bit) is installed" definition_ref="oval:org.mitre.oval:def:15585"/>
      <criteria operator="OR" comment="ldr/gdr">
        <criterion comment="Check if the version of microsoft.identityserver.dll is less than 6.2.9200.17135" test_ref="oval:org.mitre.oval:tst:135667"/>
        <criteria operator="AND" comment="LDR ranges">
          <criterion comment="Check if the version of microsoft.identityserver.dll is less than 6.2.9200.21252" test_ref="oval:org.mitre.oval:tst:135457"/>
          <criterion comment="Check if the version of microsoft.identityserver.dll is greater than or equal to 6.2.9200.21000" test_ref="oval:org.mitre.oval:tst:135291"/>
        </criteria>
      </criteria>
      <criterion comment="Check if Active Directory Federation Services is installed (Server 2012 and 2012 R2)" test_ref="oval:org.mitre.oval:tst:135495"/>
    </criteria>
    <criteria operator="AND" comment="3.0/versions">
      <extend_definition comment="Microsoft Windows Server 2012 R2 is installed" definition_ref="oval:org.mitre.oval:def:18858"/>
      <criterion comment="Check if the version of Microsoft.identityserver.dll is less than 6.3.9600.17412" test_ref="oval:org.mitre.oval:tst:135733"/>
      <criterion comment="Check if Active Directory Federation Services is installed (Server 2012 and 2012 R2)" test_ref="oval:org.mitre.oval:tst:135495"/>
    </criteria>
  </criteria>
</definition>