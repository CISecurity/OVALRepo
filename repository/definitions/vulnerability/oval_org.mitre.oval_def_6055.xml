<definition xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5" class="vulnerability" id="oval:org.mitre.oval:def:6055" version="42">
  <metadata>
    <title>GDI+ VML Buffer Overrun Vulnerability</title>
    <affected family="windows">
      <platform>Microsoft Windows 2000</platform>
      <platform>Microsoft Windows Server 2003</platform>
      <platform>Microsoft Windows Server 2008</platform>
      <platform>Microsoft Windows Vista</platform>
      <platform>Microsoft Windows XP</platform>
      <product>Microsoft Internet Explorer 6</product>
      <product>Microsoft Office 2003</product>
      <product>Microsoft Office 2007</product>
      <product>Microsoft Office Visio 2002</product>
      <product>Microsoft Office XP</product>
      <product>Microsoft PowerPoint Viewer</product>
      <product>Microsoft SQL Server 2005</product>
    </affected>
    <reference ref_id="CVE-2007-5348" ref_url="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-5348" source="CVE" />
    <description>Integer overflow in GDI+ in Microsoft Internet Explorer 6 SP1, Windows XP SP2 and SP3, Server 2003 SP1 and SP2, Vista Gold and SP1, Server 2008, Office XP SP3, Office 2003 SP2 and SP3, 2007 Microsoft Office System Gold and SP1, Visio 2002 SP2, PowerPoint Viewer 2003, Works 8, Digital Image Suite 2006, SQL Server 2000 Reporting Services SP2, SQL Server 2005 SP2, Report Viewer 2005 SP1 and 2008, and Forefront Client Security 1.0 allows remote attackers to execute arbitrary code via an image file with crafted gradient sizes in gradient fill input, which triggers a heap-based buffer overflow related to GdiPlus.dll and VGX.DLL, aka "GDI+ VML Buffer Overrun Vulnerability."</description>
    <oval_repository>
      <dates>
        <submitted date="2008-09-09T13:58:00">
          <contributor organization="Secure Elements, Inc.">Sudhir Gandhe</contributor>
        </submitted>
        <status_change date="2008-09-12T12:48:55.613-04:00">DRAFT</status_change>
        <modified comment="Fixed string literal for regular expression compatibility." date="2008-09-19T16:49:00.088-04:00">
          <contributor organization="Hewlett-Packard">Todd Dolinsky</contributor>
        </modified>
        <status_change date="2008-10-06T04:00:18.899-04:00">INTERIM</status_change>
        <status_change date="2008-10-27T04:00:33.341-04:00">ACCEPTED</status_change>
        <modified comment="Changed product &quot;Office 2002&quot; to &quot;Office XP&quot;" date="2010-01-14T15:50:00.550-05:00">
          <contributor organization="The MITRE Corporation">Mike Lah</contributor>
        </modified>
        <status_change date="2010-01-14T15:50:48.556-05:00">INTERIM</status_change>
        <status_change date="2010-02-01T04:00:19.806-05:00">ACCEPTED</status_change>
        <modified comment="Edited var:309 - Added beginning anchor to local_variable used in pattern match" date="2010-05-13T15:48:00.238-04:00">
          <contributor organization="The MITRE Corporation">Mike Lah</contributor>
        </modified>
        <status_change date="2010-05-13T15:49:47.515-04:00">INTERIM</status_change>
        <status_change date="2010-05-31T04:00:15.245-04:00">ACCEPTED</status_change>
        <modified comment="EDITED oval:org.mitre.oval:ste:4158 - Added LDR support for WinVista and Win2008, MSSQL 2005 SP2 inclusion &amp; updated version in ste:4158" date="2011-12-05T13:24:00.281-05:00">
          <contributor organization="SecPod Technologies">Pradeep R B</contributor>
        </modified>
        <status_change date="2011-12-05T13:29:10.976-05:00">INTERIM</status_change>
        <status_change date="2011-12-26T04:02:54.166-05:00">ACCEPTED</status_change>
        <modified comment="EDITED oval:org.mitre.oval:obj:12103 - Fixed several false positives by setting negate = true.  Also fixed several style issues." date="2011-12-28T21:13:00.551-05:00">
          <contributor organization="Symantec Corporation">Dragos Prisaca</contributor>
        </modified>
        <status_change date="2011-12-28T21:21:30.007-05:00">INTERIM</status_change>
        <status_change date="2012-01-16T04:03:11.153-05:00">ACCEPTED</status_change>
        <modified comment="EDITED oval:org.mitre.oval:obj:309 - New Microsoft Patch Tuesday May 2012 definitions." date="2012-05-18T15:40:00.554-04:00">
          <contributor organization="Symantec Corporation">Josh Turpin</contributor>
        </modified>
        <status_change date="2012-05-18T15:48:49.765-04:00">INTERIM</status_change>
        <status_change date="2012-06-04T04:02:00.903-04:00">ACCEPTED</status_change>
        <modified comment="EDITED oval:org.mitre.oval:var:309 - Added closing anchors for variable regex" date="2013-04-08T11:01:00.574-04:00">
          <contributor organization="G2, Inc.">Shane Shaffer</contributor>
        </modified>
        <status_change date="2013-04-08T11:04:11.683-04:00">INTERIM</status_change>
        <status_change date="2013-04-29T04:17:39.983-04:00">ACCEPTED</status_change>
        <modified comment="EDITED oval:org.mitre.oval:obj:6109 - MS bulletin for July 2013 - MS13-052, MS13-053 and MS13-054" date="2013-07-17T15:58:00.089-04:00">
          <contributor organization="SecPod Technologies">Sharath S</contributor>
        </modified>
        <status_change date="2013-07-17T18:23:05.702-04:00">INTERIM</status_change>
        <status_change date="2013-08-05T04:01:10.098-04:00">ACCEPTED</status_change>
        <modified comment="EDITED oval:org.mitre.oval:obj:12081 - string var_check=&quot;all&quot; was replaced with var_check=&quot;at least one&quot;" date="2013-09-19T17:46:00.990-04:00">
          <contributor organization="ALTX-SOFT">Maria Kedovskaya</contributor>
        </modified>
        <status_change date="2013-09-19T17:48:53.184-04:00">INTERIM</status_change>
        <status_change date="2013-10-07T04:11:50.638-04:00">ACCEPTED</status_change>
        <modified comment="EDITED oval:org.mitre.oval:var:1887 - Updating criterion logic and check attributes for Gdiplus.dll related Objects." date="2013-12-30T09:14:00.018-05:00">
          <contributor organization="ALTX-SOFT">Maria Kedovskaya</contributor>
        </modified>
        <status_change date="2013-12-30T09:17:40.781-05:00">INTERIM</status_change>
        <status_change date="2014-01-20T04:01:24.033-05:00">ACCEPTED</status_change>
        <modified comment="EDITED oval:org.mitre.oval:obj:309 - Modified criteria to match MS bulletin" date="2014-06-13T14:52:00.642-04:00">
          <contributor organization="ALTX-SOFT">Maria Mikhno</contributor>
        </modified>
        <status_change date="2014-06-13T14:56:24.196-04:00">INTERIM</status_change>
        <status_change date="2014-06-30T04:11:14.006-04:00">ACCEPTED</status_change>
      </dates>
      <status>ACCEPTED</status>
      <min_schema_version>5.10</min_schema_version>
    </oval_repository>
  </metadata>
  <criteria operator="OR">
    <criteria comment="Vulnerable Internet Explorer 6" operator="AND">
      <extend_definition comment="Microsoft Internet Explorer 6 is installed" definition_ref="oval:org.mitre.oval:def:563" />
      <extend_definition comment="Microsoft Windows 2000 SP4 or later is installed" definition_ref="oval:org.mitre.oval:def:229" />
      <criterion comment="Vgx.dll version is less than 6.0.2800.1612" test_ref="oval:org.mitre.oval:tst:9041" />
    </criteria>
    <criteria comment="Vulnerable Windows XP (x86) SP2" operator="AND">
      <extend_definition comment="Microsoft Windows XP (x86) SP2 is installed" definition_ref="oval:org.mitre.oval:def:754" />
      <criterion comment="Gdiplus.dll version is less than 5.1.3102.3352" test_ref="oval:org.mitre.oval:tst:9115" />
    </criteria>
    <criteria comment="Vulnerable Windows XP (x86) SP3" operator="AND">
      <extend_definition comment="Microsoft Windows XP (x86) SP3 is installed" definition_ref="oval:org.mitre.oval:def:5631" />
      <criterion comment="Gdiplus.dll version is less than 5.1.3102.5581" test_ref="oval:org.mitre.oval:tst:9133" />
    </criteria>
    <criteria comment="Vulnerable Windows XP (x64) SP2/2003 SP2" operator="AND">
      <criteria comment="Windows XP (x64) SP2/2003 SP2" operator="OR">
        <extend_definition comment="Microsoft Windows Server 2003 SP2 (x86) is installed" definition_ref="oval:org.mitre.oval:def:1935" />
        <extend_definition comment="Microsoft Windows XP x64 Edition SP2 is installed" definition_ref="oval:org.mitre.oval:def:4193" />
        <extend_definition comment="Microsoft Windows Server 2003 SP2 (x64) is installed" definition_ref="oval:org.mitre.oval:def:2161" />
      </criteria>
      <criterion comment="Gdiplus.dll version is less than 5.2.3790.4278" test_ref="oval:org.mitre.oval:tst:8473" />
    </criteria>
    <criteria comment="Vulnerable Windows XP (x64) SP1/2003 SP1" operator="AND">
      <criteria comment="Windows XP (x64) SP1/2003 SP1" operator="OR">
        <extend_definition comment="Microsoft Windows Server 2003 SP1 (x86) is installed" definition_ref="oval:org.mitre.oval:def:565" />
        <extend_definition comment="Microsoft Windows XP Professional x64 Edition SP1 is installed" definition_ref="oval:org.mitre.oval:def:720" />
        <extend_definition comment="Microsoft Windows Server 2003 SP1 (x64) is installed" definition_ref="oval:org.mitre.oval:def:4386" />
        <extend_definition comment="Microsoft Windows Server 2003 SP1 for Itanium is installed" definition_ref="oval:org.mitre.oval:def:1205" />
      </criteria>
      <criterion comment="Gdiplus.dll version is less than 5.2.3790.3126" test_ref="oval:org.mitre.oval:tst:8746" />
    </criteria>
    <criteria comment="Vulnerable Windows Vista" operator="AND">
      <criteria comment="Windows Vista" operator="OR">
        <extend_definition comment="Microsoft Windows Vista (32-bit) is installed" definition_ref="oval:org.mitre.oval:def:1282" />
        <extend_definition comment="Microsoft Windows Vista x64 Edition is installed" definition_ref="oval:org.mitre.oval:def:2041" />
      </criteria>
      <criteria comment="Check for LDR/GDR" operator="OR">
        <criterion comment="Gdiplus.dll version is less than 5.2.6000.16683" test_ref="oval:org.mitre.oval:tst:8978" />
        <criteria comment="Check for LDR" operator="AND">
          <criterion comment="Check if version of Gdiplus.dll is greater than or equal to 5.2.6000.20000" test_ref="oval:org.mitre.oval:tst:77833" />
          <criterion comment="Check if version of Gdiplus.dll is less than 5.2.6000.20826" test_ref="oval:org.mitre.oval:tst:77818" />
        </criteria>
      </criteria>
    </criteria>
    <criteria comment="Vulnerable Windows Vista SP1/2008 SP1" operator="AND">
      <criteria comment="Windows Vista SP1/2008 SP1" operator="OR">
        <extend_definition comment="Microsoft Windows Vista (32-bit) Service Pack 1 is installed" definition_ref="oval:org.mitre.oval:def:4873" />
        <extend_definition comment="Microsoft Windows Server 2008 (32-bit) is installed" definition_ref="oval:org.mitre.oval:def:4870" />
        <extend_definition comment="Microsoft Windows Server 2008 (64-bit) is installed" definition_ref="oval:org.mitre.oval:def:5356" />
        <extend_definition comment="Microsoft Windows Server 2008 (ia-64) is installed" definition_ref="oval:org.mitre.oval:def:5667" />
        <extend_definition comment="Microsoft Windows Vista x64 Edition Service Pack 1 is installed" definition_ref="oval:org.mitre.oval:def:5254" />
      </criteria>
      <criteria comment="Check for LDR/GDR" operator="OR">
        <criterion comment="Gdiplus.dll version is less than 5.2.6001.18065" test_ref="oval:org.mitre.oval:tst:9190" />
        <criteria comment="Check for LDR" operator="AND">
          <criterion comment="Gdiplus.dll version is greater than or equal to 5.2.6001.22000" test_ref="oval:org.mitre.oval:tst:42650" />
          <criterion comment="Check if version of Gdiplus.dll is less than 5.2.6001.22170" test_ref="oval:org.mitre.oval:tst:77788" />
        </criteria>
      </criteria>
    </criteria>
    <criteria comment="Vulnerable Office XP" operator="AND">
      <extend_definition comment="Microsoft Office XP is installed" definition_ref="oval:org.mitre.oval:def:663" />
      <criterion comment="Mso.dll version is less than 10.0.6844.0" test_ref="oval:org.mitre.oval:tst:9255" />
    </criteria>
    <criteria comment="Vulnerable Office 2003" operator="AND">
      <extend_definition comment="Microsoft Office 2003 is installed" definition_ref="oval:org.mitre.oval:def:233" />
      <criterion comment="GDIPlus.dll version is less than 11.0.8230.0" test_ref="oval:org.mitre.oval:tst:9205" />
    </criteria>
    <criteria comment="Vulnerable Office 2007" operator="AND">
      <extend_definition comment="Microsoft Office 2007 is installed" definition_ref="oval:org.mitre.oval:def:1211" />
      <criterion comment="Ogl.dll version is less than 12.0.6325.5000" test_ref="oval:org.mitre.oval:tst:9231" />
    </criteria>
    <criteria comment="Vulnerable Office Visio 2002 SP2" operator="AND">
      <extend_definition comment="Microsoft Office Visio 2002 SP2 is installed" definition_ref="oval:org.mitre.oval:def:692" />
      <criterion comment="Mso.dll version is less than 10.0.6844.0" test_ref="oval:org.mitre.oval:tst:9255" />
    </criteria>
    <criteria comment="Vulnerable PowerPoint Viewer" operator="AND">
      <extend_definition comment="Microsoft PowerPoint Viewer is installed" definition_ref="oval:org.mitre.oval:def:6014" />
      <criterion comment="GDIPlus.dll version is less than 11.0.8230.0" test_ref="oval:org.mitre.oval:tst:9205" />
    </criteria>
    <criteria comment="Vulnerable SQL Server 2005 SP2" operator="AND">
      <criteria comment="SQL Server 2005 SP2" operator="OR">
        <criteria comment="SQL Server 2005 SP2" operator="AND">
          <extend_definition comment="Microsoft SQL Server 2005 is installed" definition_ref="oval:org.mitre.oval:def:6082" />
          <criterion comment="HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Microsoft SQL Server\90\DTS\Setup\\SP equals 2" test_ref="oval:org.mitre.oval:tst:9558" />
        </criteria>
        <extend_definition comment="Microsoft SQL Server 2005 SP2 is installed" definition_ref="oval:org.mitre.oval:def:8397" />
      </criteria>
      <criteria comment="Vulnerable version of SP2 or hotfix" operator="OR">
        <criterion comment="Check if version of Sqlservr.exe is less than 2005.90.3073.0 (GDR)" test_ref="oval:org.mitre.oval:tst:77831" />
        <criterion comment="Check if version of Sqlwb.exe is less than 2005.90.3282.0 (Hotfix/QFE)" test_ref="oval:org.mitre.oval:tst:77584" />
      </criteria>
    </criteria>
  </criteria>
</definition>
