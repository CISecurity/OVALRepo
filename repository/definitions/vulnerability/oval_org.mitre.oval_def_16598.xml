<definition xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5" class="vulnerability" id="oval:org.mitre.oval:def:16598" version="59">
  <metadata>
    <title>Microsoft Windows Remote Desktop Client remote code execution vulnerability - MS13-029</title>
    <affected family="windows">
      <platform>Microsoft Windows 7</platform>
      <platform>Microsoft Windows Server 2003</platform>
      <platform>Microsoft Windows Server 2008</platform>
      <platform>Microsoft Windows Server 2008 R2</platform>
      <platform>Microsoft Windows Vista</platform>
      <platform>Microsoft Windows XP</platform>
      <product>Remote Desktop Client</product>
    </affected>
    <reference ref_id="CVE-2013-1296" ref_url="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-1296" source="CVE" />
    <description>The Remote Desktop ActiveX control in mstscax.dll in Microsoft Remote Desktop Connection Client 6.1 and 7.0 does not properly handle objects in memory, which allows remote attackers to execute arbitrary code via a web page that triggers access to a deleted object, and allows remote RDP servers to execute arbitrary code via unspecified vectors that trigger access to a deleted object, aka "RDP ActiveX Control Remote Code Execution Vulnerability."</description>
    <oval_repository>
      <dates>
        <submitted date="2013-04-12T09:57:48">
          <contributor organization="SecPod Technologies">SecPod Team</contributor>
        </submitted>
        <status_change date="2013-04-15T22:02:05.944-04:00">DRAFT</status_change>
        <modified comment="EDITED oval:org.mitre.oval:ste:12547 - Submission on Microsoft Bulletin for the month April 2013." date="2013-04-15T21:59:00.487-04:00">
          <contributor organization="SecPod Technologies">Sharath S</contributor>
        </modified>
        <status_change date="2013-05-06T04:02:33.328-04:00">INTERIM</status_change>
        <status_change date="2013-05-27T04:00:11.677-04:00">ACCEPTED</status_change>
        <modified comment="EDITED oval:org.mitre.oval:tst:80903 - contains tests with modified comments and all dependences" date="2014-02-13T12:19:00.287-05:00">
          <contributor organization="ALTX-SOFT">Maria Mikhno</contributor>
        </modified>
        <status_change date="2014-02-13T12:22:36.741-05:00">INTERIM</status_change>
        <status_change date="2014-03-03T04:00:57.485-05:00">ACCEPTED</status_change>
        <modified comment="EDITED oval:org.mitre.oval:def:16598 - extended definitions of OS are without SP checks" date="2014-07-28T17:29:00.723-04:00">
          <contributor organization="ALTX-SOFT">Maria Mikhno</contributor>
        </modified>
        <status_change date="2014-07-28T17:34:31.626-04:00">INTERIM</status_change>
        <status_change date="2014-08-18T04:01:43.152-04:00">ACCEPTED</status_change>
        <modified comment="EDITED oval:org.mitre.oval:def:16598 - Update criteria, adding new tests to check versions of mtstscax.dll and aaclient.dll." date="2015-02-02T15:30:00.954-05:00">
          <contributor organization="ALTX-SOFT">Maria Mikhno</contributor>
        </modified>
        <status_change date="2015-02-02T15:34:36.040-05:00">INTERIM</status_change>
        <status_change date="2015-02-23T04:00:43.534-05:00">ACCEPTED</status_change>
      </dates>
      <status>ACCEPTED</status>
      <min_schema_version>5.4</min_schema_version>
    </oval_repository>
  </metadata>
  <criteria operator="OR">
    <criteria comment="Microsoft Windows XP or Server 2003 is installed and Remote Desktop Client is vulnerable" operator="AND">
      <criteria comment="Microsoft Windows XP/2003 (x86/x64)" operator="OR">
        <extend_definition comment="Microsoft Windows XP (32-bit) is installed" definition_ref="oval:org.mitre.oval:def:1353" />
        <extend_definition comment="Microsoft Windows XP x64 is installed" definition_ref="oval:org.mitre.oval:def:15247" />
        <extend_definition comment="Microsoft Windows Server 2003 (32-bit) is installed" definition_ref="oval:org.mitre.oval:def:1870" />
        <extend_definition comment="Microsoft Windows Server 2003 (x64) is installed" definition_ref="oval:org.mitre.oval:def:730" />
      </criteria>
      <criteria comment="For Remote Desktop Client 6.1" operator="OR">
        <criteria comment="For GDR Aaclient.dll" operator="AND">
          <criterion comment="Check if the version of Aaclient.dll is greater than or equal 6.0.0.0" test_ref="oval:org.mitre.oval:tst:81091" />
          <criterion comment="Check if the version of Aaclient.dll is less than 6.0.6001.18000" test_ref="oval:org.mitre.oval:tst:80363" />
        </criteria>
        <criteria comment="For LDR Aaclient.dll" operator="AND">
          <criterion comment="Check if the version of Aaclient.dll is greater than or equal 6.0.6001.20000" test_ref="oval:org.mitre.oval:tst:80838" />
          <criterion comment="Check if the version of Aaclient.dll is less than 6.0.6001.23191" test_ref="oval:org.mitre.oval:tst:80849" />
        </criteria>
      </criteria>
    </criteria>
    <criteria comment="Microsoft Windows Vista /Server 2008 is installed and Remote Desktop Client is vulnerable" operator="AND">
      <criteria comment="Microsoft Windows Vista/2008" operator="OR">
        <extend_definition comment="Microsoft Windows Vista (32-bit) is installed" definition_ref="oval:org.mitre.oval:def:1282" />
        <extend_definition comment="Microsoft Windows Vista x64 Edition is installed" definition_ref="oval:org.mitre.oval:def:2041" />
        <extend_definition comment="Microsoft Windows Server 2008 (32-bit) is installed" definition_ref="oval:org.mitre.oval:def:4870" />
        <extend_definition comment="Microsoft Windows Server 2008 (64-bit) is installed" definition_ref="oval:org.mitre.oval:def:5356" />
        <extend_definition comment="Microsoft Windows Server 2008 (ia-64) is installed" definition_ref="oval:org.mitre.oval:def:5667" />
      </criteria>
      <criteria comment="GDR or LDR of RDP 6.1" operator="OR">
        <criteria comment="GDR 6.1" operator="AND">
          <criterion comment="Check if the version of Aaclient.dll is starts greater than 6.0.6002" test_ref="oval:org.mitre.oval:tst:81127" />
          <criterion comment="Check if the version of Aaclient.dll is less than 6.0.6002.18005" test_ref="oval:org.mitre.oval:tst:81086" />
        </criteria>
        <criteria comment="LDR 6.1" operator="AND">
          <criterion comment="Check if the version of Aaclient.dll is greater than or equal to 6.0.6002.20000" test_ref="oval:org.mitre.oval:tst:80857" />
          <criterion comment="Check if the version of Aaclient.dll is less than 6.0.6002.23075" test_ref="oval:org.mitre.oval:tst:80977" />
        </criteria>
        <criteria comment="GDR 6.1" operator="AND">
          <criterion comment="Check if the version of Mstscax.dll is greater than 6.0.6002" test_ref="oval:org.mitre.oval:tst:137158" />
          <criterion comment="Check if the version of Mstscax.dll is less than 6.0.6002.18804" test_ref="oval:org.mitre.oval:tst:137640" />
        </criteria>
        <criteria comment="LDR 6.1" operator="AND">
          <criterion comment="the version of Mstscax.dll is greater than or equal 6.0.6002.22000" test_ref="oval:org.mitre.oval:tst:10179" />
          <criterion comment="Check if the version of Mstscax.dll is less than 6.0.6002.23075" test_ref="oval:org.mitre.oval:tst:137479" />
        </criteria>
      </criteria>
    </criteria>
    <criteria comment="Microsoft Windows XP/Vista/7/2008 R2 is installed and Remote Desktop Client is vulnerable" operator="AND">
      <criteria comment="Microsoft Windows XP/Vista/7/2008 R2" operator="OR">
        <extend_definition comment="Microsoft Windows XP (32-bit) is installed" definition_ref="oval:org.mitre.oval:def:1353" />
        <extend_definition comment="Microsoft Windows Vista (32-bit) is installed" definition_ref="oval:org.mitre.oval:def:1282" />
        <extend_definition comment="Microsoft Windows Vista x64 Edition is installed" definition_ref="oval:org.mitre.oval:def:2041" />
        <extend_definition comment="Microsoft Windows 7 is installed" definition_ref="oval:org.mitre.oval:def:12541" />
        <extend_definition comment="Microsoft Windows Server 2008 R2 is installed" definition_ref="oval:org.mitre.oval:def:12754" />
      </criteria>
      <criteria comment="GDR or LDR for RDP 7.0" operator="OR">
        <criteria comment="GDR 7.0" operator="AND">
          <criterion comment="Check if the version of Aaclient.dll is greater than 6.1.0.0" test_ref="oval:org.mitre.oval:tst:80989" />
          <criterion comment="Check if the version of Aaclient.dll is less than 6.1.7600.17233" test_ref="oval:org.mitre.oval:tst:80858" />
        </criteria>
        <criteria comment="LDR 7.0" operator="AND">
          <criterion comment="Check if the version of Aaclient.dll is greater than or equal 6.1.7600.21000" test_ref="oval:org.mitre.oval:tst:80892" />
          <criterion comment="Check if the version of Aaclient.dll is less than 6.1.7600.21448" test_ref="oval:org.mitre.oval:tst:80992" />
        </criteria>
      </criteria>
    </criteria>
    <criteria comment="Microsoft Windows 7/Server 2008 R2 is installed and Remote Desktop Client is vulnerable" operator="AND">
      <criteria comment="Microsoft Windows 7/R2" operator="OR">
        <extend_definition comment="Microsoft Windows 7 (32-bit) is installed" definition_ref="oval:org.mitre.oval:def:6165" />
        <extend_definition comment="Microsoft Windows 7 x64 Edition is installed" definition_ref="oval:org.mitre.oval:def:5950" />
        <extend_definition comment="Microsoft Windows Server 2008 R2 x64 Edition is installed" definition_ref="oval:org.mitre.oval:def:6438" />
        <extend_definition comment="Microsoft Windows Server 2008 R2 Itanium-Based Edition is installed" definition_ref="oval:org.mitre.oval:def:5954" />
      </criteria>
      <criteria comment="GDR or LDR for RDP 7.0" operator="OR">
        <criteria comment="GDR 7.0" operator="AND">
          <criterion comment="Check if the version of Aaclient.dll is greater than 6.1.0.0" test_ref="oval:org.mitre.oval:tst:80989" />
          <criterion comment="Check if the version of Aaclient.dll is less than 6.1.7601.18079" test_ref="oval:org.mitre.oval:tst:80458" />
        </criteria>
        <criteria comment="LDR 7.0" operator="AND">
          <criterion comment="Check if the version of Aaclient.dll is greater than or equal 6.1.7601.21000" test_ref="oval:org.mitre.oval:tst:80903" />
          <criterion comment="Check if the version of Aaclient.dll is less than 6.1.7601.22252" test_ref="oval:org.mitre.oval:tst:80661" />
        </criteria>
      </criteria>
    </criteria>
  </criteria>
</definition>
