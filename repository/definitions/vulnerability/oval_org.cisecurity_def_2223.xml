<definition xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5" class="vulnerability" id="oval:org.cisecurity:def:2223" version="29">
  <metadata>
    <title>ADFS Security Feature Bypass Vulnerability â€“ CVE-2017-0159</title>
    <affected family="windows">
      <platform>Microsoft Windows Server 2012 R2</platform>
      <platform>Microsoft Windows Server 2016</platform>
      <platform>Microsoft Windows 10</platform>
    </affected>
    <reference ref_id="CVE-2017-0159" ref_url="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-0159" source="CVE" />
    <description>A security feature bypass vulnerability exists in Windows 10 1607, Windows Server 2012 R2, and Windows 2016 when ADFS incorrectly treats requests coming from Extranet clients as Intranet requests, aka "ADFS Security Feature Bypass Vulnerability."</description>
    <oval_repository>
      <dates>
        <submitted date="2017-05-05T00:00:00+08:00">
          <contributor organization="DTCC">Jeff Albert</contributor>
        </submitted>
        <status_change date="2017-05-05T12:00:00.000-05:00">DRAFT</status_change>
        <status_change date="2017-05-19T14:00:00.000-05:00">INTERIM</status_change>
        <status_change date="2017-06-02T12:00:00.000-05:00">ACCEPTED</status_change>
      </dates>
      <status>ACCEPTED</status>
      <min_schema_version>5.10</min_schema_version>
    </oval_repository>
  </metadata>
  <criteria comment="MS OS + vulnerable version" operator="OR">
    <criteria comment="2k12 R2 + file version">
      <extend_definition comment="Microsoft Windows Server 2012 R2 is installed" definition_ref="oval:org.mitre.oval:def:18858" />
      <criterion comment="Check if the version of Ntdsai.dll is less than 6.3.9600.18623" test_ref="oval:org.cisecurity:tst:3076" />
    </criteria>
    <criteria comment="1607/2016 + file version" operator="AND">
      <criteria comment="1607/2016" operator="OR">
        <extend_definition comment="Microsoft Windows 10 Version 1607 (32-bit) is installed" definition_ref="oval:org.cisecurity:def:1377" />
        <extend_definition comment="Microsoft Windows 10 Version 1607 (64-bit) is installed" definition_ref="oval:org.cisecurity:def:1379" />
        <extend_definition comment="Microsoft Windows Server 2016 is installed" definition_ref="oval:org.cisecurity:def:1269" />
      </criteria>
      <criterion comment="Check if the version of Ntdsai.dll is less than 10.0.14393.1066" test_ref="oval:org.cisecurity:tst:3074" />
    </criteria>
    <criteria comment="1703 + file version" operator="AND">
      <criteria comment="1703" operator="OR">
        <extend_definition comment="Microsoft Windows 10 Version 1703 (x86) is installed" definition_ref="oval:org.cisecurity:def:2084" />
        <extend_definition comment="Microsoft Windows 10 Version 1703 (x64) is installed" definition_ref="oval:org.cisecurity:def:2083" />
      </criteria>
      <criterion comment="Check if the version of Ntdsai.dll is less than 10.0.15063.138" test_ref="oval:org.cisecurity:tst:3071" />
    </criteria>
  </criteria>
</definition>
