<definition xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5" class="vulnerability" id="oval:org.mitre.oval:def:12175" version="35">
  <metadata>
    <title>SMTP Memory Allocation Vulnerability</title>
    <affected family="windows">
      <platform>Microsoft Windows 2000</platform>
      <platform>Microsoft Windows XP</platform>
      <platform>Microsoft Windows Server 2003</platform>
      <platform>Microsoft Windows Server 2008</platform>
      <platform>Microsoft Windows Server 2008 R2</platform>
      <product>SMTP</product>
      <product>Microsoft Exchange Server 2000</product>
    </affected>
    <reference ref_id="CVE-2010-0025" ref_url="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-0025" source="CVE" />
    <description>The SMTP component in Microsoft Windows 2000 SP4, XP SP2 and SP3, Server 2003 SP2, and Server 2008 Gold, SP2, and R2, and Exchange Server 2000 SP3, does not properly allocate memory for SMTP command replies, which allows remote attackers to read fragments of e-mail messages by sending a series of invalid commands and then sending a STARTTLS command, aka "SMTP Memory Allocation Vulnerability."</description>
    <oval_repository>
      <dates>
        <submitted date="2010-11-04T13:00:00">
          <contributor organization="Symantec Corporation">Dragos Prisaca</contributor>
        </submitted>
        <status_change date="2010-11-10T18:56:57.515-05:00">DRAFT</status_change>
        <status_change date="2010-11-29T04:00:09.890-05:00">INTERIM</status_change>
        <status_change date="2010-12-20T04:00:25.575-05:00">ACCEPTED</status_change>
        <status_change date="2012-03-05T14:23:48.337-05:00">INTERIM</status_change>
        <modified comment="Added Windows Server 2008 R2 platform" date="2012-03-05T14:23:48.337-05:00">
          <contributor organization="Symantec Corporation">Dragos Prisaca</contributor>
        </modified>
        <status_change date="2012-03-26T04:00:59.149-04:00">ACCEPTED</status_change>
        <modified comment="EDITED oval:org.mitre.oval:obj:309 - New Microsoft Patch Tuesday May 2012 definitions." date="2012-05-18T15:40:00.554-04:00">
          <contributor organization="Symantec Corporation">Josh Turpin</contributor>
        </modified>
        <status_change date="2012-05-18T15:49:00.094-04:00">INTERIM</status_change>
        <status_change date="2012-06-04T04:00:24.753-04:00">ACCEPTED</status_change>
        <modified comment="EDITED oval:org.mitre.oval:ste:4543 - modified states" date="2014-02-13T12:23:00.044-05:00">
          <contributor organization="ALTX-SOFT">Maria Mikhno</contributor>
        </modified>
        <status_change date="2014-02-13T12:25:06.395-05:00">INTERIM</status_change>
        <status_change date="2014-03-03T04:00:17.759-05:00">ACCEPTED</status_change>
        <modified comment="EDITED oval:org.mitre.oval:obj:309 - Modified criteria to match MS bulletin" date="2014-06-13T14:52:00.642-04:00">
          <contributor organization="ALTX-SOFT">Maria Mikhno</contributor>
        </modified>
        <status_change date="2014-06-13T14:56:26.821-04:00">INTERIM</status_change>
        <status_change date="2014-06-30T04:00:18.142-04:00">ACCEPTED</status_change>
        <modified comment="EDITED oval:org.mitre.oval:def:12175 - extended definitions of OS are without SP checks" date="2014-07-28T17:42:00.658-04:00">
          <contributor organization="ALTX-SOFT">Maria Mikhno</contributor>
        </modified>
        <status_change date="2014-07-28T17:44:55.755-04:00">INTERIM</status_change>
        <status_change date="2014-08-18T04:00:18.622-04:00">ACCEPTED</status_change>
      </dates>
      <status>ACCEPTED</status>
      <min_schema_version>5.10</min_schema_version>
    </oval_repository>
  </metadata>
  <criteria operator="OR">
    <criteria comment="Vulnerable Microsoft Windows 2000" operator="AND">
      <extend_definition comment="Microsoft Windows 2000 is installed" definition_ref="oval:org.mitre.oval:def:85" />
      <criterion comment="The version of smtpsvc.dll is less than 5.0.2195.7381" test_ref="oval:org.mitre.oval:tst:11642" />
    </criteria>
    <criteria comment="Vulnerable Microsoft Windows XP (x86)" operator="AND">
      <extend_definition comment="Microsoft Windows XP (32-bit) is installed" definition_ref="oval:org.mitre.oval:def:1353" />
      <criterion comment="The version of smtpsvc.dll is less than 6.0.2600.3680" test_ref="oval:org.mitre.oval:tst:11743" />
    </criteria>
    <criteria comment="Vulnerable Microsoft Windows XP (x86)" operator="AND">
      <extend_definition comment="Microsoft Windows XP (32-bit) is installed" definition_ref="oval:org.mitre.oval:def:1353" />
      <criterion comment="The version of smtpsvc.dll is less than 6.0.2600.5949" test_ref="oval:org.mitre.oval:tst:11572" />
    </criteria>
    <criteria comment="Vulnerable Microsoft Windows XP x64, Server 2003 x86/x64/ia64" operator="AND">
      <criteria comment="XP x64/server 2003 x86/x64/ia64" operator="OR">
        <extend_definition comment="Microsoft Windows XP x64 is installed" definition_ref="oval:org.mitre.oval:def:15247" />
        <extend_definition comment="Microsoft Windows Server 2003 (32-bit) is installed" definition_ref="oval:org.mitre.oval:def:1870" />
        <extend_definition comment="Microsoft Windows Server 2003 (x64) is installed" definition_ref="oval:org.mitre.oval:def:730" />
        <extend_definition comment="Microsoft Windows Server 2003 (ia64) Gold is installed" definition_ref="oval:org.mitre.oval:def:396" />
      </criteria>
      <criterion comment="The version of smtpsvc.dll is less than 6.0.3790.4675" test_ref="oval:org.mitre.oval:tst:11143" />
    </criteria>
    <criteria comment="Vulnerable Microsoft Server 2008 32bit/x64" operator="AND">
      <criteria comment="Microsoft Server 2008 32bit/x64" operator="OR">
        <extend_definition comment="Microsoft Windows Server 2008 (32-bit) is installed" definition_ref="oval:org.mitre.oval:def:4870" />
        <extend_definition comment="Microsoft Windows Server 2008 (64-bit) is installed" definition_ref="oval:org.mitre.oval:def:5356" />
      </criteria>
      <criteria comment="GDR or LDR Service branch" operator="OR">
        <criterion comment="The version of smtpsvc.dll is less than 7.0.6001.18485" test_ref="oval:org.mitre.oval:tst:11603" />
        <criteria comment="LDR" operator="AND">
          <criterion comment="The version of smtpsvc.dll is greater than or equal 7.0.6001.22000" test_ref="oval:org.mitre.oval:tst:11323" />
          <criterion comment="The version of smtpsvc.dll is less than 7.0.6001.22704" test_ref="oval:org.mitre.oval:tst:11171" />
        </criteria>
      </criteria>
    </criteria>
    <criteria comment="Vulnerable Microsoft Windows Server 2008 32bit/x64" operator="AND">
      <criteria comment="Microsoft Server 2008 32bit/x64" operator="OR">
        <extend_definition comment="Microsoft Windows Server 2008 (32-bit) is installed" definition_ref="oval:org.mitre.oval:def:4870" />
        <extend_definition comment="Microsoft Windows Server 2008 (64-bit) is installed" definition_ref="oval:org.mitre.oval:def:5356" />
      </criteria>
      <criteria comment="GDR or LDR Service branch" operator="OR">
        <criterion comment="The version of smtpsvc.dll is less than 7.0.6002.18264" test_ref="oval:org.mitre.oval:tst:11520" />
        <criteria comment="LDR" operator="AND">
          <criterion comment="The version of smtpsvc.dll is greater than or equal 7.0.6002.22000" test_ref="oval:org.mitre.oval:tst:11373" />
          <criterion comment="The version of smtpsvc.dll is less than 7.0.6002.22417" test_ref="oval:org.mitre.oval:tst:11328" />
        </criteria>
      </criteria>
    </criteria>
    <criteria comment="Vulnerable Microsoft Windows Server 2008 R2 x86/x64/ia64" operator="AND">
      <extend_definition comment="Microsoft Windows Server 2008 R2 x64 Edition is installed" definition_ref="oval:org.mitre.oval:def:6438" />
      <criteria comment="GDR or LDR Service branch" operator="OR">
        <criterion comment="The version of smtpsvc.dll is less than 7.5.7600.16601" test_ref="oval:org.mitre.oval:tst:11754" />
        <criteria comment="LDR" operator="AND">
          <criterion comment="The version of smtpsvc.dll is greater than or equal 7.5.7600.20000" test_ref="oval:org.mitre.oval:tst:11889" />
          <criterion comment="The version of smtpsvc.dll is less than 7.5.7600.20723" test_ref="oval:org.mitre.oval:tst:11532" />
        </criteria>
      </criteria>
    </criteria>
    <criteria comment="Vulnerable Microsoft Exchange Server 2000 SP3" operator="AND">
      <extend_definition comment="Microsoft Exchange Server 2000 Service Pack 3 is installed" definition_ref="oval:org.mitre.oval:def:1858" />
      <criterion comment="mdbmsg.dll is less than 6.0.6620.15" test_ref="oval:org.mitre.oval:tst:11344" />
    </criteria>
  </criteria>
</definition>
