<?xml version="1.0" encoding="UTF-8"?>
<definition id="oval:org.mitre.oval:def:7291" version="7" class="vulnerability">
  <metadata>
    <title>Privilege-escalation vulnerability in PostgreSQL version less than or equal to 9.0</title>
    <affected family="windows">
      <platform>Microsoft Windows 2000</platform>
      <platform>Microsoft Windows 7</platform>
      <platform>Microsoft Windows Server 2003</platform>
      <platform>Microsoft Windows Server 2008</platform>
      <platform>Microsoft Windows Vista</platform>
      <platform>Microsoft Windows XP</platform>
      <product>PostgreSQL</product>
    </affected>
    <reference source="CVE" ref_id="CVE-2010-3433" ref_url="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-3433"/>
    <description>The PL/perl and PL/Tcl implementations in PostgreSQL 7.4 before 7.4.30, 8.0 before 8.0.26, 8.1 before 8.1.22, 8.2 before 8.2.18, 8.3 before 8.3.12, 8.4 before 8.4.5, and 9.0 before 9.0.1 do not properly protect script execution by a different SQL user identity within the same session, which allows remote authenticated users to gain privileges via crafted script code in a SECURITY DEFINER function, as demonstrated by (1) redefining standard functions or (2) redefining operators, a different vulnerability than CVE-2010-1168, CVE-2010-1169, CVE-2010-1170, and CVE-2010-1447.</description>
    <oval_repository>
      <dates>
        <submitted date="2010-10-21T11:57:48">
          <contributor organization="SecPod Technologies">SecPod Team</contributor>
        </submitted>
        <status_change date="2010-10-21T15:40:27.460-04:00">DRAFT</status_change>
        <status_change date="2010-11-08T04:00:15.923-05:00">INTERIM</status_change>
        <status_change date="2010-11-29T04:00:24.705-05:00">ACCEPTED</status_change>
        <modified comment="EDITED oval:org.mitre.oval:obj:6960 - var_check=&quot;all&quot; was replaced with var_check=&quot;at least one&quot;" date="2013-10-29T16:13:00.745-04:00">
          <contributor organization="ALTX-SOFT">Maria Kedovskaya</contributor>
        </modified>
        <status_change date="2013-10-29T16:15:35.530-04:00">INTERIM</status_change>
        <status_change date="2013-11-14T10:21:30.660-05:00">ACCEPTED</status_change>
        <modified comment="EDITED oval:org.mitre.oval:tst:11725 - Added 32-bit branch and corrected check" date="2015-03-06T14:46:00.120-05:00">
          <contributor organization="ALTX-SOFT">Maria Mikhno</contributor>
        </modified>
        <status_change date="2015-03-06T14:48:45.145-05:00">INTERIM</status_change>
        <status_change date="2015-03-23T04:02:34.256-04:00">ACCEPTED</status_change>
      </dates>
      <status>ACCEPTED</status>
    </oval_repository>
  </metadata>
  <criteria operator="AND">
    <criteria operator="OR" comment="Check if PostgreSQL version is 7.4.x, 8.0.x,8.1.x, 8.2.x,8.3.x, 8.4.x or 9.0.0">
      <criteria operator="AND" comment="Check if PostgreSQL version is 7.4.x series">
        <criterion comment="Check if PostgreSQL version  is 7.4.x series" test_ref="oval:org.mitre.oval:tst:11631"/>
        <criterion comment="Check if PostgreSQL version is less than 7.4.30" test_ref="oval:org.mitre.oval:tst:11658"/>
      </criteria>
      <criteria operator="AND" comment="Check if PostgreSQL version is 8.0.x series">
        <criterion comment="Check if PostgreSQL version is less than  8.0.26" test_ref="oval:org.mitre.oval:tst:11930"/>
        <criterion comment="Check if PostgreSQL version is 8.0.x series" test_ref="oval:org.mitre.oval:tst:11909"/>
      </criteria>
      <criteria operator="AND" comment="Check if PostgreSQL version is 9.0.x series">
        <criterion comment="Check if PostgreSQL version is 9.0.x series" test_ref="oval:org.mitre.oval:tst:11640"/>
        <criterion comment="Check if PostgreSQL version is less than  9.0.1" test_ref="oval:org.mitre.oval:tst:11717"/>
      </criteria>
      <criteria operator="AND" comment="Check if PostgreSQL version is 8.1.x series">
        <criterion comment="Check if PostgreSQL version is less than  8.1.22" test_ref="oval:org.mitre.oval:tst:11673"/>
        <criterion comment="Check if PostgreSQL version is 8.1.x series" test_ref="oval:org.mitre.oval:tst:11725"/>
      </criteria>
      <criteria operator="AND" comment="Check if PostgreSQL version is 8.2.x series">
        <criterion comment="Check if PostgreSQL version is less than  8.2.18" test_ref="oval:org.mitre.oval:tst:11680"/>
        <criterion comment="Check if PostgreSQL version is 8.2.x series" test_ref="oval:org.mitre.oval:tst:11744"/>
      </criteria>
      <criteria operator="AND" comment="Check if PostgreSQL version is 8.3.x series">
        <criterion comment="Check if PostgreSQL version is less than  8.3.12" test_ref="oval:org.mitre.oval:tst:11689"/>
        <criterion comment="Check if PostgreSQL version is 8.3.x series" test_ref="oval:org.mitre.oval:tst:11778"/>
      </criteria>
      <criteria operator="AND" comment="Check if PostgreSQL version is 8.4.x series">
        <criterion comment="Check if PostgreSQL version is less than  8.4.5" test_ref="oval:org.mitre.oval:tst:11766"/>
        <criterion comment="Check if PostgreSQL version is 8.4.x series" test_ref="oval:org.mitre.oval:tst:11913"/>
      </criteria>
    </criteria>
    <extend_definition comment="PostgreSQL is installed" definition_ref="oval:org.mitre.oval:def:6785"/>
  </criteria>
</definition>