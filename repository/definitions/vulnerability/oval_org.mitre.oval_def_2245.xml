<?xml version="1.0" encoding="UTF-8"?>
<definition id="oval:org.mitre.oval:def:2245" version="8" class="vulnerability">
  <metadata>
    <title>Windows XP (32-bit,SP2/64-bit,SP1) Shell CLSID File Type Spoof Vulnerability</title>
    <affected family="windows">
      <platform>Microsoft Windows XP</platform>
    </affected>
    <reference source="CVE" ref_id="CVE-2004-0420" ref_url="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2004-0420"/>
    <description>The Windows Shell application in Windows 98, Windows ME, Windows NT 4.0, Windows 2000, Windows XP, and Windows Server 2003 allows remote attackers to execute arbitrary code by spoofing the type of a file via a CLSID specifier in the filename, as demonstrated using Internet Explorer 6.0.2800.1106 on Windows XP.</description>
    <oval_repository>
      <dates>
        <submitted date="2004-07-14T12:00:00.000-04:00">
          <contributor organization="The MITRE Corporation">Christine Walzer</contributor>
        </submitted>
        <status_change date="2004-08-04T12:00:00.000-04:00">INTERIM</status_change>
        <status_change date="2004-08-25T12:00:00.000-04:00">ACCEPTED</status_change>
        <status_change date="2004-09-15T12:00:00.000-04:00">INTERIM</status_change>
        <status_change date="2004-09-29T12:00:00.000-04:00">ACCEPTED</status_change>
        <modified date="2005-12-20T07:05:00.000-04:00" comment="Changed criteria to drop explicit test for patch kb839645.  Inclusion resulted in false positives w/o incremental patching.">
          <contributor organization="ThreatGuard, Inc.">Robert L. Hollis</contributor>
        </modified>
        <status_change date="2006-01-04T08:04:00.000-04:00">ACCEPTED</status_change>
        <modified comment="Updated comment to include Vista and Server 2008" date="2009-05-07T10:32:00.713-04:00">
          <contributor organization="Gideon Technologies, Inc.">Dragos Prisaca</contributor>
        </modified>
        <status_change date="2009-05-07T10:34:10.039-04:00">INTERIM</status_change>
        <status_change date="2009-05-25T04:01:17.560-04:00">ACCEPTED</status_change>
        <modified comment="EDITED oval:org.mitre.oval:def:2245 - Various corrections to comments and products to align with Authoring Style Guide" date="2011-04-22T23:54:00.899-04:00">
          <contributor organization="G2, Inc.">Shane Shaffer</contributor>
        </modified>
        <status_change date="2011-04-23T00:05:11.719-04:00">INTERIM</status_change>
        <modified comment="EDITED oval:org.mitre.oval:obj:717 - Added an additional test for Windows Server 2003 platforms to test for the existence of the NT Directory Services" date="2011-04-25T14:34:00.432-04:00">
          <contributor organization="Telos">Sudhir Gandhe</contributor>
        </modified>
        <modified comment="EDITED oval:org.mitre.oval:obj:717 - Reverted mistaken switch of obj:717 (Service Pack) and obj:15869 (NT Directory Services)" date="2011-04-26T11:53:00.464-04:00">
          <contributor organization="G2, Inc.">Shane Shaffer</contributor>
        </modified>
        <status_change date="2011-05-16T04:02:26.602-04:00">ACCEPTED</status_change>
      </dates>
      <status>ACCEPTED</status>
    </oval_repository>
  </metadata>
  <criteria operator="AND">
    <criterion comment="the version of shell32.dll is less than 6.0.2800.1556" test_ref="oval:org.mitre.oval:tst:582"/>
    <criteria operator="OR" comment="Windows XP (64-bit,SP1 or 32-bit,SP2) is installed">
      <criteria operator="AND" comment="Windows XP 32 bit Service Pack 2">
        <criterion comment="Win2K/XP/2003/Vista/2008 service pack 2 is installed" test_ref="oval:org.mitre.oval:tst:3019"/>
        <criteria operator="AND" comment="Windows XP 32-bit edition is installed">
          <criterion comment="Windows XP is installed" test_ref="oval:org.mitre.oval:tst:2838"/>
          <criterion comment="32-Bit version of Windows is installed" test_ref="oval:org.mitre.oval:tst:2748"/>
        </criteria>
      </criteria>
      <criteria operator="AND" comment="Windows XP 64-bit with Service Pack 1">
        <criterion comment="Windows XP is installed" test_ref="oval:org.mitre.oval:tst:2838"/>
        <criterion comment="a version of Windows for the ia64 architecture is installed" test_ref="oval:org.mitre.oval:tst:2747"/>
        <criterion comment="Win2K/XP/2003/Vista service pack 1 is installed" test_ref="oval:org.mitre.oval:tst:2843"/>
      </criteria>
    </criteria>
  </criteria>
</definition>