<definition xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5" class="vulnerability" id="oval:org.cisecurity:def:8187" version="4">
  <metadata>
    <title>Vulnerability in PostgreSQL 10.x before 10.1, 9.6.x before 9.6.6, and 9.5.x before 9.5.10 (CVE-2017-15099)</title>
    <affected family="windows">
      <platform>Microsoft Windows XP</platform>
      <platform>Microsoft Windows Vista</platform>
      <platform>Microsoft Windows 7</platform>
      <platform>Microsoft Windows 8</platform>
      <platform>Microsoft Windows 8.1</platform>
      <platform>Microsoft Windows 10</platform>
      <platform>Microsoft Windows Server 2003</platform>
      <platform>Microsoft Windows Server 2008</platform>
      <platform>Microsoft Windows Server 2008 R2</platform>
      <platform>Microsoft Windows Server 2012</platform>
      <platform>Microsoft Windows Server 2012 R2</platform>
      <platform>Microsoft Windows Server 2016</platform>
      <product>PostgreSQL</product>
    </affected>
    <reference source="CVE" ref_url="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-15099" ref_id="CVE-2017-15099" />
    <description>INSERT ... ON CONFLICT DO UPDATE commands in PostgreSQL 10.x before 10.1, 9.6.x before 9.6.6, and 9.5.x before 9.5.10 disclose table contents that the invoker lacks privilege to read. These exploits affect only tables where the attacker lacks full read access but has both INSERT and UPDATE privileges. Exploits bypass row level security policies and lack of SELECT privilege.</description>
    <oval_repository>
      <dates>
        <submitted date="2020-08-13T18:04:14">
          <contributor organization="ALTX-SOFT">Alexandr Ruchkin</contributor>
        </submitted>
        <status_change date="2020-08-13T16:00:00.000-05:00">DRAFT</status_change>
        <status_change date="2020-08-28T11:45:00.887-04:00">INTERIM</status_change>
      </dates>
      <status>INTERIM</status>
      <min_schema_version>5.10</min_schema_version>
    </oval_repository>
  </metadata>
  <criteria operator="OR">
    <criteria comment="PostgreSQL 9.5 section" operator="AND">
      <extend_definition definition_ref="oval:org.mitre.oval:def:6785" comment="PostgreSQL is installed" />
      <criterion comment="Check if the version of PostgreSQL 9.5 is greater than or equal 9.5.0 and less than 9.5.10" test_ref="oval:org.cisecurity:tst:16804" />
    </criteria>
    <criteria comment="PostgreSQL 9.6 section" operator="AND">
      <extend_definition definition_ref="oval:org.mitre.oval:def:6785" comment="PostgreSQL is installed" />
      <criterion comment="Check if the version of PostgreSQL 9.6 is greater than or equal 9.6.0 and less than 9.6.6" test_ref="oval:org.cisecurity:tst:16809" />
    </criteria>
    <criteria comment="PostgreSQL 10 section" operator="AND">
      <extend_definition definition_ref="oval:org.mitre.oval:def:6785" comment="PostgreSQL is installed" />
      <criterion comment="Check if the version of PostgreSQL 10 is greater than or equal 10.0.0 and less than 10.1" test_ref="oval:org.cisecurity:tst:16727" />
    </criteria>
  </criteria>
</definition>
