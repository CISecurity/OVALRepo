<definition xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5" class="vulnerability" id="oval:org.mitre.oval:def:5441" version="54">
  <metadata>
    <title>GDI Heap Overflow Vulnerability</title>
    <affected family="windows">
      <platform>Microsoft Windows 2000</platform>
      <platform>Microsoft Windows XP</platform>
      <platform>Microsoft Windows Server 2003</platform>
      <platform>Microsoft Windows Vista</platform>
      <platform>Microsoft Windows Server 2008</platform>
    </affected>
    <reference ref_id="CVE-2008-1083" ref_url="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-1083" source="CVE" />
    <description>Heap-based buffer overflow in the CreateDIBPatternBrushPt function in GDI in Microsoft Windows 2000 SP4, XP SP2, Server 2003 SP1 and SP2, Vista, and Server 2008 allows remote attackers to execute arbitrary code via an EMF or WMF image file with a malformed header that triggers an integer overflow, aka "GDI Heap Overflow Vulnerability."</description>
    <oval_repository>
      <dates>
        <submitted date="2008-04-08T16:04:00">
          <contributor organization="Secure Elements, Inc.">Sudhir Gandhe</contributor>
        </submitted>
        <status_change date="2008-04-11T14:11:48.093-04:00">DRAFT</status_change>
        <status_change date="2008-04-28T04:00:17.889-04:00">INTERIM</status_change>
        <status_change date="2008-05-19T04:00:17.846-04:00">ACCEPTED</status_change>
        <modified comment="EDITED oval:org.mitre.oval:def:5441 - Added LDR critiera &amp; itanium support for Win 2003 &amp; 2008" date="2011-10-25T14:31:00.257-04:00">
          <contributor organization="SecPod Technologies">Chandan S</contributor>
        </modified>
        <status_change date="2011-10-25T14:34:42.088-04:00">INTERIM</status_change>
        <status_change date="2011-11-14T04:00:32.001-05:00">ACCEPTED</status_change>
      </dates>
      <status>ACCEPTED</status>
      <min_schema_version>5.4</min_schema_version>
    </oval_repository>
  </metadata>
  <criteria operator="OR">
    <criteria comment="win 2000/version" operator="AND">
      <extend_definition comment="Microsoft Windows 2000 SP4 or later is installed" definition_ref="oval:org.mitre.oval:def:229" />
      <criterion comment="Gdi32.dll version is less than 5.0.2195.7153" test_ref="oval:org.mitre.oval:tst:7313" />
    </criteria>
    <criteria comment="win XP/version" operator="AND">
      <criterion comment="Gdi32.dll version is less than 5.1.2600.3316" test_ref="oval:org.mitre.oval:tst:7477" />
      <extend_definition comment="Microsoft Windows XP (x86) SP2 is installed" definition_ref="oval:org.mitre.oval:def:754" />
    </criteria>
    <criteria comment="win XP/server 2003 sp1/version" operator="AND">
      <criterion comment="Gdi32.dll version is less than 5.2.3790.3091" test_ref="oval:org.mitre.oval:tst:7867" />
      <criteria comment="OS check" operator="OR">
        <extend_definition comment="Microsoft Windows XP Professional x64 Edition SP1 is installed" definition_ref="oval:org.mitre.oval:def:720" />
        <extend_definition comment="Microsoft Windows Server 2003 SP1 (x86) is installed" definition_ref="oval:org.mitre.oval:def:565" />
        <extend_definition comment="Microsoft Windows Server 2003 SP1 (x64) is installed" definition_ref="oval:org.mitre.oval:def:4386" />
        <extend_definition comment="Microsoft Windows Server 2003 SP1 for Itanium is installed" definition_ref="oval:org.mitre.oval:def:1205" />
      </criteria>
    </criteria>
    <criteria comment="win XP sp2/server 2003 sp2/version" operator="AND">
      <criterion comment="Gdi32.dll version is less than 5.2.3790.4237" test_ref="oval:org.mitre.oval:tst:7979" />
      <criteria comment="OS check" operator="OR">
        <extend_definition comment="Microsoft Windows XP x64 Edition SP2 is installed" definition_ref="oval:org.mitre.oval:def:4193" />
        <extend_definition comment="Microsoft Windows Server 2003 (ia64) SP2 is installed" definition_ref="oval:org.mitre.oval:def:1442" />
        <extend_definition comment="Microsoft Windows Server 2003 SP2 (x86) is installed" definition_ref="oval:org.mitre.oval:def:1935" />
        <extend_definition comment="Microsoft Windows Server 2003 SP2 (x64) is installed" definition_ref="oval:org.mitre.oval:def:2161" />
      </criteria>
    </criteria>
    <criteria comment="vista/version" operator="AND">
      <criteria comment="OS check" operator="OR">
        <extend_definition comment="Microsoft Windows Vista (32-bit) is installed" definition_ref="oval:org.mitre.oval:def:1282" />
        <extend_definition comment="Microsoft Windows Vista x64 Edition is installed" definition_ref="oval:org.mitre.oval:def:2041" />
      </criteria>
      <criteria comment="GDR/LDR" operator="OR">
        <criterion comment="Gdi32.dll version is less than 6.0.6000.16643" test_ref="oval:org.mitre.oval:tst:7866" />
        <criteria comment="LDR range" operator="AND">
          <criterion comment="Check if the version of Gdi32.dll is greater than or equal to 6.0.6000.20000" test_ref="oval:org.mitre.oval:tst:44319" />
          <criterion comment="Check if the version of Gdi32.dll is less than 6.0.6000.20777" test_ref="oval:org.mitre.oval:tst:44191" />
        </criteria>
      </criteria>
    </criteria>
    <criteria comment="vista sp1/server 2008/version" operator="AND">
      <criteria comment="OS check" operator="OR">
        <extend_definition comment="Microsoft Windows Server 2008 (ia-64) is installed" definition_ref="oval:org.mitre.oval:def:5667" />
        <extend_definition comment="Microsoft Windows Server 2008 (64-bit) is installed" definition_ref="oval:org.mitre.oval:def:5356" />
        <extend_definition comment="Microsoft Windows Server 2008 (32-bit) is installed" definition_ref="oval:org.mitre.oval:def:4870" />
        <extend_definition comment="Microsoft Windows Vista (32-bit) Service Pack 1 is installed" definition_ref="oval:org.mitre.oval:def:4873" />
        <extend_definition comment="Microsoft Windows Vista x64 Edition Service Pack 1 is installed" definition_ref="oval:org.mitre.oval:def:5254" />
      </criteria>
      <criteria comment="GDR/LDR" operator="OR">
        <criterion comment="Gdi32.dll version is less than 6.0.6001.18023" test_ref="oval:org.mitre.oval:tst:7782" />
        <criteria comment="LDR range" operator="AND">
          <criterion comment="Check if version of Gdi32.dll is greater than or equal to 6.0.6001.22000" test_ref="oval:org.mitre.oval:tst:74690" />
          <criterion comment="Check if the version of Gdi32.dll is less than 6.0.6001.22120" test_ref="oval:org.mitre.oval:tst:44324" />
        </criteria>
      </criteria>
    </criteria>
  </criteria>
</definition>
