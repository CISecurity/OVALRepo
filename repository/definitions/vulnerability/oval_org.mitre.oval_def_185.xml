<?xml version="1.0" encoding="UTF-8"?>
<definition id="oval:org.mitre.oval:def:185" version="7" class="vulnerability" xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:oval="http://oval.mitre.org/XMLSchema/oval-common-5" xmlns:oval-def="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <metadata>
    <title>Automatic ActiveX Approval on WinXP Low Memory</title>
    <affected family="windows">
      <platform>Microsoft Windows XP</platform>
      <product>Authenticode</product>
    </affected>
    <reference source="CVE" ref_id="CVE-2003-0660" ref_url="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2003-0660"/>
    <description>The Authenticode capability in Microsoft Windows NT through Server 2003 does not prompt the user to download and install ActiveX controls when the system is low on memory, which could allow remote attackers execute arbitrary code without user approval.</description>
    <oval_repository>
      <dates>
        <submitted date="2003-10-29T12:00:00.000-04:00">
          <contributor organization="The MITRE Corporation">Tiffany Bergeron</contributor>
        </submitted>
        <modified date="2004-03-04T12:00:00.000-04:00" comment="Added the configuration check to see if downloading of signed ActiveX controls are enabled by the current user when local machine settings are not in use.">
          <contributor organization="The MITRE Corporation">Andrew Buttner</contributor>
        </modified>
        <modified date="2004-03-05T12:00:00.000-04:00" comment="Fixed the logic that checks for one version of the file if no sp is installed and a different version if sp1 is installed.">
          <contributor organization="The MITRE Corporation">Andrew Buttner</contributor>
        </modified>
        <status_change date="2004-03-25T12:00:00.000-04:00">ACCEPTED</status_change>
        <modified date="2004-09-13T10:18:00.000-04:00" comment="The compound test that includes SP1 or earlier has been added">
          <contributor organization="The MITRE Corporation">Christine Walzer</contributor>
        </modified>
        <modified date="2004-09-13T10:18:00.000-04:00" comment="">
          <contributor organization="The MITRE Corporation">Christine Walzer</contributor>
        </modified>
        <status_change date="2004-09-15T12:00:00.000-04:00">INTERIM</status_change>
        <status_change date="2004-09-29T12:00:00.000-04:00">ACCEPTED</status_change>
        <modified comment="Multiple corrections and update to POSIX compatibility for ste:2656" date="2010-11-29T16:12:00.873-05:00">
          <contributor organization="G2, Inc.">Shane Shaffer</contributor>
        </modified>
        <status_change date="2010-11-29T16:12:59.198-05:00">INTERIM</status_change>
        <status_change date="2010-12-20T04:00:37.502-05:00">ACCEPTED</status_change>
        <modified comment="EDITED oval:org.mitre.oval:obj:717 - Added an additional test for Windows Server 2003 platforms to test for the existence of the NT Directory Services" date="2011-04-25T14:34:00.432-04:00">
          <contributor organization="Telos">Sudhir Gandhe</contributor>
        </modified>
        <status_change date="2011-04-25T14:45:02.164-04:00">INTERIM</status_change>
        <modified comment="EDITED oval:org.mitre.oval:obj:717 - Reverted mistaken switch of obj:717 (Service Pack) and obj:15869 (NT Directory Services)" date="2011-04-26T11:53:00.464-04:00">
          <contributor organization="G2, Inc.">Shane Shaffer</contributor>
        </modified>
        <status_change date="2011-05-16T04:01:58.071-04:00">ACCEPTED</status_change>
      </dates>
      <status>ACCEPTED</status>
      <min_schema_version>5.4</min_schema_version>
    </oval_repository>
  </metadata>
  <criteria operator="AND">
    <criteria operator="AND" comment="Software section">
      <criteria operator="OR" comment="a vulnerable version of cryptui.dll exists">
        <criteria operator="AND" comment="no service pack is installed and cryptui.dll is less than 5.131.2600.117">
          <criterion negate="true" comment="Win2K/XP/2003 is patched" test_ref="oval:org.mitre.oval:tst:2437"/>
          <criterion comment="the version of cryptui.dll is less than 5.131.2600.117" test_ref="oval:org.mitre.oval:tst:2844"/>
        </criteria>
        <criteria operator="AND" comment="service pack 1 is installed and cryptui.dll is less than 5.131.2600.1243">
          <criterion comment="Win2K/XP/2003 service pack 1 is installed" test_ref="oval:org.mitre.oval:tst:2843"/>
          <criterion comment="the version of cryptui.dll is less than 5.131.2600.1243" test_ref="oval:org.mitre.oval:tst:2842"/>
        </criteria>
      </criteria>
      <criterion negate="true" comment="Patch WindowsXP-KB823182-x86-ENU Installed" test_ref="oval:org.mitre.oval:tst:2841"/>
      <criteria operator="AND" comment="Windows XP (sp1 or earlier) is installed">
        <criterion comment="Windows XP is installed" test_ref="oval:org.mitre.oval:tst:2838"/>
        <criterion negate="true" comment="Win2K/XP/2003 service pack 2 (or later) is installed" test_ref="oval:org.mitre.oval:tst:2837"/>
      </criteria>
    </criteria>
    <criteria operator="AND" comment="Configuration section">
      <criteria operator="AND" comment="downloading of signed ActiveX controls is enabled">
        <criteria operator="AND" comment="current user settings are being used and the downloading of signed ActiveX controls is enabled">
          <criterion negate="true" comment="use machine settings rather than individual user settings" test_ref="oval:org.mitre.oval:tst:2951"/>
          <criterion comment="downloading of signed ActiveX controls is enabled for the local machine" test_ref="oval:org.mitre.oval:tst:2840"/>
        </criteria>
        <criteria operator="AND" comment="local machine settings are being used and the downloading of signed ActiveX controls is enabled">
          <criterion comment="use machine settings rather than individual user settings" test_ref="oval:org.mitre.oval:tst:2951"/>
          <criterion comment="downloading of signed ActiveX controls is enabled for the current user" test_ref="oval:org.mitre.oval:tst:2839"/>
        </criteria>
      </criteria>
    </criteria>
  </criteria>
</definition>