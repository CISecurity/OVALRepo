<?xml version="1.0" encoding="UTF-8"?>
<definition id="oval:org.mitre.oval:def:19040" version="9" class="vulnerability" xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:oval="http://oval.mitre.org/XMLSchema/oval-common-5" xmlns:oval-def="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <metadata>
    <title>MAC disabled vulnerability in Microsoft SharePoint and Microsoft Exchange Server (CVE-2013-1330) - MS13-067, MS13-105</title>
    <affected family="windows">
      <platform>Microsoft Windows 2000</platform>
      <platform>Microsoft Windows 7</platform>
      <platform>Microsoft Windows 8</platform>
      <platform>Microsoft Windows Server 2003</platform>
      <platform>Microsoft Windows Server 2008</platform>
      <platform>Microsoft Windows Server 2008 R2</platform>
      <platform>Microsoft Windows Server 2012</platform>
      <platform>Microsoft Windows Vista</platform>
      <platform>Microsoft Windows XP</platform>
      <product>Microsoft Exchange Server 2007</product>
      <product>Microsoft Exchange Server 2010</product>
      <product>Microsoft Exchange Server 2013</product>
      <product>Microsoft SharePoint Foundation 2010</product>
      <product>Microsoft SharePoint Server 2007</product>
      <product>Microsoft SharePoint Server 2010</product>
      <product>Microsoft SharePoint Services 2.0</product>
      <product>Microsoft SharePoint Services 3.0</product>
    </affected>
    <reference source="CVE" ref_id="CVE-2013-1330" ref_url="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-1330"/>
    <description>The default configuration of Microsoft SharePoint Portal Server 2003 SP3, SharePoint Server 2007 SP3 and 2010 SP1 and SP2, and Office Web Apps 2010 does not set the EnableViewStateMac attribute, which allows remote attackers to execute arbitrary code by leveraging an unassigned workflow, aka "MAC Disabled Vulnerability."</description>
    <oval_repository>
      <dates>
        <submitted date="2013-10-16T14:45:34">
          <contributor organization="SecPod Technologies">SecPod Team</contributor>
        </submitted>
        <status_change date="2013-10-23T11:49:21.980-04:00">DRAFT</status_change>
        <status_change date="2013-11-11T04:01:31.892-05:00">INTERIM</status_change>
        <status_change date="2013-11-26T13:49:23.769-05:00">ACCEPTED</status_change>
        <modified comment="EDITED oval:org.mitre.oval:def:19040 - MS13-105. The file has 1 update and 3 new defs. The file has an update to def:19040" date="2013-12-13T11:12:00.457-05:00">
          <contributor organization="SecPod Technologies">Pooja Shetty</contributor>
        </modified>
        <status_change date="2013-12-13T11:13:51.774-05:00">INTERIM</status_change>
        <status_change date="2013-12-30T04:00:18.760-05:00">ACCEPTED</status_change>
        <modified comment="EDITED oval:org.mitre.oval:tst:87199 - updated to check proper version as per bulletin." date="2014-01-16T10:58:00.923-05:00">
          <contributor organization="SecPod Technologies">Pooja Shetty</contributor>
        </modified>
        <status_change date="2014-01-16T10:59:42.001-05:00">INTERIM</status_change>
        <status_change date="2014-02-03T04:01:12.016-05:00">ACCEPTED</status_change>
        <modified comment="EDITED oval:org.mitre.oval:var:1390 - November 2014 bulletins." date="2014-11-17T17:25:00.386-05:00">
          <contributor organization="SecPod Technologies">Kumarswamy S</contributor>
        </modified>
        <status_change date="2014-11-17T17:29:49.576-05:00">INTERIM</status_change>
        <status_change date="2014-12-08T04:00:15.815-05:00">ACCEPTED</status_change>
      </dates>
      <status>ACCEPTED</status>
      <min_schema_version>5.10</min_schema_version>
    </oval_repository>
  </metadata>
  <criteria operator="OR">
    <criteria operator="AND" comment="sharepoint services 2.0/version">
      <extend_definition comment="Microsoft Windows SharePoint Services 2.0 is installed" definition_ref="oval:org.mitre.oval:def:15928"/>
      <criterion comment="Check if the version of onetutil.dll is less than 11.0.8346.0" test_ref="oval:org.mitre.oval:tst:87083"/>
    </criteria>
    <criteria operator="AND" comment="sharepoint services 3.0 sp3/version">
      <extend_definition comment="Microsoft SharePoint Services 3.0 SP3 is installed" definition_ref="oval:org.mitre.oval:def:14966"/>
      <criterion comment="Check if the version of Onetutil.dll is less than 12.0.6676.5000" test_ref="oval:org.mitre.oval:tst:86790"/>
    </criteria>
    <criteria operator="AND" comment="foundation 2010/version">
      <criterion comment="Check if the version of onetutil.dll is less than 14.0.7105.5000" test_ref="oval:org.mitre.oval:tst:87199"/>
      <criteria operator="OR" comment="foundation 2010 sp1/sp2">
        <extend_definition comment="Microsoft SharePoint Foundation 2010 Service Pack 1 is installed" definition_ref="oval:org.mitre.oval:def:15661"/>
        <extend_definition comment="Microsoft SharePoint Foundation 2010 Service Pack 2 is installed" definition_ref="oval:org.mitre.oval:def:19047"/>
      </criteria>
    </criteria>
    <criteria operator="AND" comment="sharepoint server 2010/version">
      <criteria operator="OR" comment="sharepoint server 2010 sp1/sp2">
        <extend_definition comment="Microsoft SharePoint Server 2010 Service Pack 1 is installed" definition_ref="oval:org.mitre.oval:def:15614"/>
        <extend_definition comment="Microsoft SharePoint Server 2010 Service Pack 2 is installed" definition_ref="oval:org.mitre.oval:def:18921"/>
      </criteria>
      <criteria operator="OR" comment="either files versions">
        <criterion comment="Check if the version of microsoft.office.server.native.dll is less than 14.0.7005.1000" test_ref="oval:org.mitre.oval:tst:87074"/>
        <criterion comment="Check if the version of WdsrvWorker.dll is less than 14.0.6112.5000" test_ref="oval:org.mitre.oval:tst:87135"/>
        <criterion comment="Check if the version of xlsrv.dll is less than 14.0.7104.5000 (sharepoint server)" test_ref="oval:org.mitre.oval:tst:86965"/>
      </criteria>
    </criteria>
    <criteria operator="AND" comment="web apps/version">
      <criteria operator="OR" comment="office web apps sp1/sp2">
        <extend_definition comment="Microsoft Office Web Apps 2010 Service Pack 1 is installed" definition_ref="oval:org.mitre.oval:def:15860"/>
        <extend_definition comment="Microsoft Office Web Apps 2010 Service Pack 2 is installed" definition_ref="oval:org.mitre.oval:def:19186"/>
      </criteria>
      <criteria operator="OR" comment="either file versions">
        <criterion comment="Check if the version of msoserver.dll is less than 14.0.7106.5000" test_ref="oval:org.mitre.oval:tst:87179"/>
        <criterion comment="Check if the version of xlsrv.dll is less than 14.0.7104.5000 (web apps)" test_ref="oval:org.mitre.oval:tst:86741"/>
      </criteria>
    </criteria>
    <criteria operator="AND" comment="Exchange Server 2007 and vulnerable file version">
      <extend_definition comment="Microsoft Exchange Server 2007 SP3 is installed" definition_ref="oval:org.mitre.oval:def:15784"/>
      <criterion comment="Check if the version of exsetup.exe is less than 8.3.342.4" test_ref="oval:org.mitre.oval:tst:89886"/>
    </criteria>
    <criteria operator="AND" comment="Exchange Server 2010 SP2 and vulnerable file version">
      <extend_definition comment="Microsoft Exchange Server 2010 SP2 is installed" definition_ref="oval:org.mitre.oval:def:14151"/>
      <criterion comment="Check if the version of exsetup.exe is less than 14.2.390.3" test_ref="oval:org.mitre.oval:tst:89663"/>
    </criteria>
    <criteria operator="AND" comment="Exchange Server 2010 SP3 and vulnerable file version">
      <extend_definition comment="Microsoft Exchange Server 2010 SP3 is installed" definition_ref="oval:org.mitre.oval:def:17932"/>
      <criterion comment="Check if the version of exsetup.exe is less than 14.3.174.1" test_ref="oval:org.mitre.oval:tst:89845"/>
    </criteria>
    <criteria operator="AND" comment="Exchange Server 2013 CU2 and vulnerable file version">
      <extend_definition comment="Microsoft Exchange Server 2013 Cumulative Update 2 is installed" definition_ref="oval:org.mitre.oval:def:18484"/>
      <criterion comment="Check if the version of exsetup.exe is less than 15.0.712.31" test_ref="oval:org.mitre.oval:tst:89888"/>
    </criteria>
    <criteria operator="AND" comment="Exchange Server 2013 CU3 and vulnerable file version">
      <extend_definition comment="Microsoft Exchange Server 2013 Cumulative Update 3 is installed" definition_ref="oval:org.mitre.oval:def:20878"/>
      <criterion comment="Check if the version of exsetup.exe is less than 15.0.775.41" test_ref="oval:org.mitre.oval:tst:89992"/>
    </criteria>
  </criteria>
</definition>