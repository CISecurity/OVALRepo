<?xml version="1.0" encoding="UTF-8"?>
<definition id="oval:org.mitre.oval:def:363" version="4" class="vulnerability">
  <metadata>
    <title>IE v5.01,SP4 Script URLs Cross Domain Zone Restrictions Bypass</title>
    <affected family="windows">
      <platform>Microsoft Windows 2000</platform>
      <product>Microsoft Internet Explorer</product>
    </affected>
    <reference source="CVE" ref_id="CVE-2003-0816" ref_url="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2003-0816"/>
    <description>Internet Explorer 6 SP1 and earlier allows remote attackers to bypass zone restrictions by (1) using the NavigateAndFind method to load a file: URL containing Javascript, as demonstrated by NAFfileJPU, (2) using the window.open method to load a file: URL containing Javascript, as demonstrated using WsOpenFileJPU, (3) setting the href property in the base tag for the _search window, as demonstrated using WsBASEjpu, (4) loading the search window into an Iframe, as demonstrated using WsFakeSrc, (5) caching a javascript: URL in the browser history, then accessing that URL in the same frame as the target domain, as demonstrated using WsOpenJpuInHistory, NAFjpuInHistory, BackMyParent, BackMyParent2, and RefBack, aka the "Script URLs Cross Domain" vulnerability.</description>
    <oval_repository>
      <dates>
        <submitted date="2003-11-12T12:00:00.000-04:00">
          <contributor organization="The MITRE Corporation">Andrew Buttner</contributor>
        </submitted>
        <modified date="2004-01-21T12:00:00.000-04:00" comment="Removed the test for Windows 2000 sp4 installed.  This is not part of the vulnerability definition.  Instead, it is a pre-requisite of installing the IE 5.01 sp4 patch.">
          <contributor organization="The MITRE Corporation">Andrew Buttner</contributor>
        </modified>
        <modified date="2004-03-04T12:00:00.000-04:00" comment="Added the configuration check to see if ActiveX controls and active scripting are enabled by the current user when local machine settings are not in use.">
          <contributor organization="The MITRE Corporation">Andrew Buttner</contributor>
        </modified>
        <status_change date="2004-03-09T12:00:00.000-04:00">INTERIM</status_change>
        <status_change date="2004-03-25T12:00:00.000-04:00">ACCEPTED</status_change>
        <modified comment="Fixed ste:2614: set datatype to version.  Implemented by Harvey Rubinovitz." date="2007-01-25T16:54:00.319-05:00">
          <contributor organization="ThreatGuard, Inc.">Robert L. Hollis</contributor>
        </modified>
        <status_change date="2007-01-25T16:59:41.558-05:00">INTERIM</status_change>
        <status_change date="2007-02-20T13:40:25.497-05:00">ACCEPTED</status_change>
        <modified comment="EDITED oval:org.mitre.oval:obj:247 - cvename in reference was replaced with CVE-2013-1311 and description was modified" date="2014-02-04T12:25:00.319-05:00">
          <contributor organization="ALTX-SOFT">Maria Mikhno</contributor>
        </modified>
        <status_change date="2014-02-04T12:28:37.693-05:00">INTERIM</status_change>
        <status_change date="2014-02-24T04:03:16.400-05:00">ACCEPTED</status_change>
      </dates>
      <status>ACCEPTED</status>
    </oval_repository>
  </metadata>
  <criteria operator="AND">
    <criteria comment="Software section" operator="AND">
      <criterion comment="Internet Explorer 5.01 Service Pack 4 is installed" negate="false" test_ref="oval:org.mitre.oval:tst:2794"/>
      <criterion comment="the version of mshtml.dll is less than 5.0.3810.1700" negate="false" test_ref="oval:org.mitre.oval:tst:2690"/>
      <criterion comment="the patch q824145 is installed (Installed Components key)" negate="true" test_ref="oval:org.mitre.oval:tst:3110"/>
    </criteria>
    <criteria comment="Configuration section" operator="AND">
      <criteria operator="OR" comment="ActiveX controls and active scripting are enabled">
        <criteria operator="AND" comment="current user settings are being used and ActiveX controls and active scripting are enabled">
          <criterion comment="use machine settings rather than individual user settings" negate="true" test_ref="oval:org.mitre.oval:tst:2951"/>
          <criterion comment="ActiveX controls are enabled for the current user" negate="false" test_ref="oval:org.mitre.oval:tst:2917"/>
          <criterion comment="active scripting is enabled for the current user" negate="false" test_ref="oval:org.mitre.oval:tst:2812"/>
        </criteria>
        <criteria operator="AND" comment="local machine settings are being used and ActiveX controls and active scripting are enabled">
          <criterion comment="use machine settings rather than individual user settings" negate="false" test_ref="oval:org.mitre.oval:tst:2951"/>
          <criterion comment="ActiveX controls are enabled for the local machine" negate="false" test_ref="oval:org.mitre.oval:tst:2916"/>
          <criterion comment="active scripting is enabled for the local machine" negate="false" test_ref="oval:org.mitre.oval:tst:2811"/>
        </criteria>
      </criteria>
    </criteria>
  </criteria>
</definition>