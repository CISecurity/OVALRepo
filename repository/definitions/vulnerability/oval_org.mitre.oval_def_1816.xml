<definition xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5" class="vulnerability" id="oval:org.mitre.oval:def:1816" version="79">
  <metadata>
    <title>MsgBox (CSRSS) Remote Code Execution Vulnerability</title>
    <affected family="windows">
      <platform>Microsoft Windows 2000</platform>
      <platform>Microsoft Windows XP</platform>
      <platform>Microsoft Windows Server 2003</platform>
      <platform>Microsoft Windows Vista</platform>
    </affected>
    <reference ref_id="CVE-2006-6696" ref_url="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-6696" source="CVE" />
    <description>Double free vulnerability in Microsoft Windows 2000, XP, 2003, and Vista allows local users to gain privileges by calling the MessageBox function with a MB_SERVICE_NOTIFICATION message with crafted data, which sends a HardError message to Client/Server Runtime Server Subsystem (CSRSS) process, which is not properly handled when invoking the UserHardError and GetHardErrorText functions in WINSRV.DLL.</description>
    <oval_repository>
      <dates>
        <submitted date="2007-04-10T16:31:02">
          <contributor organization="Secure Elements, Inc.">Sudhir Gandhe</contributor>
        </submitted>
        <status_change date="2007-04-10T16:31:02.000-05:00">DRAFT</status_change>
        <status_change date="2007-04-25T19:52:19.692-04:00">INTERIM</status_change>
        <modified comment="Fixed typo in Vista criteria block: changed reference to extended def:521 (XP SP2) to def:228 (Vista)." date="2007-04-26T10:56:00.022-04:00">
          <contributor organization="ThreatGuard, Inc.">Robert L. Hollis</contributor>
        </modified>
        <modified comment="Fixed the version of winsrv.dll to 6.0.6000.16445 for Vista." date="2007-05-03T15:48:00.763-04:00">
          <contributor organization="Secure Elements, Inc.">Sudhir Gandhe</contributor>
        </modified>
        <status_change date="2007-05-23T15:05:32.840-04:00">ACCEPTED</status_change>
        <modified comment="EDITED oval:org.mitre.oval:def:1816 - Update to MS07-021" date="2011-04-07T11:19:00.389-04:00">
          <contributor organization="Symantec Corporation">Josh Turpin</contributor>
        </modified>
        <status_change date="2011-04-07T11:21:44.255-04:00">INTERIM</status_change>
        <modified comment="EDITED oval:org.mitre.oval:def:1816 - Various corrections to comments and products to align with Authoring Style Guide" date="2011-04-22T23:54:00.899-04:00">
          <contributor organization="G2, Inc.">Shane Shaffer</contributor>
        </modified>
        <status_change date="2011-05-09T04:01:21.292-04:00">ACCEPTED</status_change>
        <modified comment="EDITED oval:org.mitre.oval:def:1816 - Correcting incorrect references to 64-bit Itanium XP." date="2012-08-23T17:47:00.168-04:00">
          <contributor organization="SecPod Technologies">Chandan S</contributor>
        </modified>
        <status_change date="2012-08-23T17:51:56.307-04:00">INTERIM</status_change>
        <status_change date="2012-09-10T04:00:41.999-04:00">ACCEPTED</status_change>
        <modified comment="EDITED oval:org.mitre.oval:def:1816 - Multiple updates to several Windows OVAL entities. Includes CPE, title, and description updates. Fixed incorrectly referenced criteria. Added new criteria, fixed criteria checks, and improved criteria comments for several definitions." date="2012-11-02T20:20:00.882-04:00">
          <contributor organization="G2, Inc.">Dragos Prisaca</contributor>
        </modified>
        <status_change date="2012-11-02T20:24:47.741-04:00">INTERIM</status_change>
        <status_change date="2012-11-19T04:00:32.201-05:00">ACCEPTED</status_change>
      </dates>
      <status>ACCEPTED</status>
      <min_schema_version>5.10</min_schema_version>
    </oval_repository>
  </metadata>
  <criteria operator="OR">
    <criteria comment="Windows 2000 SP4" operator="AND">
      <extend_definition comment="Microsoft Windows 2000 SP4 or later is installed" definition_ref="oval:org.mitre.oval:def:229" />
      <criterion comment="The version of winsrv.dll is less than 5.0.2195.7135." test_ref="oval:org.mitre.oval:tst:3935" />
    </criteria>
    <criteria comment="Windows XP SP2" operator="AND">
      <extend_definition comment="Microsoft Windows XP (x86) SP2 is installed" definition_ref="oval:org.mitre.oval:def:754" />
      <criterion comment="The version of winsrv.dll is less than 5.1.2600.3103." test_ref="oval:org.mitre.oval:tst:42142" />
    </criteria>
    <criteria comment="Windows XP SP1 x64" operator="AND">
      <extend_definition comment="Microsoft Windows XP SP1 (64-bit) is installed" definition_ref="oval:org.mitre.oval:def:480" />
      <criterion comment="The version of winsrv.dll is less than 5.2.3790.2902." test_ref="oval:org.mitre.oval:tst:3229" />
    </criteria>
    <criteria comment="Windows XP SP2 x64" operator="AND">
      <extend_definition comment="Microsoft Windows XP x64 Edition SP2 is installed" definition_ref="oval:org.mitre.oval:def:4193" />
      <criterion comment="The version of winsrv.dll is less than 5.2.3790.4043." test_ref="oval:org.mitre.oval:tst:80250" />
    </criteria>
    <criteria comment="Windows Server 2003 Gold versions" operator="AND">
      <criteria comment="Windows Server 2003 x86/ia64" operator="OR">
        <extend_definition comment="Microsoft Windows Server 2003 (x86) Gold is installed" definition_ref="oval:org.mitre.oval:def:165" />
        <extend_definition comment="Microsoft Windows Server 2003 (ia64) Gold is installed" definition_ref="oval:org.mitre.oval:def:396" />
      </criteria>
      <criterion comment="The version of winsrv.dll is less than 5.2.3790.658." test_ref="oval:org.mitre.oval:tst:3288" />
    </criteria>
    <criteria comment="Windows Server 2003 SP1 versions" operator="AND">
      <criteria comment="Windows Server 2003 x86/x64/ia64 SP1" operator="OR">
        <extend_definition comment="Microsoft Windows Server 2003 SP1 (x86) is installed" definition_ref="oval:org.mitre.oval:def:565" />
        <extend_definition comment="Microsoft Windows Server 2003 SP1 (x64) is installed" definition_ref="oval:org.mitre.oval:def:4386" />
        <extend_definition comment="Microsoft Windows Server 2003 SP1 for Itanium is installed" definition_ref="oval:org.mitre.oval:def:1205" />
      </criteria>
      <criterion comment="The version of winsrv.dll is less than 5.2.3790.2902." test_ref="oval:org.mitre.oval:tst:3229" />
    </criteria>
    <criteria comment="Windows Server 2003 Service Pack 2 x86/x64/ia64 and winsrv.dll" operator="AND">
      <criteria comment="Windows Server 2003 Service Pack 2 x86/x64/ia64" operator="OR">
        <extend_definition comment="Microsoft Windows Server 2003 SP2 (x86) is installed" definition_ref="oval:org.mitre.oval:def:1935" />
        <extend_definition comment="Microsoft Windows Server 2003 SP2 (x64) is installed" definition_ref="oval:org.mitre.oval:def:2161" />
        <extend_definition comment="Microsoft Windows Server 2003 (ia64) SP2 is installed" definition_ref="oval:org.mitre.oval:def:1442" />
      </criteria>
      <criterion comment="The version of winsrv.dll is less than 5.2.3790.4043." test_ref="oval:org.mitre.oval:tst:80250" />
    </criteria>
    <criteria comment="Windows Vista" operator="AND">
      <criteria comment="Windows Vista x86/x64" operator="OR">
        <extend_definition comment="Microsoft Windows Vista is installed" definition_ref="oval:org.mitre.oval:def:228" />
        <extend_definition comment="Microsoft Windows Vista x64 Edition is installed" definition_ref="oval:org.mitre.oval:def:2041" />
      </criteria>
      <criteria comment="GRD/LDR version Check" operator="OR">
        <criterion comment="The version of winsrv.dll is less than 6.0.6000.16445." test_ref="oval:org.mitre.oval:tst:3701" />
        <criteria comment="LDR version check" operator="AND">
          <criterion comment="the version of winsrv.dll is greater than or equal 6.0.6000.20000" test_ref="oval:org.mitre.oval:tst:80223" />
          <criterion comment="the version of winsrv.dll is less than 6.0.6000.20544" test_ref="oval:org.mitre.oval:tst:79826" />
        </criteria>
      </criteria>
    </criteria>
  </criteria>
</definition>
