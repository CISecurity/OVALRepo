<?xml version="1.0" encoding="UTF-8"?>
<definition id="oval:org.mitre.oval:def:15810" version="11" class="vulnerability" xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:oval="http://oval.mitre.org/XMLSchema/oval-common-5" xmlns:oval-def="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <metadata>
    <title>Web proxy auto-discovery vulnerability - MS12-074</title>
    <affected family="windows">
      <platform>Microsoft Windows 7</platform>
      <platform>Microsoft Windows Server 2003</platform>
      <platform>Microsoft Windows Server 2008</platform>
      <platform>Microsoft Windows 8</platform>
      <platform>Microsoft Windows Server 2012</platform>
      <platform>Microsoft Windows Server 2008 R2</platform>
      <platform>Microsoft Windows Vista</platform>
      <platform>Microsoft Windows XP</platform>
      <product>Microsoft .NET Framework 2.0</product>
      <product>Microsoft .NET Framework 4.5</product>
      <product>Microsoft .NET Framework 4.0</product>
      <product>Microsoft .NET Framework 3.5</product>
      <product>Microsoft .NET Framework 3.5.1</product>
    </affected>
    <reference source="CVE" ref_id="CVE-2012-4776" ref_url="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-4776"/>
    <description>The Web Proxy Auto-Discovery (WPAD) functionality in Microsoft .NET Framework 2.0 SP2, 3.5, 3.5.1, 4, and 4.5 does not validate configuration data that is returned during acquisition of proxy settings, which allows remote attackers to execute arbitrary JavaScript code by providing crafted data during execution of (1) an XAML browser application (aka XBAP) or (2) a .NET Framework application, aka "Web Proxy Auto-Discovery Vulnerability."</description>
    <oval_repository>
      <dates>
        <submitted date="2012-11-16T17:09:38">
          <contributor organization="SecPod Technologies">SecPod Team</contributor>
        </submitted>
        <status_change date="2012-11-19T15:47:54.702-05:00">DRAFT</status_change>
        <status_change date="2012-12-10T04:00:16.092-05:00">INTERIM</status_change>
        <status_change date="2012-12-31T04:01:31.992-05:00">ACCEPTED</status_change>
        <modified comment="EDITED oval:org.mitre.oval:def:15810 - updated MS12-074 bulletin definitions with Windows 8 and Windows Server 2012 support" date="2013-03-28T13:21:00.626-04:00">
          <contributor organization="G2, Inc.">Dragos Prisaca</contributor>
        </modified>
        <status_change date="2013-03-28T13:27:05.242-04:00">INTERIM</status_change>
        <status_change date="2013-04-15T04:00:12.922-04:00">ACCEPTED</status_change>
        <modified comment="EDITED oval:org.mitre.oval:def:15810 - contains tests with modified comments and all dependences" date="2014-02-13T12:19:00.287-05:00">
          <contributor organization="ALTX-SOFT">Maria Mikhno</contributor>
        </modified>
        <status_change date="2014-02-13T12:23:07.861-05:00">INTERIM</status_change>
        <status_change date="2014-03-03T04:00:53.464-05:00">ACCEPTED</status_change>
        <modified comment="EDITED oval:org.mitre.oval:def:15810 - .NET Framework 3.5.1 instead .NET Framework 3.5 in Windows 8 and Windows Server 2012" date="2014-03-31T14:51:00.481-04:00">
          <contributor organization="ALTX-SOFT">Maria Mikhno</contributor>
        </modified>
        <status_change date="2014-03-31T14:53:52.157-04:00">INTERIM</status_change>
        <status_change date="2014-04-21T04:00:11.280-04:00">ACCEPTED</status_change>
        <modified comment="EDITED oval:org.mitre.oval:def:15810 - extended definitions of OS are without SP checks" date="2014-07-28T17:54:00.740-04:00">
          <contributor organization="ALTX-SOFT">Maria Mikhno</contributor>
        </modified>
        <status_change date="2014-07-28T17:55:56.763-04:00">INTERIM</status_change>
        <status_change date="2014-08-18T04:01:25.311-04:00">ACCEPTED</status_change>
      </dates>
      <status>ACCEPTED</status>
      <min_schema_version>5.4</min_schema_version>
    </oval_repository>
  </metadata>
  <criteria operator="OR">
    <criteria operator="AND" comment="2.0 sp2/win xp, server 2003/versions">
      <criteria operator="OR" comment="either os">
        <extend_definition comment="Microsoft Windows XP (32-bit) is installed" definition_ref="oval:org.mitre.oval:def:1353"/>
        <extend_definition comment="Microsoft Windows XP x64 is installed" definition_ref="oval:org.mitre.oval:def:15247"/>
        <extend_definition comment="Microsoft Windows Server 2003 (32-bit) is installed" definition_ref="oval:org.mitre.oval:def:1870"/>
        <extend_definition comment="Microsoft Windows Server 2003 (x64) is installed" definition_ref="oval:org.mitre.oval:def:730"/>
        <extend_definition comment="Microsoft Windows Server 2003 (ia64) Gold is installed" definition_ref="oval:org.mitre.oval:def:396"/>
      </criteria>
      <extend_definition comment="Microsoft .NET Framework 2.0 Service Pack 2 is installed" definition_ref="oval:org.mitre.oval:def:6158"/>
      <criteria operator="OR" comment="gdr/ldr">
        <criterion comment="Check if the version of mscorlib.dll is less than 2.0.50727.3643" test_ref="oval:org.mitre.oval:tst:80350"/>
        <criteria operator="AND" comment="ldr range">
          <criterion comment="Check if the version of mscorlib.dll is less than 2.0.50727.5737" test_ref="oval:org.mitre.oval:tst:80008"/>
          <criterion comment="the version of Mscorlib.dll is greater than or equal to 2.0.50727.5600" test_ref="oval:org.mitre.oval:tst:43418"/>
        </criteria>
      </criteria>
    </criteria>
    <criteria operator="AND" comment="2.0 sp2/vista, server 2008/version">
      <criteria operator="OR" comment="either os">
        <extend_definition comment="Microsoft Windows Vista x64 Edition is installed" definition_ref="oval:org.mitre.oval:def:2041"/>
        <extend_definition comment="Microsoft Windows Vista (32-bit) is installed" definition_ref="oval:org.mitre.oval:def:1282"/>
        <extend_definition comment="Microsoft Windows Server 2008 (32-bit) is installed" definition_ref="oval:org.mitre.oval:def:4870"/>
        <extend_definition comment="Microsoft Windows Server 2008 (64-bit) is installed" definition_ref="oval:org.mitre.oval:def:5356"/>
        <extend_definition comment="Microsoft Windows Server 2008 (ia-64) is installed" definition_ref="oval:org.mitre.oval:def:5667"/>
      </criteria>
      <extend_definition comment="Microsoft .NET Framework 2.0 Service Pack 2 is installed" definition_ref="oval:org.mitre.oval:def:6158"/>
      <criteria operator="OR" comment="gdr/ldr">
        <criterion comment="Check if the version of mscorlib.dll is less than 2.0.50727.4234" test_ref="oval:org.mitre.oval:tst:79437"/>
        <criteria operator="AND" comment="ldr range">
          <criterion comment="Check if the version of mscorlib.dll is less than 2.0.50727.5737" test_ref="oval:org.mitre.oval:tst:80008"/>
          <criterion comment="the version of Mscorlib.dll is greater than or equal to 2.0.50727.5600" test_ref="oval:org.mitre.oval:tst:43418"/>
        </criteria>
      </criteria>
    </criteria>
    <criteria operator="AND" comment="3.5.1/win 7/server 2008 R2/version">
      <criteria operator="OR" comment="win 7/server 2008 R2">
        <extend_definition comment="Microsoft Windows 7 is installed" definition_ref="oval:org.mitre.oval:def:12541"/>
        <extend_definition comment="Microsoft Windows Server 2008 R2 is installed" definition_ref="oval:org.mitre.oval:def:12754"/>
      </criteria>
      <extend_definition comment="Microsoft .NET Framework 3.5 SP1 is installed" definition_ref="oval:org.mitre.oval:def:12542"/>
      <criteria operator="OR" comment="gdr/ldr">
        <criterion comment="Check if the version of mscorlib.dll is less than 2.0.50727.4984" test_ref="oval:org.mitre.oval:tst:80183"/>
        <criteria operator="AND" comment="ldr range">
          <criterion comment="Check if the version of mscorlib.dll is less than 2.0.50727.5737" test_ref="oval:org.mitre.oval:tst:80008"/>
          <criterion comment="the version of Mscorlib.dll is greater than or equal to 2.0.50727.5600" test_ref="oval:org.mitre.oval:tst:43418"/>
        </criteria>
      </criteria>
    </criteria>
    <criteria operator="AND" comment="3.5.1/win 7/server 2008 R2/version">
      <criteria operator="OR" comment="win 7/server 2008 R2">
        <extend_definition comment="Microsoft Windows Server 2008 R2 Itanium-Based Edition is installed" definition_ref="oval:org.mitre.oval:def:5954"/>
        <extend_definition comment="Microsoft Windows Server 2008 R2 x64 Edition is installed" definition_ref="oval:org.mitre.oval:def:6438"/>
        <extend_definition comment="Microsoft Windows 7 (32-bit) is installed" definition_ref="oval:org.mitre.oval:def:6165"/>
        <extend_definition comment="Microsoft Windows 7 x64 Edition is installed" definition_ref="oval:org.mitre.oval:def:5950"/>
      </criteria>
      <extend_definition comment="Microsoft .NET Framework 3.5 SP1 is installed" definition_ref="oval:org.mitre.oval:def:12542"/>
      <criteria operator="OR" comment="gdr/ldr">
        <criterion comment="Check if the version of mscorlib.dll is less than 2.0.50727.5466" test_ref="oval:org.mitre.oval:tst:80110"/>
        <criteria operator="AND" comment="ldr range">
          <criterion comment="Check if the version of mscorlib.dll is less than 2.0.50727.5737" test_ref="oval:org.mitre.oval:tst:80008"/>
          <criterion comment="the version of Mscorlib.dll is greater than or equal to 2.0.50727.5600" test_ref="oval:org.mitre.oval:tst:43418"/>
        </criteria>
      </criteria>
    </criteria>
    <criteria operator="AND" comment=".net 4/veersion">
      <criteria operator="OR" comment="either os">
        <extend_definition comment="Microsoft Windows 7 (32-bit) is installed" definition_ref="oval:org.mitre.oval:def:6165"/>
        <extend_definition comment="Microsoft Windows 7 x64 Edition is installed" definition_ref="oval:org.mitre.oval:def:5950"/>
        <extend_definition comment="Microsoft Windows Server 2008 R2 Itanium-Based Edition is installed" definition_ref="oval:org.mitre.oval:def:5954"/>
        <extend_definition comment="Microsoft Windows Server 2008 R2 x64 Edition is installed" definition_ref="oval:org.mitre.oval:def:6438"/>
        <extend_definition comment="Microsoft Windows XP (32-bit) is installed" definition_ref="oval:org.mitre.oval:def:1353"/>
        <extend_definition comment="Microsoft Windows XP x64 is installed" definition_ref="oval:org.mitre.oval:def:15247"/>
        <extend_definition comment="Microsoft Windows Server 2003 (ia64) Gold is installed" definition_ref="oval:org.mitre.oval:def:396"/>
        <extend_definition comment="Microsoft Windows Server 2003 (32-bit) is installed" definition_ref="oval:org.mitre.oval:def:1870"/>
        <extend_definition comment="Microsoft Windows Server 2003 (x64) is installed" definition_ref="oval:org.mitre.oval:def:730"/>
        <extend_definition comment="Microsoft Windows Vista (32-bit) is installed" definition_ref="oval:org.mitre.oval:def:1282"/>
        <extend_definition comment="Microsoft Windows Vista x64 Edition is installed" definition_ref="oval:org.mitre.oval:def:2041"/>
        <extend_definition comment="Microsoft Windows Server 2008 (32-bit) is installed" definition_ref="oval:org.mitre.oval:def:4870"/>
        <extend_definition comment="Microsoft Windows Server 2008 (ia-64) is installed" definition_ref="oval:org.mitre.oval:def:5667"/>
        <extend_definition comment="Microsoft Windows Server 2008 (64-bit) is installed" definition_ref="oval:org.mitre.oval:def:5356"/>
      </criteria>
      <extend_definition comment="Microsoft .NET Framework 4.0 is installed" definition_ref="oval:org.mitre.oval:def:6749"/>
      <criteria operator="OR" comment="gdr/ldr">
        <criterion comment="Check if the version of mscorlib.dll is less than 4.0.30319.296" test_ref="oval:org.mitre.oval:tst:79941"/>
        <criteria operator="AND" comment="ldr range">
          <criterion comment="Check if the version of mscorlib.dll is less than 4.0.30319.586" test_ref="oval:org.mitre.oval:tst:80293"/>
          <criterion comment="the version of Mscorlib.dll is greater than or equal to 4.0.30319.400" test_ref="oval:org.mitre.oval:tst:42012"/>
        </criteria>
      </criteria>
    </criteria>
    <criteria operator="AND" comment=".net 4.5/version">
      <criteria operator="OR" comment="either os">
        <extend_definition comment="Microsoft Windows Server 2008 R2 x64 Edition is installed" definition_ref="oval:org.mitre.oval:def:6438"/>
        <extend_definition comment="Microsoft Windows 7 (32-bit) is installed" definition_ref="oval:org.mitre.oval:def:6165"/>
        <extend_definition comment="Microsoft Windows 7 x64 Edition is installed" definition_ref="oval:org.mitre.oval:def:5950"/>
        <extend_definition comment="Microsoft Windows Vista x64 Edition is installed" definition_ref="oval:org.mitre.oval:def:2041"/>
        <extend_definition comment="Microsoft Windows Vista (32-bit) is installed" definition_ref="oval:org.mitre.oval:def:1282"/>
        <extend_definition comment="Microsoft Windows Server 2008 (32-bit) is installed" definition_ref="oval:org.mitre.oval:def:4870"/>
        <extend_definition comment="Microsoft Windows Server 2008 (64-bit) is installed" definition_ref="oval:org.mitre.oval:def:5356"/>
        <extend_definition comment="Microsoft Windows Server 2008 R2 Itanium-Based Edition is installed" definition_ref="oval:org.mitre.oval:def:5954"/>
      </criteria>
      <extend_definition comment="Microsoft .NET Framework 4.5 is installed" definition_ref="oval:org.mitre.oval:def:15925"/>
      <criteria operator="OR" comment="gdr/ldr">
        <criterion comment="Check if the version of system.dll is less than 4.0.30319.18014" test_ref="oval:org.mitre.oval:tst:80200"/>
        <criteria operator="AND" comment="ldr range">
          <criterion comment="Check if the version of system.dll is less than 4.0.30319.19019" test_ref="oval:org.mitre.oval:tst:80262"/>
          <criterion comment="Check if the version of system.dll is greater than or equal 4.0.30319.19000" test_ref="oval:org.mitre.oval:tst:80130"/>
        </criteria>
      </criteria>
    </criteria>
    <criteria operator="AND" comment="windows 8/server 2012/.net 3.5/4.5/versions">
      <criteria operator="OR" comment="net 3.5/4.5/version">
        <criteria operator="AND" comment=".net 3.5/version">
          <extend_definition comment="Microsoft .NET Framework 3.5 SP1 is installed" definition_ref="oval:org.mitre.oval:def:12542"/>
          <criteria operator="OR" comment="GDR/LDR">
            <criterion comment="Check if the version of mscorlib.dll is less than 2.0.50727.6400" test_ref="oval:org.mitre.oval:tst:80354"/>
            <criteria operator="AND" comment="LDR range">
              <criterion comment="Check if the version of mscorlib.dll is greater than or equal to 2.0.50727.7000" test_ref="oval:org.mitre.oval:tst:80994"/>
              <criterion comment="Check if the version of mscorlib.dll is less than 2.0.50727.7004" test_ref="oval:org.mitre.oval:tst:80973"/>
            </criteria>
          </criteria>
        </criteria>
        <criteria operator="AND" comment=".net 4.5/versions">
          <extend_definition comment="Microsoft .NET Framework 4.5 is installed" definition_ref="oval:org.mitre.oval:def:15925"/>
          <criteria operator="OR" comment="GDR/LDR">
            <criterion comment="Check if the version of mscorlib.dll is greater than or equal to 4.0.30319.19000" test_ref="oval:org.mitre.oval:tst:80125"/>
            <criterion comment="Check if the version of mscorlib.dll is less than 4.0.30317.19010" test_ref="oval:org.mitre.oval:tst:80706"/>
          </criteria>
        </criteria>
      </criteria>
      <criteria operator="OR" comment="win 8/server 2012">
        <extend_definition comment="Microsoft Windows 8 is installed" definition_ref="oval:org.mitre.oval:def:15732"/>
        <extend_definition comment="Microsoft Windows Server 2012 is installed" definition_ref="oval:org.mitre.oval:def:16359"/>
      </criteria>
    </criteria>
  </criteria>
</definition>