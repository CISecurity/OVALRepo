<?xml version="1.0" encoding="UTF-8"?>
<definition id="oval:org.mitre.oval:def:14213" version="8" class="vulnerability">
  <metadata>
    <title>Memory Page Reuse Vulnerability in SQL Server</title>
    <affected family="windows">
      <platform>Microsoft Windows 2000</platform>
      <platform>Microsoft Windows Server 2003</platform>
      <platform>Microsoft Windows Server 2008</platform>
      <product>Microsoft SQL Server 2000</product>
      <product>Microsoft SQL Server 2005</product>
      <product>Microsoft SQL Server 2000 Desktop Engine (WMSDE)</product>
      <product>Windows Internal Database (WYukon)</product>
    </affected>
    <reference source="CVE" ref_id="CVE-2008-0085" ref_url="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-0085"/>
    <description>SQL Server 7.0 SP4, 2000 SP4, 2005 SP1 and SP2, 2000 Desktop Engine (MSDE 2000) SP4, 2005 Express Edition SP1 and SP2, and 2000 Desktop Engine (WMSDE); Microsoft Data Engine (MSDE) 1.0 SP4; and Internal Database (WYukon) SP2 does not initialize memory pages when reallocating memory, which allows database operators to obtain sensitive information (database contents) via unknown vectors related to memory page reuse.</description>
    <oval_repository>
      <dates>
        <submitted date="2011-11-15T14:16:37">
          <contributor organization="SecPod Technologies">SecPod Team</contributor>
        </submitted>
        <status_change date="2011-11-15T14:48:17.290-05:00">DRAFT</status_change>
        <modified comment="EDITED oval:org.mitre.oval:tst:9191 - Submitting 4 CVE definitions for MS08-040 bulletin that were missed in oval repo" date="2011-11-15T14:47:00.058-05:00">
          <contributor organization="SecPod Technologies">Pradeep R B</contributor>
        </modified>
        <status_change date="2011-12-05T04:00:23.496-05:00">INTERIM</status_change>
        <status_change date="2011-12-26T04:01:22.981-05:00">ACCEPTED</status_change>
        <modified comment="EDITED oval:org.mitre.oval:obj:12103 - Fixed several false positives by setting negate = true.  Also fixed several style issues." date="2011-12-28T21:13:00.551-05:00">
          <contributor organization="Symantec Corporation">Dragos Prisaca</contributor>
        </modified>
        <status_change date="2011-12-28T21:21:36.578-05:00">INTERIM</status_change>
        <status_change date="2012-01-16T04:01:36.357-05:00">ACCEPTED</status_change>
        <modified comment="EDITED oval:org.mitre.oval:obj:12081 - string var_check=&quot;all&quot; was replaced with var_check=&quot;at least one&quot;" date="2013-09-19T17:46:00.990-04:00">
          <contributor organization="ALTX-SOFT">Maria Kedovskaya</contributor>
        </modified>
        <status_change date="2013-09-19T17:49:06.527-04:00">INTERIM</status_change>
        <status_change date="2013-10-07T04:03:38.129-04:00">ACCEPTED</status_change>
      </dates>
      <status>ACCEPTED</status>
    </oval_repository>
  </metadata>
  <criteria operator="OR">
    <criteria operator="AND" comment="SQL Server 2000 SP4 - GDR">
      <criterion comment="SQL Server 2000 is installed" test_ref="oval:org.mitre.oval:tst:2977"/>
      <criterion comment="SQL Server 2000 GDR - the version of sqlservr.exe is greater than 2000.80.2000.0" test_ref="oval:org.mitre.oval:tst:9683"/>
      <criterion comment="Check if version of Sqlservr.exe is less than 2000.80.2050.0" test_ref="oval:org.mitre.oval:tst:77466"/>
    </criteria>
    <criteria operator="AND" comment="SQL Server 2000 SP4- QFE">
      <criterion comment="SQL Server 2000 is installed" test_ref="oval:org.mitre.oval:tst:2977"/>
      <criterion comment="SQL Server 2000 QFE - the version of sqlservr.exe is greater than 2000.80.2000.0" test_ref="oval:org.mitre.oval:tst:9191"/>
      <criterion comment="Check if version of Sqlservr.exe is less than 2000.80.2273.0" test_ref="oval:org.mitre.oval:tst:77541"/>
    </criteria>
    <criteria operator="OR" comment="SQL Server 2005 SP2 - GDR">
      <criteria operator="AND" comment="Check for SQL server 2005 SP2 and Vulnerable sqlservr.exe">
        <extend_definition comment="Microsoft SQL Server 2005 SP2 is installed" definition_ref="oval:org.mitre.oval:def:8397"/>
        <criterion comment="the version of sqlservr.exe is greater than or equal to 2005.90.3042.0" test_ref="oval:org.mitre.oval:tst:21203"/>
        <criterion comment="Check if version of Sqlservr.exe is less than 2005.90.3068.0" test_ref="oval:org.mitre.oval:tst:77115"/>
      </criteria>
      <criteria operator="AND" comment="Check for SQL server 2005 SP2 and Vulnerable msdtssrvr.exe">
        <extend_definition comment="Microsoft SQL Server 2005 is installed" definition_ref="oval:org.mitre.oval:def:6082"/>
        <criterion comment="HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Microsoft SQL Server\90\DTS\Setup\\SP equals 2" test_ref="oval:org.mitre.oval:tst:9558"/>
        <criterion comment="Check if version of Msdtssrvr.exe is less than 9.0.3068.0" test_ref="oval:org.mitre.oval:tst:77281"/>
        <criterion comment="The version of Msdtssrvr.exe is greater than or equal to 9.0.3042.0" test_ref="oval:org.mitre.oval:tst:21207"/>
      </criteria>
    </criteria>
    <criteria operator="OR" comment="SQL Server 2005 SP2 - QFE">
      <criteria operator="AND" comment="Check for SQL server 2005 SP2 and Vulnerable sqlservr.exe">
        <extend_definition comment="Microsoft SQL Server 2005 SP2 is installed" definition_ref="oval:org.mitre.oval:def:8397"/>
        <criterion comment="the version of sqlservr.exe is greater than or equal to 2005.90.3150.0" test_ref="oval:org.mitre.oval:tst:21007"/>
        <criterion comment="Check if version of Sqlservr.exe is less than 2005.90.3233.0" test_ref="oval:org.mitre.oval:tst:77322"/>
      </criteria>
      <criteria operator="AND" comment="Check for SQL server 2005 SP2 and Vulnerable msdtssrvr.exe">
        <extend_definition comment="Microsoft SQL Server 2005 is installed" definition_ref="oval:org.mitre.oval:def:6082"/>
        <criterion comment="HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Microsoft SQL Server\90\DTS\Setup\\SP equals 2" test_ref="oval:org.mitre.oval:tst:9558"/>
        <criterion comment="Check if version of Msdtssrvr.exe is less than 9.0.3233.0" test_ref="oval:org.mitre.oval:tst:77555"/>
        <criterion comment="The version of Msdtssrvr.exe is greater than or equal to 9.0.3150.0" test_ref="oval:org.mitre.oval:tst:21194"/>
      </criteria>
    </criteria>
  </criteria>
</definition>