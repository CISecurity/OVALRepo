<definition xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5" class="vulnerability" id="oval:org.mitre.oval:def:639" version="8">
  <metadata>
    <title>Microsoft Office Malformed String Parsing Vulnerability</title>
    <affected family="windows">
      <platform>Microsoft Windows 2000</platform>
      <platform>Microsoft Windows XP</platform>
      <platform>Microsoft Windows Server 2003</platform>
      <product>Microsoft Office</product>
    </affected>
    <reference ref_id="CVE-2006-1540" ref_url="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-1540" source="CVE" />
    <description>MSO.DLL in Microsoft Office 2000, Office XP (2002), and Office 2003 allows user-assisted attackers to cause a denial of service and execute arbitrary code via multiple attack vectors, as originally demonstrated using a crafted document record with a malformed string, as demonstrated by replacing a certain "01 00 00 00" byte sequence with an "FF FF FF FF" byte sequence, possibly causing an invalid array index, in (1) an Excel .xls document, which triggers an access violation in ole32.dll; (2) an Excel .xlw document, which triggers an access violation in excel.exe; (3) a Word document, which triggers an access violation in mso.dll in winword.exe; and (4) a PowerPoint document, which triggers an access violation in powerpnt.txt.  NOTE: after the initial disclosure, this issue was demonstrated by triggering an integer overflow using an inconsistent size for a Unicode "Sheet Name" string.</description>
    <oval_repository>
      <dates>
        <submitted date="2006-07-25T12:05:33">
          <contributor organization="ThreatGuard, Inc.">Robert L. Hollis</contributor>
        </submitted>
        <status_change date="2006-09-27T12:29:33.119-04:00">INTERIM</status_change>
        <status_change date="2006-10-16T15:58:46.086-04:00">ACCEPTED</status_change>
        <modified comment="Added application criteria." date="2007-12-29T04:31:34">
          <contributor organization="ThreatGuard, Inc.">Robert L. Hollis</contributor>
        </modified>
        <status_change date="2008-01-01T09:14:17.178-05:00">INTERIM</status_change>
        <status_change date="2008-02-04T10:19:32.273-05:00">ACCEPTED</status_change>
        <modified comment="updated to minimize false positives" date="2008-10-27T09:44:00.924-04:00">
          <contributor organization="Secure Elements, Inc.">Dragos Prisaca</contributor>
        </modified>
        <status_change date="2008-10-27T10:00:09.939-04:00">INTERIM</status_change>
        <status_change date="2008-11-17T04:00:46.619-05:00">ACCEPTED</status_change>
        <modified comment="EDITED oval:org.mitre.oval:obj:120 - Updating pre-Microsoft Office 2010 content to use windows_view behaviors." date="2012-05-10T14:55:00.075-04:00">
          <contributor organization="G2, Inc.">Shane Shaffer</contributor>
        </modified>
        <status_change date="2012-05-10T14:57:23.208-04:00">INTERIM</status_change>
        <status_change date="2012-05-28T04:02:07.525-04:00">ACCEPTED</status_change>
      </dates>
      <status>ACCEPTED</status>
      <min_schema_version>5.10</min_schema_version>
    </oval_repository>
  </metadata>
  <criteria operator="OR">
    <criteria comment="Microsoft Office 2000" operator="AND">
      <extend_definition comment="Microsoft Office 2000 is installed" definition_ref="oval:org.mitre.oval:def:93" />
      <criterion comment="The Office 2000 (or later) version of Mso9.dll is installed." test_ref="oval:org.mitre.oval:tst:194" />
      <criterion comment="the version of Mso9.dll is less than 9.0.0.8944" test_ref="oval:org.mitre.oval:tst:122" />
    </criteria>
    <criteria comment="Microsoft Office XP" operator="AND">
      <extend_definition comment="Microsoft Office XP is installed" definition_ref="oval:org.mitre.oval:def:663" />
      <criterion comment="The Office XP (or later) version of Mso.dll is installed." test_ref="oval:org.mitre.oval:tst:139" />
      <criterion comment="the version of Mso.dll is less than 10.0.6804.0." test_ref="oval:org.mitre.oval:tst:141" />
    </criteria>
    <criteria comment="Microsoft Office 2003" operator="AND">
      <extend_definition comment="Microsoft Office 2003 is installed" definition_ref="oval:org.mitre.oval:def:233" />
      <criterion comment="The Office 2003 (or later) version of Mso.dll is installed." test_ref="oval:org.mitre.oval:tst:69" />
      <criterion comment="the version of Mso.dll is less than 11.0.8028.0." test_ref="oval:org.mitre.oval:tst:169" />
    </criteria>
    <criteria comment="Microsoft Project 2000" operator="AND">
      <extend_definition comment="Microsoft Project 2000 SR1 is installed" definition_ref="oval:org.mitre.oval:def:518" />
      <criterion comment="The Office 2000 (or later) version of Mso9.dll is installed." test_ref="oval:org.mitre.oval:tst:194" />
      <criterion comment="the version of Mso9.dll is less than 9.0.0.8944" test_ref="oval:org.mitre.oval:tst:122" />
    </criteria>
    <criteria comment="Microsoft Project 2002" operator="AND">
      <extend_definition comment="Microsoft Project 2002 SP1 is installed" definition_ref="oval:org.mitre.oval:def:707" />
      <criterion comment="The Office XP (or later) version of Mso.dll is installed." test_ref="oval:org.mitre.oval:tst:139" />
      <criterion comment="the version of Mso.dll is less than 10.0.6804.0." test_ref="oval:org.mitre.oval:tst:141" />
    </criteria>
    <criteria comment="Microsoft Office Visio 2002" operator="AND">
      <extend_definition comment="Microsoft Office Visio 2002 SP2 is installed" definition_ref="oval:org.mitre.oval:def:692" />
      <criterion comment="The Office XP (or later) version of Mso.dll is installed." test_ref="oval:org.mitre.oval:tst:139" />
      <criterion comment="the version of Mso.dll is less than 10.0.6804.0." test_ref="oval:org.mitre.oval:tst:141" />
    </criteria>
    <criteria comment="Microsoft Word Viewer" operator="AND">
      <extend_definition comment="Microsoft Word Viewer is installed" definition_ref="oval:org.mitre.oval:def:737" />
      <criterion comment="The Office 2003 (or later) version of Mso.dll is installed." test_ref="oval:org.mitre.oval:tst:69" />
      <criterion comment="the version of Mso.dll is less than 11.0.8028.0." test_ref="oval:org.mitre.oval:tst:169" />
    </criteria>
    <criteria comment="Microsoft Excel Viewer 2003" operator="AND">
      <extend_definition comment="Microsoft Excel Viewer 2003 is installed" definition_ref="oval:org.mitre.oval:def:439" />
      <criterion comment="The Office 2003 (or later) version of Mso.dll is installed." test_ref="oval:org.mitre.oval:tst:69" />
      <criterion comment="the version of Mso.dll is less than 11.0.8028.0." test_ref="oval:org.mitre.oval:tst:169" />
    </criteria>
  </criteria>
</definition>
