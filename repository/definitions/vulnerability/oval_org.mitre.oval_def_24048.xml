<definition xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5" class="vulnerability" id="oval:org.mitre.oval:def:24048" version="82">
  <metadata>
    <title>SAMR security feature bypass vulnerability (CVE-2014-0317) - MS14-016</title>
    <affected family="windows">
      <platform>Microsoft Windows XP</platform>
      <platform>Microsoft Windows Server 2003</platform>
      <platform>Microsoft Windows Server 2008</platform>
      <platform>Microsoft Windows Server 2008 R2</platform>
      <platform>Microsoft Windows Vista</platform>
      <platform>Microsoft Windows Server 2012</platform>
      <platform>Microsoft Windows Server 2012 R2</platform>
      <product>Active Directory</product>
      <product>Active Directory Application Mode</product>
      <product>Active Directory Lightweight Directory Service</product>
    </affected>
    <reference ref_id="CVE-2014-0317" ref_url="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-0317" source="CVE" />
    <description>The Security Account Manager Remote (SAMR) protocol implementation in Microsoft Windows XP SP2 and SP3, Windows Server 2003 SP2, Windows Vista SP2, Windows Server 2008 SP2 and R2 SP1, and Windows Server 2012 Gold and R2 does not properly determine the user-lockout state, which makes it easier for remote attackers to bypass the account lockout policy and obtain access via a brute-force attack, aka "SAMR Security Feature Bypass Vulnerability."</description>
    <oval_repository>
      <dates>
        <submitted date="2014-03-14T17:32:25">
          <contributor organization="SecPod Technologies">SecPod Team</contributor>
        </submitted>
        <status_change date="2014-03-18T14:42:01.927-04:00">DRAFT</status_change>
        <modified comment="EDITED oval:org.mitre.oval:tst:89195 - bulletin MS14-016, for the month of Mar 2014." date="2014-03-18T14:40:00.553-04:00">
          <contributor organization="SecPod Technologies">Pooja Shetty</contributor>
        </modified>
        <status_change date="2014-04-07T04:06:41.394-04:00">INTERIM</status_change>
        <status_change date="2014-04-28T04:07:11.708-04:00">ACCEPTED</status_change>
        <modified comment="EDITED oval:org.mitre.oval:def:24048 - extended definitions of OS are without SP checks" date="2014-07-28T18:08:00.084-04:00">
          <contributor organization="ALTX-SOFT">Maria Mikhno</contributor>
        </modified>
        <status_change date="2014-07-28T18:10:09.460-04:00">INTERIM</status_change>
        <status_change date="2014-08-18T04:02:27.169-04:00">ACCEPTED</status_change>
        <modified comment="EDITED oval:org.mitre.oval:def:24048 - Modified def:24048 to replace tst:112504 with a wmi57_test." date="2014-10-23T00:13:00.732-04:00">
          <contributor organization="ALTX-SOFT">Maria Mikhno</contributor>
        </modified>
        <status_change date="2014-10-23T00:18:08.857-04:00">INTERIM</status_change>
        <status_change date="2014-11-10T04:01:11.653-05:00">ACCEPTED</status_change>
        <modified comment="EDITED oval:org.mitre.oval:def:24048 - Modified vulnerabilities - a lot of fixes" date="2015-07-22T13:39:00.268-04:00">
          <contributor organization="ALTX-SOFT">Maria Mikhno</contributor>
        </modified>
        <status_change date="2015-07-22T13:41:48.019-04:00">INTERIM</status_change>
        <status_change date="2015-08-10T04:00:25.179-04:00">ACCEPTED</status_change>
      </dates>
      <status>ACCEPTED</status>
      <min_schema_version>5.10</min_schema_version>
    </oval_repository>
  </metadata>
  <criteria operator="OR">
    <criteria comment="Win 2k3 vulnerable version" operator="AND">
      <criteria comment="Win 2k3" operator="OR">
        <extend_definition comment="Microsoft Windows Server 2003 (32-bit) is installed" definition_ref="oval:org.mitre.oval:def:1870" />
        <extend_definition comment="Microsoft Windows Server 2003 (x64) is installed" definition_ref="oval:org.mitre.oval:def:730" />
        <extend_definition comment="Microsoft Windows Server 2003 (ia64) Gold is installed" definition_ref="oval:org.mitre.oval:def:396" />
      </criteria>
      <criterion comment="Check if the version of samsrv.dll is less than 5.2.3790.5297" test_ref="oval:org.mitre.oval:tst:112741" />
      <criterion comment="NTDS Service is installed" test_ref="oval:org.mitre.oval:tst:42615" />
      <extend_definition comment="Active Directory service is installed" definition_ref="oval:org.mitre.oval:def:29407" />
    </criteria>
    <criteria comment="Win XP / 2k3 _ADAM file version" operator="AND">
      <criteria comment="Win XP / Win 2K3" operator="OR">
        <extend_definition comment="Microsoft Windows Server 2003 (32-bit) is installed" definition_ref="oval:org.mitre.oval:def:1870" />
        <extend_definition comment="Microsoft Windows Server 2003 (x64) is installed" definition_ref="oval:org.mitre.oval:def:730" />
        <extend_definition comment="Microsoft Windows XP x64 is installed" definition_ref="oval:org.mitre.oval:def:15247" />
      </criteria>
      <criterion comment="Check if the version of the Adamdsa.dll is less than 1.1.3790.5297" test_ref="oval:org.mitre.oval:tst:112824" />
      <criterion comment="Check if ADAM service is installed" test_ref="oval:org.mitre.oval:tst:89195" />
      <extend_definition comment="Active Directory Application Mode is installed" definition_ref="oval:org.mitre.oval:def:29272" />
    </criteria>
    <criteria comment="Win 2k8 / Vista and vulnerable version of file" operator="AND">
      <criteria comment="Win Vista / 2K8" operator="OR">
        <extend_definition comment="Microsoft Windows Vista x64 Edition is installed" definition_ref="oval:org.mitre.oval:def:2041" />
        <extend_definition comment="Microsoft Windows Vista (32-bit) is installed" definition_ref="oval:org.mitre.oval:def:1282" />
        <extend_definition comment="Microsoft Windows Server 2008 (32-bit) is installed" definition_ref="oval:org.mitre.oval:def:4870" />
        <extend_definition comment="Microsoft Windows Server 2008 (64-bit) is installed" definition_ref="oval:org.mitre.oval:def:5356" />
      </criteria>
      <criteria comment="GDR / LDR" operator="OR">
        <criterion comment="Check if the version of samsrv.dll is less than 6.0.6002.19029" test_ref="oval:org.mitre.oval:tst:112814" />
        <criteria comment="LDR range" operator="AND">
          <criterion comment="Check if the version of samsrv.dll is less than 6.0.6002.23317" test_ref="oval:org.mitre.oval:tst:111958" />
          <criterion comment="Check if the version of samsrv.dll is greater than or equal to 6.0.6002.23000" test_ref="oval:org.mitre.oval:tst:112934" />
        </criteria>
      </criteria>
      <extend_definition comment="Active Directory Lightweight Directory Service is installed" definition_ref="oval:org.mitre.oval:def:29065" />
    </criteria>
    <criteria comment="2k8 R2 base and vulnerable file version" operator="AND">
      <extend_definition comment="Microsoft Windows Server 2008 R2 x64 Edition is installed" definition_ref="oval:org.mitre.oval:def:6438" />
      <criteria comment="GDR / LDR" operator="OR">
        <criterion comment="Check if the version of samsrv.dll is less than 6.1.7601.18377" test_ref="oval:org.mitre.oval:tst:112881" />
        <criteria comment="LDR range" operator="AND">
          <criterion comment="Check if the version of samsrv.dll is less than 6.1.7601.22579" test_ref="oval:org.mitre.oval:tst:112623" />
          <criterion comment="Check if the version of samsrv.dll is greater than or equal to 6.1.7601.22000" test_ref="oval:org.mitre.oval:tst:112540" />
        </criteria>
      </criteria>
      <extend_definition comment="Active Directory Lightweight Directory Service is installed" definition_ref="oval:org.mitre.oval:def:29065" />
    </criteria>
    <criteria comment="Microsoft Windows 2012 and vulnerable file version" operator="AND">
      <extend_definition comment="Microsoft Windows Server 2012 is installed" definition_ref="oval:org.mitre.oval:def:16359" />
      <criteria comment="GDR / LDR range" operator="OR">
        <criterion comment="Check if the version of the samsrv.dll is less than 6.2.9200.16791" test_ref="oval:org.mitre.oval:tst:112431" />
        <criteria comment="LDR range" operator="AND">
          <criterion comment="Check if the version of samsrv.dll is less than 6.2.9200.20910" test_ref="oval:org.mitre.oval:tst:112686" />
          <criterion comment="Check if the version os samsrv.dll is greater than or equal to 6.2.9200.20000" test_ref="oval:org.mitre.oval:tst:112463" />
        </criteria>
      </criteria>
      <extend_definition comment="Active Directory Lightweight Directory Service is installed" definition_ref="oval:org.mitre.oval:def:29065" />
    </criteria>
    <criteria comment="Win XP (x86) and file version" operator="AND">
      <extend_definition comment="Microsoft Windows XP (32-bit) is installed" definition_ref="oval:org.mitre.oval:def:1353" />
      <criterion comment="Check if the version of Adamdsa.dll is less than 1.1.3790.5289" test_ref="oval:org.mitre.oval:tst:112624" />
      <criterion comment="Check if ADAM service is installed" test_ref="oval:org.mitre.oval:tst:89195" />
      <extend_definition comment="Active Directory Application Mode is installed" definition_ref="oval:org.mitre.oval:def:29272" />
    </criteria>
    <criteria comment="Win Server 2012 R2 and file version" operator="AND">
      <extend_definition comment="Microsoft Windows Server 2012 R2 is installed" definition_ref="oval:org.mitre.oval:def:18858" />
      <criterion comment="Check if the version of samsrv.dll is less than 6.3.9600.16506" test_ref="oval:org.mitre.oval:tst:112915" />
      <extend_definition comment="Active Directory Lightweight Directory Service is installed" definition_ref="oval:org.mitre.oval:def:29065" />
    </criteria>
  </criteria>
</definition>
