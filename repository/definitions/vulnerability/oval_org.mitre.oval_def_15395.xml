<?xml version="1.0" encoding="UTF-8"?>
<definition id="oval:org.mitre.oval:def:15395" version="10" class="vulnerability">
  <metadata>
    <title>Reflected XSS Vulnerability - MS12-070</title>
    <affected family="windows">
      <platform>Microsoft Windows 2000</platform>
      <platform>Microsoft Windows 7</platform>
      <platform>Microsoft Windows Server 2003</platform>
      <platform>Microsoft Windows Server 2008</platform>
      <platform>Microsoft Windows Server 2008 R2</platform>
      <platform>Microsoft Windows Vista</platform>
      <platform>Microsoft Windows XP</platform>
      <product>Microsoft SQL Server 2000 Reporting Services</product>
      <product>Microsoft SQL Server 2005</product>
      <product>Microsoft SQL Server 2008</product>
      <product>Microsoft SQL Server 2008 R2</product>
      <product>Microsoft SQL Server 2012</product>
    </affected>
    <reference source="CVE" ref_id="CVE-2012-2552" ref_url="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-2552"/>
    <description>Cross-site scripting (XSS) vulnerability in the SQL Server Report Manager in Microsoft SQL Server 2000 Reporting Services SP2 and SQL Server 2005 SP4, 2008 SP2 and SP3, 2008 R2 SP1, and 2012 allows remote attackers to inject arbitrary web script or HTML via an unspecified parameter, aka "Reflected XSS Vulnerability."</description>
    <oval_repository>
      <dates>
        <submitted date="2012-10-17T11:08:27">
          <contributor organization="SecPod Technologies">SecPod Team</contributor>
        </submitted>
        <status_change date="2012-10-19T17:05:37.497-04:00">DRAFT</status_change>
        <status_change date="2012-11-05T04:00:07.547-05:00">INTERIM</status_change>
        <status_change date="2012-11-26T04:00:07.182-05:00">ACCEPTED</status_change>
        <modified comment="EDITED oval:org.mitre.oval:var:150 - Added closing anchors for variable regex" date="2013-04-08T11:01:00.574-04:00">
          <contributor organization="G2, Inc.">Shane Shaffer</contributor>
        </modified>
        <status_change date="2013-04-08T11:04:03.202-04:00">INTERIM</status_change>
        <modified comment="EDITED oval:org.mitre.oval:obj:24084 - The attached file contains modified objects and variable in the oval:org.mitre.oval:def:15395." date="2013-04-15T20:56:00.985-04:00">
          <contributor organization="ALTX-SOFT">Sergey Artykhov</contributor>
        </modified>
        <status_change date="2013-05-06T04:01:26.655-04:00">ACCEPTED</status_change>
        <modified comment="EDITED oval:org.mitre.oval:def:15395 - New criteria SQL Reporting Services exist added to avoid errors" date="2014-04-15T08:19:00.021-04:00">
          <contributor organization="ALTX-SOFT">Maria Mikhno</contributor>
        </modified>
        <status_change date="2014-04-15T08:21:21.985-04:00">INTERIM</status_change>
        <status_change date="2014-05-05T04:00:12.892-04:00">ACCEPTED</status_change>
        <modified comment="EDITED oval:org.mitre.oval:obj:309 - Modified criteria to match MS bulletin" date="2014-06-13T14:52:00.642-04:00">
          <contributor organization="ALTX-SOFT">Maria Mikhno</contributor>
        </modified>
        <status_change date="2014-06-13T14:56:16.938-04:00">INTERIM</status_change>
        <status_change date="2014-06-30T04:05:45.231-04:00">ACCEPTED</status_change>
      </dates>
      <status>ACCEPTED</status>
    </oval_repository>
  </metadata>
  <criteria>
    <criterion comment="SQL Reporting Services exist" test_ref="oval:org.mitre.oval:tst:113660"/>
    <criteria operator="OR" comment="Check for vulnerable SQL">
      <criteria operator="AND" comment="Check for vulnerable SQL 2000 Reporting Services">
        <extend_definition comment="Microsoft SQL Server 2000 Reporting Services SP2 is installed" definition_ref="oval:org.mitre.oval:def:15635"/>
        <criterion comment="Check if version of Reportingservicesservice.exe is less than 8.0.1077.0" test_ref="oval:org.mitre.oval:tst:80205"/>
        <criterion comment="Check if version of Reportingservicesservice.exe is greater than or equal to 8.0.1038.0" test_ref="oval:org.mitre.oval:tst:79625"/>
      </criteria>
      <criteria operator="AND" comment="Check for vulnerable SQL Server 2005 SP4 and file version">
        <criteria operator="OR" comment="Check for vulnerable SQL Server 2005 SP4">
          <criteria operator="AND" comment="Check for vulnerable SQL Server 2005 SP4 GDR">
            <criterion comment="Check if version of microsoft.reportingservices.diagnostics.dll is greater than or equal to 9.0.5000.0" test_ref="oval:org.mitre.oval:tst:79310"/>
            <criterion comment="Check if version of microsoft.reportingservices.diagnostics.dll is less than 9.0.5069.0" test_ref="oval:org.mitre.oval:tst:80190"/>
          </criteria>
          <criteria operator="AND" comment="Check for vulnerable SQL Server 2005 SP4 QFE">
            <criterion comment="Check if version of microsoft.reportingservices.diagnostics.dll is greater than or equal to 9.0.5200.0" test_ref="oval:org.mitre.oval:tst:79621"/>
            <criterion comment="Check if version of microsoft.reportingservices.diagnostics.dll is less than 9.0.5324.0" test_ref="oval:org.mitre.oval:tst:79855"/>
          </criteria>
        </criteria>
        <extend_definition comment="Microsoft SQL Server 2005 SP4 is installed" definition_ref="oval:org.mitre.oval:def:12442"/>
      </criteria>
      <criteria operator="AND" comment="Check for vulnerable SQL Server 2008 SP2 and file version">
        <criteria operator="OR" comment="Check for vulnerable SQL Server 2008 SP2">
          <criteria operator="AND" comment="Check for vulnerable SQL Server 2008 SP2 GDR">
            <criterion comment="Check if version of microsoft.reportingservices.diagnostics.dll is greater than or equal to 10.0.4000.0" test_ref="oval:org.mitre.oval:tst:80168"/>
            <criterion comment="Check if version of microsoft.reportingservices.diagnostics.dll is less than 10.0.4067.0" test_ref="oval:org.mitre.oval:tst:80309"/>
          </criteria>
          <criteria operator="AND" comment="Check for vulnerable SQL Server 2008 SP2 QFE">
            <criterion comment="Check if version of microsoft.reportingservices.diagnostics.dll is greater than or equal to 10.0.4260.0" test_ref="oval:org.mitre.oval:tst:79837"/>
            <criterion comment="Check if version of microsoft.reportingservices.diagnostics.dll is less than 10.0.4371.0" test_ref="oval:org.mitre.oval:tst:79334"/>
          </criteria>
        </criteria>
        <extend_definition comment="Microsoft SQL Server 2008 SP2 is installed" definition_ref="oval:org.mitre.oval:def:12310"/>
      </criteria>
      <criteria operator="AND" comment="Check for vulnerable SQL Server 2008 SP3 and file version">
        <criteria operator="OR" comment="Check for vulnerable SQL Server 2008 SP3">
          <criteria operator="AND" comment="Check for vulnerable SQL Server 2008 SP3 GDR">
            <criterion comment="Check if version of microsoft.reportingservices.diagnostics.dll is greater than or equal to 10.0.5500.0" test_ref="oval:org.mitre.oval:tst:80258"/>
            <criterion comment="Check if version of microsoft.reportingservices.diagnostics.dll is less than 10.0.5512.0" test_ref="oval:org.mitre.oval:tst:80267"/>
          </criteria>
          <criteria operator="AND" comment="Check for vulnerable SQL Server 2008 SP3 QFE">
            <criterion comment="Check if version of microsoft.reportingservices.diagnostics.dll is greater than or equal to 10.0.5750.0" test_ref="oval:org.mitre.oval:tst:80266"/>
            <criterion comment="Check if version of microsoft.reportingservices.diagnostics.dll is less than 10.0.5826.0" test_ref="oval:org.mitre.oval:tst:80305"/>
          </criteria>
        </criteria>
        <extend_definition comment="Microsoft SQL Server 2008 SP3 is installed" definition_ref="oval:org.mitre.oval:def:15497"/>
      </criteria>
      <criteria operator="AND" comment="Check for vulnerable SQL Server 2008 R2 SP1 and file version">
        <criteria operator="OR" comment="Check for vulnerable SQL Server 2008 R2 SP1">
          <criteria operator="AND" comment="Check for vulnerable SQL Server 2008 R2 SP1 GDR">
            <criterion comment="Check if version of microsoft.reportingservices.diagnostics.dll is greater than or equal to 10.50.2500.0" test_ref="oval:org.mitre.oval:tst:80323"/>
            <criterion comment="Check if version of microsoft.reportingservices.diagnostics.dll is less than 10.50.2550.0" test_ref="oval:org.mitre.oval:tst:79344"/>
          </criteria>
          <criteria operator="AND" comment="Check for vulnerable SQL Server 2008 R2 SP1 QFE">
            <criterion comment="Check if version of microsoft.reportingservices.diagnostics.dll is greater than or equal to 10.50.2750.0" test_ref="oval:org.mitre.oval:tst:80135"/>
            <criterion comment="Check if version of microsoft.reportingservices.diagnostics.dll is less than 10.50.2861.0" test_ref="oval:org.mitre.oval:tst:80285"/>
          </criteria>
        </criteria>
        <extend_definition comment="Microsoft SQL Server 2008 R2 SP1 is installed" definition_ref="oval:org.mitre.oval:def:15808"/>
      </criteria>
      <criteria operator="AND" comment="Check for vulnerable SQL Server 2012 and file version">
        <criteria operator="OR" comment="Check for vulnerable SQL Server 2012">
          <criteria operator="AND" comment="Check for vulnerable SQL Server 2012 GDR">
            <criterion comment="Check if version of microsoft.reportingservices.diagnostics.dll is greater than or equal to 11.0.2100.0" test_ref="oval:org.mitre.oval:tst:80152"/>
            <criterion comment="Check if version of microsoft.reportingservices.diagnostics.dll is less than 11.0.2218.0" test_ref="oval:org.mitre.oval:tst:80063"/>
          </criteria>
          <criteria operator="AND" comment="Check for vulnerable SQL Server 2012 QFE">
            <criterion comment="Check if version of microsoft.reportingservices.diagnostics.dll is greater than or equal to 11.0.2300.0" test_ref="oval:org.mitre.oval:tst:80320"/>
            <criterion comment="Check if version of microsoft.reportingservices.diagnostics.dll is less than 11.0.2376.0" test_ref="oval:org.mitre.oval:tst:80298"/>
          </criteria>
        </criteria>
        <extend_definition comment="Microsoft SQL Server 2012 is installed" definition_ref="oval:org.mitre.oval:def:15044"/>
      </criteria>
    </criteria>
  </criteria>
</definition>