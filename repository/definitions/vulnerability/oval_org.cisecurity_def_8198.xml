<definition xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5" class="vulnerability" id="oval:org.cisecurity:def:8198" version="5">
  <metadata>
    <title>Vulnerability in PostgreSQL 9.3.x before 9.3.21, 9.4.x before 9.4.16, 9.5.x before 9.5.11, 9.6.x before 9.6.7 and 10.x before 10.2 (CVE-2018-1053)</title>
    <affected family="windows">
      <platform>Microsoft Windows XP</platform>
      <platform>Microsoft Windows Vista</platform>
      <platform>Microsoft Windows 7</platform>
      <platform>Microsoft Windows 8</platform>
      <platform>Microsoft Windows 8.1</platform>
      <platform>Microsoft Windows 10</platform>
      <platform>Microsoft Windows Server 2003</platform>
      <platform>Microsoft Windows Server 2008</platform>
      <platform>Microsoft Windows Server 2008 R2</platform>
      <platform>Microsoft Windows Server 2012</platform>
      <platform>Microsoft Windows Server 2012 R2</platform>
      <platform>Microsoft Windows Server 2016</platform>
      <product>PostgreSQL</product>
    </affected>
    <reference source="CVE" ref_url="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-1053" ref_id="CVE-2018-1053" />
    <description>In postgresql 9.3.x before 9.3.21, 9.4.x before 9.4.16, 9.5.x before 9.5.11, 9.6.x before 9.6.7 and 10.x before 10.2, pg_upgrade creates file in current working directory containing the output of `pg_dumpall -g` under umask which was in effect when the user invoked pg_upgrade, and not under 0077 which is normally used for other temporary files. This can allow an authenticated attacker to read or modify the one file, which may contain encrypted or unencrypted database passwords.</description>
    <oval_repository>
      <dates>
        <submitted date="2020-08-13T09:27:06">
          <contributor organization="ALTX-SOFT">Alexandr Ruchkin</contributor>
        </submitted>
        <status_change date="2020-08-13T16:00:00.000-05:00">DRAFT</status_change>
        <status_change date="2020-08-28T11:45:00.887-04:00">INTERIM</status_change>
      </dates>
      <status>INTERIM</status>
      <min_schema_version>5.10</min_schema_version>
    </oval_repository>
  </metadata>
  <criteria operator="OR">
    <criteria comment="PostgreSQL 9.3 section" operator="AND">
      <extend_definition definition_ref="oval:org.mitre.oval:def:6785" comment="PostgreSQL is installed" />
      <criterion comment="Check if the version of PostgreSQL 9.3 is greater than or equal 9.3.0 and less than 9.3.21" test_ref="oval:org.cisecurity:tst:16756" />
    </criteria>
    <criteria comment="PostgreSQL 9.4 section" operator="AND">
      <extend_definition definition_ref="oval:org.mitre.oval:def:6785" comment="PostgreSQL is installed" />
      <criterion comment="Check if the version of PostgreSQL 9.4 is greater than or equal 9.4.0 and less than 9.4.16" test_ref="oval:org.cisecurity:tst:16802" />
    </criteria>
    <criteria comment="PostgreSQL 10 section" operator="AND">
      <extend_definition definition_ref="oval:org.mitre.oval:def:6785" comment="PostgreSQL is installed" />
      <criterion comment="Check if the version of PostgreSQL 10 is greater than or equal 10.0.0 and less than 10.2" test_ref="oval:org.cisecurity:tst:16712" />
    </criteria>
    <criteria comment="PostgreSQL 9.6 section" operator="AND">
      <extend_definition definition_ref="oval:org.mitre.oval:def:6785" comment="PostgreSQL is installed" />
      <criterion comment="Check if the version of PostgreSQL 9.6 is greater than or equal 9.6.0 and less than 9.6.7" test_ref="oval:org.cisecurity:tst:16745" />
    </criteria>
    <criteria comment="PostgreSQL 9.5 section" operator="AND">
      <extend_definition definition_ref="oval:org.mitre.oval:def:6785" comment="PostgreSQL is installed" />
      <criterion comment="Check if the version of PostgreSQL 9.5 is greater than or equal 9.5.0 and less than 9.5.11" test_ref="oval:org.cisecurity:tst:16793" />
    </criteria>
  </criteria>
</definition>
