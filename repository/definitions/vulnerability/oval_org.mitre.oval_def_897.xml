<?xml version="1.0" encoding="UTF-8"?>
<definition id="oval:org.mitre.oval:def:897" version="2" class="vulnerability">
  <metadata>
    <title>Windows NT WMF/EMF Buffer Overflow</title>
    <affected family="windows">
      <platform>Microsoft Windows NT</platform>
      <product>Enhanced Metafile (EMF)</product>
      <product>Windows Metafile (WMF)</product>
    </affected>
    <reference source="CVE" ref_id="CVE-2003-0906" ref_url="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2003-0906"/>
    <description>Buffer overflow in the rendering for (1) Windows Metafile (WMF) or (2) Enhanced Metafile (EMF) image formats in Microsoft Windows NT 4.0 SP6a, 2000 SP2 through SP4, and XP SP1 allows remote attackers to execute arbitrary code via a malformed WMF or EMF image.</description>
    <oval_repository>
      <dates>
        <submitted date="2004-04-13T12:00:00.000-04:00">
          <contributor organization="The MITRE Corporation">Andrew Buttner</contributor>
        </submitted>
        <status_change date="2004-05-05T12:00:00.000-04:00">INTERIM</status_change>
        <status_change date="2004-05-25T12:00:00.000-04:00">ACCEPTED</status_change>
        <modified comment="Removed reference to test for nt 4.0 and add reference to nt 4.0 inventory definition." date="2008-02-28T12:48:00.621-04:00">
          <contributor organization="The MITRE Corporation">Jonathan Baker</contributor>
        </modified>
        <status_change date="2008-03-03T04:00:59.512-05:00">INTERIM</status_change>
        <status_change date="2008-03-24T04:00:53.087-04:00">ACCEPTED</status_change>
      </dates>
      <status>ACCEPTED</status>
    </oval_repository>
  </metadata>
  <criteria operator="AND" comment="Software section">
    <extend_definition comment="Microsoft Windows NT is installed" definition_ref="oval:org.mitre.oval:def:36"/>
    <criteria operator="OR" comment="a vulnerable version of mf3216.dll exists on NT">
      <criteria operator="AND" comment="non Terminal Server and mf3216.dll is less than 4.0.1381.7263">
        <criterion negate="true" comment="this is an NT Terminal Server" test_ref="oval:org.mitre.oval:tst:3097"/>
        <criterion comment="the version of mf3216.dll is less than 4.0.1381.7263" test_ref="oval:org.mitre.oval:tst:1492"/>
      </criteria>
      <criteria operator="AND" comment="NT Terminal Server and mf3216.dll is less than 4.0.1381.33562">
        <criterion comment="this is an NT Terminal Server" test_ref="oval:org.mitre.oval:tst:3097"/>
        <criterion comment="the version of mf3216.dll is less than 4.0.1381.33562" test_ref="oval:org.mitre.oval:tst:1491"/>
      </criteria>
    </criteria>
    <criterion negate="true" comment="the patch kb835732 is installed" test_ref="oval:org.mitre.oval:tst:1510"/>
  </criteria>
</definition>