<definition xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5" class="vulnerability" id="oval:org.mitre.oval:def:6011" version="52">
  <metadata>
    <title>SChannel Spoofing Vulnerability</title>
    <affected family="windows">
      <platform>Microsoft Windows 2000</platform>
      <platform>Microsoft Windows XP</platform>
      <platform>Microsoft Windows Server 2003</platform>
      <platform>Microsoft Windows Vista</platform>
      <platform>Microsoft Windows Server 2008</platform>
    </affected>
    <reference ref_id="CVE-2009-0085" ref_url="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-0085" source="CVE" />
    <description>The Secure Channel (aka SChannel) authentication component in Microsoft Windows 2000 SP4, XP SP2 and SP3, Server 2003 SP1 and SP2, Vista Gold and SP1, and Server 2008, when certificate authentication is used, does not properly validate the client's key exchange data in Transport Layer Security (TLS) handshake messages, which allows remote attackers to spoof authentication by crafting a TLS packet based on knowledge of the certificate but not the private key, aka "SChannel Spoofing Vulnerability."</description>
    <oval_repository>
      <dates>
        <submitted date="2009-03-10T16:00:00">
          <contributor organization="Gideon Technologies, Inc.">Dragos Prisaca</contributor>
        </submitted>
        <status_change date="2009-03-13T20:24:00.338-04:00">DRAFT</status_change>
        <status_change date="2009-03-30T04:00:20.311-04:00">INTERIM</status_change>
        <status_change date="2009-04-20T04:00:18.909-04:00">ACCEPTED</status_change>
        <modified comment="EDITED oval:org.mitre.oval:def:6011 - LDR version criteria are added for Vista &amp; 2008, and also added non-root criterion comments" date="2011-10-04T13:14:00.818-04:00">
          <contributor organization="SecPod Technologies">Rachana Shetty</contributor>
        </modified>
        <status_change date="2011-10-04T13:16:11.404-04:00">INTERIM</status_change>
        <status_change date="2011-10-24T04:00:17.494-04:00">ACCEPTED</status_change>
      </dates>
      <status>ACCEPTED</status>
      <min_schema_version>5.4</min_schema_version>
    </oval_repository>
  </metadata>
  <criteria operator="OR">
    <criteria comment="Microsoft Windows 2000 SP4 is installed and schannel.dll file version" operator="AND">
      <extend_definition comment="Microsoft Windows 2000 SP4 or later is installed" definition_ref="oval:org.mitre.oval:def:229" />
      <criterion comment="the version of schannel.dll is less than 5.1.2195.7213" test_ref="oval:org.mitre.oval:tst:9387" />
    </criteria>
    <criteria comment="Microsoft Windows XP (x86) SP2 is installed and schannel.dll file version" operator="AND">
      <extend_definition comment="Microsoft Windows XP (x86) SP2 is installed" definition_ref="oval:org.mitre.oval:def:754" />
      <criterion comment="the version of schannel.dll is less than 5.1.2600.3487" test_ref="oval:org.mitre.oval:tst:9506" />
    </criteria>
    <criteria comment="Microsoft Windows XP (x86) SP3 is installed and schannel.dll file version" operator="AND">
      <extend_definition comment="Microsoft Windows XP (x86) SP3 is installed" definition_ref="oval:org.mitre.oval:def:5631" />
      <criterion comment="the version of schannel.dll is less than 5.1.2600.5721" test_ref="oval:org.mitre.oval:tst:9556" />
    </criteria>
    <criteria comment="Microsoft Windows XP x64/Windows server 2003 (x86/x64/ia64) SP1 is installed and schannel.dll file version" operator="AND">
      <criteria comment="Microsoft Windows XP x64/Microsoft Windows server 2003 (x86/x64/ia64) SP1 is installed" operator="OR">
        <extend_definition comment="Microsoft Windows Server 2003 SP1 (x64) is installed" definition_ref="oval:org.mitre.oval:def:4386" />
        <extend_definition comment="Microsoft Windows XP Professional x64 Edition SP1 is installed" definition_ref="oval:org.mitre.oval:def:720" />
        <extend_definition comment="Microsoft Windows Server 2003 SP1 (x86) is installed" definition_ref="oval:org.mitre.oval:def:565" />
        <extend_definition comment="Microsoft Windows Server 2003 SP1 for Itanium is installed" definition_ref="oval:org.mitre.oval:def:1205" />
      </criteria>
      <criterion comment="the version of schannel.dll is less than 5.2.3790.3293" test_ref="oval:org.mitre.oval:tst:9584" />
    </criteria>
    <criteria comment="Microsoft Windows XP x64/Windows server 2003 (x86/x64/ia64) SP2 is installed and schannel.dll file version" operator="AND">
      <criteria comment="Microsoft Windows XP x64/Windows server 2003 (x86/x64/ia64) SP2 is installed" operator="OR">
        <extend_definition comment="Microsoft Windows Server 2003 SP2 (x64) is installed" definition_ref="oval:org.mitre.oval:def:2161" />
        <extend_definition comment="Microsoft Windows XP x64 Edition SP2 is installed" definition_ref="oval:org.mitre.oval:def:4193" />
        <extend_definition comment="Microsoft Windows Server 2003 SP2 (x86) is installed" definition_ref="oval:org.mitre.oval:def:1935" />
        <extend_definition comment="Microsoft Windows Server 2003 (ia64) SP2 is installed" definition_ref="oval:org.mitre.oval:def:1442" />
      </criteria>
      <criterion comment="the version of schannel.dll is less than 5.2.3790.4458" test_ref="oval:org.mitre.oval:tst:9698" />
    </criteria>
    <criteria comment="Microsoft Windows Vista (x86/x64) is installed and schannel.dll file version" operator="AND">
      <criteria comment="Microsoft Windows Vista (x86/x64) is installed" operator="OR">
        <extend_definition comment="Microsoft Windows Vista (32-bit) is installed" definition_ref="oval:org.mitre.oval:def:1282" />
        <extend_definition comment="Microsoft Windows Vista x64 Edition is installed" definition_ref="oval:org.mitre.oval:def:2041" />
      </criteria>
      <criteria comment="File version less than 6.0.6000.16782 or greater than or equal to 6.0.6000.20000 and less than 6.0.6000.20967" operator="OR">
        <criterion comment="the version of schannel.dll is less than 6.0.6000.16782" test_ref="oval:org.mitre.oval:tst:8794" />
        <criteria comment="For LDR file version greater than or equal to 6.0.6000.20000 and less than 6.0.6000.20967" operator="AND">
          <criterion comment="the version of schannel.dll is greater than or equal 6.0.6000.20000" test_ref="oval:org.mitre.oval:tst:43987" />
          <criterion comment="the version of schannel.dll is less than 6.0.6000.20967" test_ref="oval:org.mitre.oval:tst:44127" />
        </criteria>
      </criteria>
    </criteria>
    <criteria comment="Microsoft Windows Vista (x86/x64) SP1 or Server 2008 (x86/x64/ia64) is installed and schannel.dll file version" operator="AND">
      <criteria comment="Microsoft Windows Vista (x86/x64) SP1 or Server 2008 (x86/x64/ia64) s installed" operator="OR">
        <extend_definition comment="Microsoft Windows Vista (32-bit) Service Pack 1 is installed" definition_ref="oval:org.mitre.oval:def:4873" />
        <extend_definition comment="Microsoft Windows Server 2008 (32-bit) is installed" definition_ref="oval:org.mitre.oval:def:4870" />
        <extend_definition comment="Microsoft Windows Vista x64 Edition Service Pack 1 is installed" definition_ref="oval:org.mitre.oval:def:5254" />
        <extend_definition comment="Microsoft Windows Server 2008 (64-bit) is installed" definition_ref="oval:org.mitre.oval:def:5356" />
        <extend_definition comment="Microsoft Windows Server 2008 (ia-64) is installed" definition_ref="oval:org.mitre.oval:def:5667" />
      </criteria>
      <criteria comment="File version less than 6.0.6001.18175 or greater than equal to 6.0.6001.22000 and less than 6.0.6001.22320" operator="OR">
        <criterion comment="the version of schannel.dll is less than 6.0.6001.18175" test_ref="oval:org.mitre.oval:tst:9306" />
        <criteria comment="For LDR file version greater than or equal to 6.0.6001.22000 and less than 6.0.6001.22320" operator="AND">
          <criterion comment="the version of schannel.dll is greater than or equal to 6.0.6001.22000" test_ref="oval:org.mitre.oval:tst:41291" />
          <criterion comment="the version of schannel.dll is less than 6.0.6001.22320" test_ref="oval:org.mitre.oval:tst:43861" />
        </criteria>
      </criteria>
    </criteria>
  </criteria>
</definition>
