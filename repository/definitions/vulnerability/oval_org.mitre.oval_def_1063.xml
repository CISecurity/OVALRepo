<?xml version="1.0" encoding="UTF-8"?>
<definition id="oval:org.mitre.oval:def:1063" version="6" class="vulnerability" xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:oval="http://oval.mitre.org/XMLSchema/oval-common-5" xmlns:oval-def="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <metadata>
    <title>WMF Rendering Code Execution Vulnerability (Windows 2000)</title>
    <affected family="windows">
      <platform>Microsoft Windows 2000</platform>
    </affected>
    <reference source="CVE" ref_id="CVE-2005-2123" ref_url="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-2123"/>
    <description>Multiple integer overflows in the Graphics Rendering Engine (GDI32.DLL) in Windows 2000 SP4, XP SP1 and SP2, and Server 2003 SP1 allow remote attackers to execute arbitrary code via crafted Windows Metafile (WMF) and Enhanced Metafile (EMF) format images that lead to heap-based buffer overflows, as demonstrated using MRBP16::bCheckRecord.</description>
    <oval_repository>
      <dates>
        <submitted date="2005-11-09T12:00:00.000-04:00">
          <contributor organization="ThreatGuard, Inc.">Robert L. Hollis</contributor>
        </submitted>
        <status_change date="2005-11-10T07:06:00.000-04:00">DRAFT</status_change>
        <status_change date="2005-12-01T06:00:00.000-04:00">INTERIM</status_change>
        <status_change date="2005-12-16T01:04:00.000-04:00">ACCEPTED</status_change>
        <modified comment="Fixed regex in ste:2889.  Implemented by Matthew Wojcik." date="2007-03-06T18:19:00.507-05:00">
          <contributor organization="BigFix, Inc">Anna Min</contributor>
        </modified>
        <status_change date="2007-03-06T18:21:14.349-05:00">INTERIM</status_change>
        <status_change date="2007-03-21T16:16:39.889-04:00">ACCEPTED</status_change>
        <modified comment="EDITED oval:org.mitre.oval:def:1063 - Various corrections to comments and products to align with Authoring Style Guide" date="2011-04-22T23:54:00.899-04:00">
          <contributor organization="G2, Inc.">Shane Shaffer</contributor>
        </modified>
        <status_change date="2011-04-23T00:06:47.901-04:00">INTERIM</status_change>
        <modified comment="EDITED oval:org.mitre.oval:obj:717 - Added an additional test for Windows Server 2003 platforms to test for the existence of the NT Directory Services" date="2011-04-25T14:34:00.432-04:00">
          <contributor organization="Telos">Sudhir Gandhe</contributor>
        </modified>
        <modified comment="EDITED oval:org.mitre.oval:obj:717 - Reverted mistaken switch of obj:717 (Service Pack) and obj:15869 (NT Directory Services)" date="2011-04-26T11:53:00.464-04:00">
          <contributor organization="G2, Inc.">Shane Shaffer</contributor>
        </modified>
        <status_change date="2011-05-16T04:00:15.176-04:00">ACCEPTED</status_change>
      </dates>
      <status>ACCEPTED</status>
      <min_schema_version>5.3</min_schema_version>
    </oval_repository>
  </metadata>
  <criteria operator="AND">
    <criteria operator="AND" comment="Windows 2000 Service Pack 4 (or later) is installed">
      <criterion comment="Windows 2000 is installed" test_ref="oval:org.mitre.oval:tst:3085"/>
      <criterion comment="Win2K/XP/2003 service pack 4 (or later) is installed" test_ref="oval:org.mitre.oval:tst:3084"/>
    </criteria>
    <criteria operator="OR" comment="version of Gdi32.dll is less than 5.0.2195.7069 OR the version of Mf3216.dll is less than 5.0.2195.6898">
      <criterion comment="the version of Gdi32.dll is less than 5.0.2195.7069" test_ref="oval:org.mitre.oval:tst:1227"/>
      <criterion comment="the version of mf3216.dll is less than 5.0.2195.6898" test_ref="oval:org.mitre.oval:tst:1398"/>
    </criteria>
  </criteria>
</definition>