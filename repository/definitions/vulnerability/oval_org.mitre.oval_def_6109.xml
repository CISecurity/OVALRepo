<?xml version="1.0" encoding="UTF-8"?>
<definition id="oval:org.mitre.oval:def:6109" version="3" class="vulnerability">
  <metadata>
    <title>MSMQ Null Pointer Vulnerability</title>
    <affected family="windows">
      <platform>Microsoft Windows 2000</platform>
      <platform>Microsoft Windows XP</platform>
      <platform>Microsoft Windows Vista</platform>
      <platform>Microsoft Windows Server 2003</platform>
    </affected>
    <reference source="CVE" ref_id="CVE-2009-1922" ref_url="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-1922"/>
    <description>The Message Queuing (aka MSMQ) service for Microsoft Windows 2000 SP4, XP SP2, Server 2003 SP2, and Vista Gold does not properly validate unspecified IOCTL request data from user mode before passing this data to kernel mode, which allows local users to gain privileges via a crafted request, aka "MSMQ Null Pointer Vulnerability."</description>
    <oval_repository>
      <dates>
        <submitted date="2009-07-28T13:00:00">
          <contributor organization="Gideon Technologies, Inc.">Dragos Prisaca</contributor>
        </submitted>
        <status_change date="2009-08-19T14:57:57.944-04:00">DRAFT</status_change>
        <status_change date="2009-09-07T04:00:10.512-04:00">INTERIM</status_change>
        <status_change date="2009-09-28T04:00:14.284-04:00">ACCEPTED</status_change>
        <modified comment="EDITED oval:org.mitre.oval:tst:10069 - contains tests with modified comments and all dependences" date="2014-02-13T12:19:00.287-05:00">
          <contributor organization="ALTX-SOFT">Maria Mikhno</contributor>
        </modified>
        <status_change date="2014-02-13T12:22:33.416-05:00">INTERIM</status_change>
        <status_change date="2014-03-03T04:01:13.393-05:00">ACCEPTED</status_change>
      </dates>
      <status>ACCEPTED</status>
    </oval_repository>
  </metadata>
  <criteria operator="OR">
    <criteria operator="AND" comment="Vulnerable Microsoft Windows 2000 SP4 or later">
      <extend_definition comment="Microsoft Windows 2000 SP4 or later is installed" definition_ref="oval:org.mitre.oval:def:229"/>
      <criterion comment="mqrt.dll version is less than 5.0.0.808" test_ref="oval:org.mitre.oval:tst:10493"/>
    </criteria>
    <criteria operator="AND" comment="Vulnerable Microsoft Windows XP (x86) SP2">
      <extend_definition comment="Microsoft Windows XP (x86) SP2 is installed" definition_ref="oval:org.mitre.oval:def:754"/>
      <criterion comment="mqrt.dll version is less than 5.1.0.1111" test_ref="oval:org.mitre.oval:tst:10353"/>
    </criteria>
    <criteria operator="AND" comment="Vulnerable Microsoft Windows XP x64 Edition SP2">
      <extend_definition comment="Microsoft Windows XP x64 Edition SP2 is installed" definition_ref="oval:org.mitre.oval:def:4193"/>
      <criterion comment="mqrt.dll version is less than 5.2.2007.4530" test_ref="oval:org.mitre.oval:tst:10542"/>
    </criteria>
    <criteria operator="AND" comment="Vulnerable Microsoft Windows Server 2003 SP2 (x86)">
      <extend_definition comment="Microsoft Windows Server 2003 SP2 (x86) is installed" definition_ref="oval:org.mitre.oval:def:1935"/>
      <criterion comment="mqrt.dll version is less than 5.2.2007.4530" test_ref="oval:org.mitre.oval:tst:10542"/>
    </criteria>
    <criteria operator="AND" comment="Vulnerable Microsoft Windows Server 2003 SP2 (x64)">
      <extend_definition comment="Microsoft Windows Server 2003 SP2 (x64) is installed" definition_ref="oval:org.mitre.oval:def:2161"/>
      <criterion comment="mqrt.dll version is less than 5.2.2007.4530" test_ref="oval:org.mitre.oval:tst:10542"/>
    </criteria>
    <criteria operator="AND" comment="Vulnerable Microsoft Windows Server 2003 SP2 (ia64)">
      <extend_definition comment="Microsoft Windows Server 2003 (ia64) SP2 is installed" definition_ref="oval:org.mitre.oval:def:1442"/>
      <criterion comment="mqrt.dll version is less than 5.2.2007.4530" test_ref="oval:org.mitre.oval:tst:10542"/>
    </criteria>
    <criteria operator="AND" comment="Vulnerable Microsoft Windows Vista (32-bit)">
      <extend_definition comment="Microsoft Windows Vista (32-bit) is installed" definition_ref="oval:org.mitre.oval:def:1282"/>
      <criteria operator="OR" comment="GDR/LDR">
        <criteria operator="AND" comment="GDR">
          <criterion comment="mqrt.dll version is less than 6.0.6000.16871" test_ref="oval:org.mitre.oval:tst:10187"/>
          <criterion comment="mqrt.dll version is greater than or equal 6.0.6000.16000" test_ref="oval:org.mitre.oval:tst:10433"/>
        </criteria>
        <criteria operator="AND" comment="LDR">
          <criterion comment="mqrt.dll version is less than 6.0.6000.21068" test_ref="oval:org.mitre.oval:tst:10526"/>
          <criterion comment="mqrt.dll version is greater than or equal 6.0.6000.20000" test_ref="oval:org.mitre.oval:tst:10069"/>
        </criteria>
      </criteria>
    </criteria>
    <criteria operator="AND" comment="Vulnerable Microsoft Windows Vista x64">
      <extend_definition comment="Microsoft Windows Vista x64 Edition is installed" definition_ref="oval:org.mitre.oval:def:2041"/>
      <criteria operator="OR" comment="GDR/LDR">
        <criteria operator="AND" comment="GDR">
          <criterion comment="mqrt.dll version is less than 6.0.6000.16871" test_ref="oval:org.mitre.oval:tst:10187"/>
          <criterion comment="mqrt.dll version is greater than or equal 6.0.6000.16000" test_ref="oval:org.mitre.oval:tst:10433"/>
        </criteria>
        <criteria operator="AND" comment="LDR">
          <criterion comment="mqrt.dll version is less than 6.0.6000.21068" test_ref="oval:org.mitre.oval:tst:10526"/>
          <criterion comment="mqrt.dll version is greater than or equal 6.0.6000.20000" test_ref="oval:org.mitre.oval:tst:10069"/>
        </criteria>
      </criteria>
    </criteria>
  </criteria>
</definition>