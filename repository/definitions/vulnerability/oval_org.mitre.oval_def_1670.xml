<?xml version="1.0" encoding="UTF-8"?>
<definition id="oval:org.mitre.oval:def:1670" version="4" class="vulnerability" xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:oval="http://oval.mitre.org/XMLSchema/oval-common-5" xmlns:oval-def="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <metadata>
    <title>CAPICOM.Certificates Vulnerability</title>
    <affected family="windows">
      <platform>Microsoft Windows 2000</platform>
      <platform>Microsoft Windows XP</platform>
      <platform>Microsoft Windows Server 2003</platform>
      <platform>Microsoft Windows Vista</platform>
      <product>Microsoft BizTalk Server 2004</product>
      <product>Platform SDK Redistributable: CAPICOM</product>
      <product>CAPICOM</product>
    </affected>
    <reference source="CVE" ref_id="CVE-2007-0940" ref_url="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-0940"/>
    <description>Unspecified vulnerability in the Cryptographic API Component Object Model Certificates ActiveX control (CAPICOM.dll) in Microsoft CAPICOM and BizTalk Server 2004 SP1 and SP2 allows remote attackers to execute arbitrary code via unspecified vectors, aka the "CAPICOM.Certificates Vulnerability."</description>
    <oval_repository>
      <dates>
        <submitted date="2007-05-08T19:30:00">
          <contributor organization="Secure Elements, Inc.">Sudhir Gandhe</contributor>
        </submitted>
        <status_change date="2007-05-09T12:53:06-04:00">DRAFT</status_change>
        <modified comment="Removed unneeded criteria. This definition still needs to be updated to check for the vulnerable capicom.dll in locations other than the system root." date="2007-05-23T13:58:00.503-04:00">
          <contributor organization="The MITRE Corporation">Jonathan Baker</contributor>
        </modified>
        <modified comment="added unknown_test as a place holder until oval can support the test that is needed to check that the currently registered version of capicom.dll is not vulnerable." date="2007-06-01T10:17:00.628-04:00">
          <contributor organization="The MITRE Corporation">Jonathan Baker</contributor>
        </modified>
        <status_change date="2007-06-20T07:39:21.924-04:00">INTERIM</status_change>
        <status_change date="2007-07-10T21:08:49.262-04:00">ACCEPTED</status_change>
        <modified comment="References registry entries that will remove false positives in tests." date="2008-03-26T13:25:00.871-04:00">
          <contributor organization="GFI Software">Clifford Farrugia</contributor>
        </modified>
        <status_change date="2008-03-26T13:27:19.903-04:00">INTERIM</status_change>
        <modified comment="Changed criteria operator from OR to AND" date="2008-03-27T08:39:00.510-04:00">
          <contributor organization="GFI Software">Clifford Farrugia</contributor>
        </modified>
        <modified comment="Changed wording for criterion comment and added a negate flag." date="2008-04-03T08:55:00.399-04:00">
          <contributor organization="GFI Software">Clifford Farrugia</contributor>
        </modified>
        <status_change date="2008-04-21T04:00:13.519-04:00">ACCEPTED</status_change>
        <modified comment="Added platforms based on MS Bulletin information." date="2008-06-27T09:26:00.595-04:00">
          <contributor organization="Hewlett-Packard">Todd Dolinsky</contributor>
        </modified>
        <status_change date="2008-06-27T09:44:19.609-04:00">INTERIM</status_change>
        <status_change date="2008-07-14T04:00:18.128-04:00">ACCEPTED</status_change>
        <modified comment="Changed registry key check to include beginning anchor to optimize search by limiting the scope of the search." date="2010-01-22T11:54:00.769-05:00">
          <contributor organization="The MITRE Corporation">Jonathan Baker</contributor>
        </modified>
        <status_change date="2010-01-22T11:57:05.984-05:00">INTERIM</status_change>
        <status_change date="2010-02-08T04:00:02.203-05:00">ACCEPTED</status_change>
      </dates>
      <status>ACCEPTED</status>
      <min_schema_version>5.4</min_schema_version>
    </oval_repository>
  </metadata>
  <criteria comment="A vulnerable version of capcom.dll exists" operator="AND">
    <criterion comment="the installed operating system is part of the Microsoft Windows family" test_ref="oval:org.mitre.oval:tst:99"/>
    <criteria operator="AND">
      <criterion comment="capicom is installed" test_ref="oval:org.mitre.oval:tst:7951"/>
      <criterion negate="true" comment="the version of capicom is 2.1.0.2 or greater" test_ref="oval:org.mitre.oval:tst:7495"/>
    </criteria>
  </criteria>
</definition>