<definition xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5" class="vulnerability" id="oval:org.mitre.oval:def:16343" version="52">
  <metadata>
    <title>WinForms Buffer Overflow Vulnerability - MS13-004</title>
    <affected family="windows">
      <platform>Microsoft Windows 7</platform>
      <platform>Microsoft Windows Server 2003</platform>
      <platform>Microsoft Windows Server 2008</platform>
      <platform>Microsoft Windows Server 2008 R2</platform>
      <platform>Microsoft Windows Vista</platform>
      <platform>Microsoft Windows XP</platform>
      <platform>Microsoft Windows 8</platform>
      <platform>Microsoft Windows Server 2012</platform>
      <product>Microsoft .NET Framework 1.1</product>
      <product>Microsoft .NET Framework 2.0</product>
      <product>Microsoft .NET Framework 3.0</product>
      <product>Microsoft .NET Framework 3.5</product>
      <product>Microsoft .NET Framework 3.5.1</product>
      <product>Microsoft .NET Framework 4.0</product>
      <product>Microsoft .NET Framework 4.5</product>
    </affected>
    <reference ref_id="CVE-2013-0002" ref_url="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-0002" source="CVE" />
    <description>Buffer overflow in the Windows Forms (aka WinForms) component in Microsoft .NET Framework 1.0 SP3, 1.1 SP1, 2.0 SP2, 3.0 SP2, 3.5, 3.5.1, 4, and 4.5 allows remote attackers to execute arbitrary code via (1) a crafted XAML browser application (XBAP) or (2) a crafted .NET Framework application that leverages improper counting of objects during a memory copy operation, aka "WinForms Buffer Overflow Vulnerability."</description>
    <oval_repository>
      <dates>
        <submitted date="2013-01-10T14:44:02">
          <contributor organization="SecPod Technologies">SecPod Team</contributor>
        </submitted>
        <status_change date="2013-01-15T14:30:33.005-05:00">DRAFT</status_change>
        <status_change date="2013-02-04T04:01:07.861-05:00">INTERIM</status_change>
        <status_change date="2013-02-25T04:00:18.792-05:00">ACCEPTED</status_change>
        <modified comment="EDITED oval:org.mitre.oval:ste:19529 - Fix operation on state" date="2013-04-23T12:21:00.849-04:00">
          <contributor organization="G2, Inc.">Dragos Prisaca</contributor>
        </modified>
        <status_change date="2013-04-23T12:23:12.787-04:00">INTERIM</status_change>
        <status_change date="2013-05-13T04:00:22.774-04:00">ACCEPTED</status_change>
        <modified comment="EDITED oval:org.mitre.oval:def:16343 - .NET Framework 3.5.1 instead .NET Framework 3.5 in Windows 8 and Windows Server 2012" date="2014-03-31T14:51:00.481-04:00">
          <contributor organization="ALTX-SOFT">Maria Mikhno</contributor>
        </modified>
        <status_change date="2014-03-31T14:53:49.228-04:00">INTERIM</status_change>
        <status_change date="2014-04-21T04:00:13.600-04:00">ACCEPTED</status_change>
        <modified comment="EDITED oval:org.mitre.oval:obj:309 - Modified criteria to match MS bulletin" date="2014-06-13T14:52:00.642-04:00">
          <contributor organization="ALTX-SOFT">Maria Mikhno</contributor>
        </modified>
        <status_change date="2014-06-13T14:56:24.428-04:00">INTERIM</status_change>
        <status_change date="2014-06-30T04:05:58.867-04:00">ACCEPTED</status_change>
        <modified comment="EDITED oval:org.mitre.oval:def:16343 - extended definitions of OS are without SP checks" date="2014-07-28T17:54:00.740-04:00">
          <contributor organization="ALTX-SOFT">Maria Mikhno</contributor>
        </modified>
        <status_change date="2014-07-28T17:55:55.946-04:00">INTERIM</status_change>
        <status_change date="2014-08-18T04:01:34.336-04:00">ACCEPTED</status_change>
      </dates>
      <status>ACCEPTED</status>
      <min_schema_version>5.10</min_schema_version>
    </oval_repository>
  </metadata>
  <criteria operator="OR">
    <criteria comment="Check for xp/server 2003/versions" operator="AND">
      <criteria comment="xp/server 2003 32/64/ia64" operator="OR">
        <extend_definition comment="Microsoft Windows XP (32-bit) is installed" definition_ref="oval:org.mitre.oval:def:1353" />
        <extend_definition comment="Microsoft Windows XP x64 is installed" definition_ref="oval:org.mitre.oval:def:15247" />
        <extend_definition comment="Microsoft Windows Server 2003 (32-bit) is installed" definition_ref="oval:org.mitre.oval:def:1870" />
        <extend_definition comment="Microsoft Windows Server 2003 (x64) is installed" definition_ref="oval:org.mitre.oval:def:730" />
        <extend_definition comment="Microsoft Windows Server 2003 (ia64) Gold is installed" definition_ref="oval:org.mitre.oval:def:396" />
      </criteria>
      <criteria comment=".net versions" operator="OR">
        <criteria comment="1.1 sp1" operator="AND">
          <criterion comment="Check if the version of System.drawing.dll is less than 1.1.4322.2502" test_ref="oval:org.mitre.oval:tst:80728" />
          <extend_definition comment="Microsoft .NET Framework 1.1 Service Pack 1 is Installed" definition_ref="oval:org.mitre.oval:def:1834" />
        </criteria>
        <criteria comment="2.0 sp2" operator="AND">
          <criteria comment="GDR/LDR" operator="OR">
            <criterion comment="Check if the version of System.drawing.dll is less than 2.0.50727.3644" test_ref="oval:org.mitre.oval:tst:80333" />
            <criteria comment="LDR range" operator="AND">
              <criterion comment="Check if the version of System.drawing.dll is less than 2.0.50727.5740" test_ref="oval:org.mitre.oval:tst:80419" />
              <criterion comment="Check if the version of System.drawing.dll is greater than or equal to 2.0.50727.5000  (.net framework 2.0)" test_ref="oval:org.mitre.oval:tst:80671" />
            </criteria>
          </criteria>
          <extend_definition comment="Microsoft .NET Framework 2.0 Service Pack 2 is installed" definition_ref="oval:org.mitre.oval:def:6158" />
        </criteria>
        <criteria comment="4.0" operator="AND">
          <criteria comment="GDR/LDR" operator="OR">
            <criterion comment="Check if the version of System.drawing.dll is less than 4.0.30319.1001" test_ref="oval:org.mitre.oval:tst:80738" />
            <criteria comment="LDR range" operator="AND">
              <criterion comment="Check if the version of System.drawing.dll is greater than or equal to 4.0.30319.2000" test_ref="oval:org.mitre.oval:tst:80174" />
              <criterion comment="Check if the version of System.drawing.dll is less than 4.0.30319.2001" test_ref="oval:org.mitre.oval:tst:80406" />
            </criteria>
          </criteria>
          <extend_definition comment="Microsoft .NET Framework 4.0 is installed" definition_ref="oval:org.mitre.oval:def:6749" />
        </criteria>
      </criteria>
    </criteria>
    <criteria comment="vista sp2/win 2008 and versions" operator="AND">
      <criteria comment="vista 32/64/win 2008" operator="OR">
        <extend_definition comment="Microsoft Windows Vista (32-bit) is installed" definition_ref="oval:org.mitre.oval:def:1282" />
        <extend_definition comment="Microsoft Windows Vista x64 Edition is installed" definition_ref="oval:org.mitre.oval:def:2041" />
        <extend_definition comment="Microsoft Windows Server 2008 (32-bit) is installed" definition_ref="oval:org.mitre.oval:def:4870" />
        <extend_definition comment="Microsoft Windows Server 2008 (64-bit) is installed" definition_ref="oval:org.mitre.oval:def:5356" />
        <extend_definition comment="Microsoft Windows Server 2008 (ia-64) is installed" definition_ref="oval:org.mitre.oval:def:5667" />
      </criteria>
      <criteria comment=".net versions" operator="OR">
        <criteria comment="1.1 sp1" operator="AND">
          <criterion comment="Check if the version of System.drawing.dll is less than 1.1.4322.2502" test_ref="oval:org.mitre.oval:tst:80728" />
          <extend_definition comment="Microsoft .NET Framework 1.1 Service Pack 1 is Installed" definition_ref="oval:org.mitre.oval:def:1834" />
        </criteria>
        <criteria comment="2.0 sp2" operator="AND">
          <criteria comment="GDR/LDR" operator="OR">
            <criterion comment="Check if the version of System.drawing.dll is less than 2.0.50727.4235" test_ref="oval:org.mitre.oval:tst:80670" />
            <criteria comment="LDR range" operator="AND">
              <criterion comment="Check if the version of System.drawing.dll is greater than or equal to 2.0.50727.5000  (.net framework 2.0)" test_ref="oval:org.mitre.oval:tst:80671" />
              <criterion comment="Check if the version of System.drawing.dll is less than 2.0.50727.5740" test_ref="oval:org.mitre.oval:tst:80419" />
            </criteria>
          </criteria>
          <extend_definition comment="Microsoft .NET Framework 2.0 Service Pack 2 is installed" definition_ref="oval:org.mitre.oval:def:6158" />
        </criteria>
        <criteria comment="Check for .Net 3.0" operator="AND">
          <criteria comment="GDR/LDR" operator="OR">
            <criterion comment="Check if the version of System.ServiceModel.dll is less than 3.0.4506.4214" test_ref="oval:org.mitre.oval:tst:80729" />
            <criteria comment="LDR range" operator="AND">
              <criterion comment="Check if version of System.ServiceModel.dll is greater than or equal to 3.0.4506.5500" test_ref="oval:org.mitre.oval:tst:80733" />
              <criterion comment="Check if version of System.ServiceModel.dll is less than 3.0.4506.5847" test_ref="oval:org.mitre.oval:tst:80465" />
            </criteria>
          </criteria>
          <extend_definition comment="Microsoft .NET Framework 3.0 SP2 is installed" definition_ref="oval:org.mitre.oval:def:15312" />
        </criteria>
        <criteria comment="4.0" operator="AND">
          <criteria comment="GDR/LDR" operator="OR">
            <criterion comment="Check if the version of System.drawing.dll is less than 4.0.30319.1001" test_ref="oval:org.mitre.oval:tst:80738" />
            <criteria comment="LDR range" operator="AND">
              <criterion comment="Check if the version of System.drawing.dll is greater than or equal to 4.0.30319.2000" test_ref="oval:org.mitre.oval:tst:80174" />
              <criterion comment="Check if the version of System.drawing.dll is less than 4.0.30319.2001" test_ref="oval:org.mitre.oval:tst:80406" />
            </criteria>
          </criteria>
          <extend_definition comment="Microsoft .NET Framework 4.0 is installed" definition_ref="oval:org.mitre.oval:def:6749" />
        </criteria>
        <criteria comment="4.5" operator="AND">
          <criteria comment="GDR/LDR" operator="OR">
            <criterion comment="Check if the version of System.drawing.dll is less than 4.0.30319.18021" test_ref="oval:org.mitre.oval:tst:80254" />
            <criteria comment="LDR range" operator="AND">
              <criterion comment="Check if the version of System.drawing.dll is greater than or equal to 4.0.30319.19000" test_ref="oval:org.mitre.oval:tst:80491" />
              <criterion comment="Check if the version of System.drawing.dll is less than 4.0.30319.19029" test_ref="oval:org.mitre.oval:tst:80563" />
            </criteria>
          </criteria>
          <extend_definition comment="Microsoft .NET Framework 4.5 is installed" definition_ref="oval:org.mitre.oval:def:15925" />
        </criteria>
      </criteria>
    </criteria>
    <criteria comment="2008 r2/win 7/versions" operator="AND">
      <criteria comment="2008 r2/win 7 32/64" operator="OR">
        <extend_definition comment="Microsoft Windows 7 is installed" definition_ref="oval:org.mitre.oval:def:12541" />
        <extend_definition comment="Microsoft Windows Server 2008 R2 is installed" definition_ref="oval:org.mitre.oval:def:12754" />
      </criteria>
      <criteria comment=".net versions" operator="OR">
        <criteria comment="3.5.1" operator="AND">
          <criteria comment="either file/versions" operator="OR">
            <criterion comment="Check if the version of System.drawing.dll is less than 2.0.50727.4985" test_ref="oval:org.mitre.oval:tst:79814" />
            <criteria comment="LDR range" operator="AND">
              <criterion comment="Check if the version of System.drawing.dll is greater than or equal to 2.0.50727.5500" test_ref="oval:org.mitre.oval:tst:80668" />
              <criterion comment="Check if the version of System.drawing.dll is less than 2.0.50727.5740" test_ref="oval:org.mitre.oval:tst:80419" />
            </criteria>
            <criterion comment="Check if the version of System.ServiceModel.dll is less than 3.0.4506.5007" test_ref="oval:org.mitre.oval:tst:80692" />
            <criteria comment="LDR range" operator="AND">
              <criterion comment="Check if version of System.ServiceModel.dll is greater than or equal to 3.0.4506.5500" test_ref="oval:org.mitre.oval:tst:80733" />
              <criterion comment="Check if version of System.ServiceModel.dll is less than 3.0.4506.5846" test_ref="oval:org.mitre.oval:tst:80649" />
            </criteria>
          </criteria>
          <extend_definition comment="Microsoft .NET Framework 3.5 SP1 is installed" definition_ref="oval:org.mitre.oval:def:12542" />
        </criteria>
        <criteria comment="4.0" operator="AND">
          <criteria comment="GDR/LDR" operator="OR">
            <criterion comment="Check if the version of System.drawing.dll is less than 4.0.30319.1001" test_ref="oval:org.mitre.oval:tst:80738" />
            <criteria comment="LDR range" operator="AND">
              <criterion comment="Check if the version of System.drawing.dll is greater than or equal to 4.0.30319.2000" test_ref="oval:org.mitre.oval:tst:80174" />
              <criterion comment="Check if the version of System.drawing.dll is less than 4.0.30319.2001" test_ref="oval:org.mitre.oval:tst:80406" />
            </criteria>
          </criteria>
          <extend_definition comment="Microsoft .NET Framework 4.0 is installed" definition_ref="oval:org.mitre.oval:def:6749" />
        </criteria>
      </criteria>
    </criteria>
    <criteria comment="win 7/server 2008 R2/versions" operator="AND">
      <criteria comment="win 7/server 2008 R2" operator="OR">
        <extend_definition comment="Microsoft Windows 7 (32-bit) is installed" definition_ref="oval:org.mitre.oval:def:6165" />
        <extend_definition comment="Microsoft Windows 7 x64 Edition is installed" definition_ref="oval:org.mitre.oval:def:5950" />
        <extend_definition comment="Microsoft Windows Server 2008 R2 x64 Edition is installed" definition_ref="oval:org.mitre.oval:def:6438" />
        <extend_definition comment="Microsoft Windows Server 2008 R2 Itanium-Based Edition is installed" definition_ref="oval:org.mitre.oval:def:5954" />
      </criteria>
      <criteria comment="either file/versions" operator="OR">
        <criteria comment="3.5.1" operator="AND">
          <criteria comment="GDR/LDR - KB2756920" operator="OR">
            <criterion comment="Check if the version of System.drawing.dll is less than 2.0.50727.5467" test_ref="oval:org.mitre.oval:tst:80640" />
            <criteria comment="LDR range" operator="AND">
              <criterion comment="Check if the version of System.drawing.dll is greater than or equal to 2.0.50727.5500" test_ref="oval:org.mitre.oval:tst:80668" />
              <criterion comment="Check if the version of System.drawing.dll is less than 2.0.50727.5740" test_ref="oval:org.mitre.oval:tst:80419" />
            </criteria>
          </criteria>
          <criteria comment="GDR/LDR - KB2756921" operator="OR">
            <criterion comment="Check if the version of System.ServiceModel.dll is less than 3.0.4506.5452" test_ref="oval:org.mitre.oval:tst:80337" />
            <criteria comment="LDR range" operator="AND">
              <criterion comment="Check if version of System.ServiceModel.dll is greater than or equal to 3.0.4506.5500" test_ref="oval:org.mitre.oval:tst:80733" />
              <criterion comment="Check if version of System.ServiceModel.dll is less than 3.0.4506.5846" test_ref="oval:org.mitre.oval:tst:80649" />
            </criteria>
          </criteria>
          <extend_definition comment="Microsoft .NET Framework 3.5 SP1 is installed" definition_ref="oval:org.mitre.oval:def:12542" />
        </criteria>
        <criteria comment="4.0" operator="AND">
          <criteria comment="GDR/LDR" operator="OR">
            <criterion comment="Check if the version of System.drawing.dll is less than 4.0.30319.1001" test_ref="oval:org.mitre.oval:tst:80738" />
            <criteria comment="LDR range" operator="AND">
              <criterion comment="Check if the version of System.drawing.dll is greater than or equal to 4.0.30319.2000" test_ref="oval:org.mitre.oval:tst:80174" />
              <criterion comment="Check if the version of System.drawing.dll is less than 4.0.30319.2001" test_ref="oval:org.mitre.oval:tst:80406" />
            </criteria>
          </criteria>
          <extend_definition comment="Microsoft .NET Framework 4.0 is installed" definition_ref="oval:org.mitre.oval:def:6749" />
        </criteria>
        <criteria comment="4.5" operator="AND">
          <criteria comment="GDR/LDR" operator="OR">
            <criterion comment="Check if the version of System.drawing.dll is less than 4.0.30319.18021" test_ref="oval:org.mitre.oval:tst:80254" />
            <criteria comment="LDR range" operator="AND">
              <criterion comment="Check if the version of System.drawing.dll is greater than or equal to 4.0.30319.19000" test_ref="oval:org.mitre.oval:tst:80491" />
              <criterion comment="Check if the version of System.drawing.dll is less than 4.0.30319.19029" test_ref="oval:org.mitre.oval:tst:80563" />
            </criteria>
          </criteria>
          <extend_definition comment="Microsoft .NET Framework 4.5 is installed" definition_ref="oval:org.mitre.oval:def:15925" />
        </criteria>
      </criteria>
    </criteria>
    <criteria comment="Check for vulnerable XP/2003" operator="AND">
      <criteria comment="Win XP/2003" operator="OR">
        <extend_definition comment="Microsoft Windows XP (32-bit) is installed" definition_ref="oval:org.mitre.oval:def:1353" />
        <extend_definition comment="Microsoft Windows XP x64 is installed" definition_ref="oval:org.mitre.oval:def:15247" />
        <extend_definition comment="Microsoft Windows Server 2003 (32-bit) is installed" definition_ref="oval:org.mitre.oval:def:1870" />
        <extend_definition comment="Microsoft Windows Server 2003 (x64) is installed" definition_ref="oval:org.mitre.oval:def:730" />
      </criteria>
      <criteria comment="GDR/LDR" operator="OR">
        <criterion comment="Check if the version of System.ServiceModel.dll is less than 3.0.4506.4037" test_ref="oval:org.mitre.oval:tst:80407" />
        <criteria comment="LDR range" operator="AND">
          <criterion comment="Check if version of System.ServiceModel.dll is greater than or equal to 3.0.4506.5000" test_ref="oval:org.mitre.oval:tst:80626" />
          <criterion comment="Check if version of System.ServiceModel.dll is less than 3.0.4506.5845" test_ref="oval:org.mitre.oval:tst:80335" />
        </criteria>
      </criteria>
      <extend_definition comment="Microsoft .NET Framework 3.0 SP2 is installed" definition_ref="oval:org.mitre.oval:def:15312" />
    </criteria>
    <criteria comment="Check for vulnerable Win 8/2012" operator="AND">
      <criteria comment="Win 8/2012" operator="OR">
        <extend_definition comment="Microsoft Windows 8 is installed" definition_ref="oval:org.mitre.oval:def:15732" />
        <extend_definition comment="Microsoft Windows Server 2012 is installed" definition_ref="oval:org.mitre.oval:def:16359" />
      </criteria>
      <criteria comment="Check for vulnerable .Net 3.5/files" operator="OR">
        <criteria comment="Check for vulnerable .Net 3.5" operator="AND">
          <criteria comment="Either file/versions" operator="OR">
            <criterion comment="Check if the version of System.drawing.dll is less than 2.0.50727.6401" test_ref="oval:org.mitre.oval:tst:80645" />
            <criteria comment="LDR range" operator="AND">
              <criterion comment="Check if the version of System.drawing.dll is greater than or equal to 2.0.50727.7000" test_ref="oval:org.mitre.oval:tst:80758" />
              <criterion comment="Check if the version of System.drawing.dll is less than 2.0.50727.7005" test_ref="oval:org.mitre.oval:tst:80618" />
            </criteria>
            <criterion comment="Check if the version of System.ServiceModel.dll is less than 3.0.4506.6401" test_ref="oval:org.mitre.oval:tst:80636" />
            <criteria comment="LDR range" operator="AND">
              <criterion comment="Check if version of System.ServiceModel.dll is greater than or equal to 3.0.4506.7000" test_ref="oval:org.mitre.oval:tst:80699" />
              <criterion comment="Check if version of System.ServiceModel.dll is less than 3.0.4506.7005" test_ref="oval:org.mitre.oval:tst:80769" />
            </criteria>
          </criteria>
          <extend_definition comment="Microsoft .NET Framework 3.5 SP1 is installed" definition_ref="oval:org.mitre.oval:def:12542" />
        </criteria>
        <criteria comment="Check for vulnerable .Net 4.5" operator="AND">
          <criteria comment="GDR/LDR" operator="OR">
            <criterion comment="Check if the version of System.drawing.dll is less than 4.0.30319.18022" test_ref="oval:org.mitre.oval:tst:80537" />
            <criteria comment="LDR range" operator="AND">
              <criterion comment="Check if the version of System.drawing.dll is greater than or equal to 4.0.30319.19000" test_ref="oval:org.mitre.oval:tst:80491" />
              <criterion comment="Check if the version of System.drawing.dll is less than 4.0.30319.19030" test_ref="oval:org.mitre.oval:tst:80624" />
            </criteria>
          </criteria>
          <extend_definition comment="Microsoft .NET Framework 4.5 is installed" definition_ref="oval:org.mitre.oval:def:15925" />
        </criteria>
      </criteria>
    </criteria>
  </criteria>
</definition>
