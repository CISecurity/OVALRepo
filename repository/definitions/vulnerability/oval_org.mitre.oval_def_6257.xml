<?xml version="1.0" encoding="UTF-8"?>
<definition id="oval:org.mitre.oval:def:6257" version="8" class="vulnerability" xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:oval="http://oval.mitre.org/XMLSchema/oval-common-5" xmlns:oval-def="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <metadata>
    <title>Windows Media Header Parsing Invalid Free Vulnerability</title>
    <affected family="windows">
      <platform>Microsoft Windows 2000</platform>
      <platform>Microsoft Windows XP</platform>
      <platform>Microsoft Windows Server 2003</platform>
      <platform>Microsoft Windows Vista</platform>
      <platform>Microsoft Windows Server 2008</platform>
      <product>Windows Media Format Runtime 9.0</product>
      <product>Windows Media Format Runtime 9.5</product>
      <product>Windows Media Format Runtime 11</product>
      <product>Windows Media Services 9.1</product>
      <product>Windows Media Services 2008</product>
    </affected>
    <reference source="CVE" ref_id="CVE-2009-2498" ref_url="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-2498"/>
    <description>Microsoft Windows Media Format Runtime 9.0, 9.5, and 11 and Windows Media Services 9.1 and 2008 do not properly parse malformed headers in Advanced Systems Format (ASF) files, which allows remote attackers to execute arbitrary code via a crafted (1) .asf, (2) .wmv, or (3) .wma file, aka "Windows Media Header Parsing Invalid Free Vulnerability."</description>
    <oval_repository>
      <dates>
        <submitted date="2009-09-08T13:00:00">
          <contributor organization="Gideon Technologies, Inc.">Dragos Prisaca</contributor>
        </submitted>
        <status_change date="2009-09-12T20:28:11.654-04:00">DRAFT</status_change>
        <status_change date="2009-09-28T04:00:18.458-04:00">INTERIM</status_change>
        <modified comment="Updated oval:org.mitre.oval:obj:7139 to refer to oval:org.mitre.oval:var:202 rather than the deprecated oval:org.mitre.oval:var:207" date="2009-09-30T20:14:00.930-04:00">
          <contributor organization="Gideon Technologies, Inc.">Dragos Prisaca</contributor>
        </modified>
        <status_change date="2009-10-19T04:00:12.210-04:00">ACCEPTED</status_change>
        <modified comment="Corrected comment for var:202 to refer to environment variable" date="2009-12-01T17:28:00.093-05:00">
          <contributor organization="Gideon Technologies, Inc.">Dragos Prisaca</contributor>
        </modified>
        <status_change date="2009-12-01T17:32:23.746-05:00">INTERIM</status_change>
        <status_change date="2009-12-21T04:00:50.985-05:00">ACCEPTED</status_change>
        <modified comment="EDITED oval:org.mitre.oval:def:6257 - def:6257, - Added LDR version check for Windows Media Format 11. - tst:10615 is replaced by new test, as it was pointing to wrong file.  def:5531, - Removed non-vuln Windows Media Services from product tag. - Added LDR version check for Windows Media Format 11. - tst:10615 is replaced by new test, as it was pointing to wrong file." date="2011-10-27T10:12:00.272-04:00">
          <contributor organization="SecPod Technologies">Rachana Shetty</contributor>
        </modified>
        <status_change date="2011-10-27T10:15:54.569-04:00">INTERIM</status_change>
        <status_change date="2011-11-14T04:01:00.178-05:00">ACCEPTED</status_change>
        <modified comment="EDITED oval:org.mitre.oval:def:6257 - modified comments" date="2014-02-28T15:13:00.247-05:00">
          <contributor organization="ALTX-SOFT">Maria Mikhno</contributor>
        </modified>
        <status_change date="2014-02-28T15:16:17.693-05:00">INTERIM</status_change>
        <status_change date="2014-03-17T04:00:26.163-04:00">ACCEPTED</status_change>
        <modified comment="EDITED oval:org.mitre.oval:def:6257 - extended definitions of OS are without SP checks" date="2014-07-28T17:41:00.906-04:00">
          <contributor organization="ALTX-SOFT">Maria Mikhno</contributor>
        </modified>
        <status_change date="2014-07-28T17:42:50.731-04:00">INTERIM</status_change>
        <status_change date="2014-08-18T04:06:10.141-04:00">ACCEPTED</status_change>
      </dates>
      <status>ACCEPTED</status>
      <min_schema_version>5.4</min_schema_version>
    </oval_repository>
  </metadata>
  <criteria operator="OR">
    <criteria operator="AND" comment="Windows Media Format Runtime 9.0 on Windows 2000 and Windows XP">
      <criteria operator="OR" comment="OS Check">
        <extend_definition comment="Microsoft Windows 2000 is installed" definition_ref="oval:org.mitre.oval:def:85"/>
        <extend_definition comment="Microsoft Windows XP (32-bit) is installed" definition_ref="oval:org.mitre.oval:def:1353"/>
      </criteria>
      <criterion comment="Wmvcore.dll for Windows Media Format 9.0 is installed." test_ref="oval:org.mitre.oval:tst:125"/>
      <criterion comment="the version of Wmvcore.dll is less than 9.0.0.3270" test_ref="oval:org.mitre.oval:tst:10770"/>
    </criteria>
    <criteria operator="AND" comment="Windows Media Format Runtime 9.0 on Windows XP (x86)">
      <extend_definition comment="Microsoft Windows XP (32-bit) is installed" definition_ref="oval:org.mitre.oval:def:1353"/>
      <criterion comment="Wmvcore.dll for Windows Media Format 9.0 is installed." test_ref="oval:org.mitre.oval:tst:125"/>
      <criterion comment="the version of Wmvcore.dll is less than 9.0.0.4506" test_ref="oval:org.mitre.oval:tst:10757"/>
    </criteria>
    <criteria operator="AND" comment="Windows Media Format Runtime 9.5 on Windows XP (x86)">
      <extend_definition comment="Microsoft Windows XP (32-bit) is installed" definition_ref="oval:org.mitre.oval:def:1353"/>
      <criterion comment="Wmvcore.dll for Windows Media Format 9.5 is installed." test_ref="oval:org.mitre.oval:tst:115"/>
      <criterion comment="the version of Wmvcore.dll is less than 10.0.0.3705" test_ref="oval:org.mitre.oval:tst:10702"/>
    </criteria>
    <criteria operator="AND" comment="Windows Media Format Runtime 11 on Windows XP (x86)">
      <extend_definition comment="Microsoft Windows XP (32-bit) is installed" definition_ref="oval:org.mitre.oval:def:1353"/>
      <criterion comment="Wmvcore.dll for Windows Media Format 11.0 is installed." test_ref="oval:org.mitre.oval:tst:6765"/>
      <criterion comment="the version of Wmvcore.dll is less than 11.0.5721.5265" test_ref="oval:org.mitre.oval:tst:10594"/>
    </criteria>
    <criteria operator="AND" comment="Windows Media Format Runtime 9.5 on Windows XP x64 ans Windows 2003 x64">
      <criteria operator="OR" comment="OS Check">
        <extend_definition comment="Microsoft Windows XP x64 is installed" definition_ref="oval:org.mitre.oval:def:15247"/>
        <extend_definition comment="Microsoft Windows Server 2003 (x64) is installed" definition_ref="oval:org.mitre.oval:def:730"/>
      </criteria>
      <criterion comment="Wmvcore.dll for Windows Media Format 9.5 on x64-bit platform is installed." test_ref="oval:org.mitre.oval:tst:10154"/>
      <criterion comment="the version of %SystemRoot%\SysWOW64\Wmvcore.dll is less than 10.0.0.4005" test_ref="oval:org.mitre.oval:tst:10673"/>
    </criteria>
    <criteria operator="AND" comment="Windows Media Format Runtime 11 on Windows XP x64">
      <extend_definition comment="Microsoft Windows XP x64 is installed" definition_ref="oval:org.mitre.oval:def:15247"/>
      <criterion comment="Wmvcore.dll for Windows Media Format 11.0 on x64-bit platform is installed." test_ref="oval:org.mitre.oval:tst:10083"/>
      <criterion comment="the version of %SystemRoot%\SysWOW64\Wmvcore.dll is less than 11.0.5721.5265" test_ref="oval:org.mitre.oval:tst:10402"/>
    </criteria>
    <criteria operator="AND" comment="Windows Media Format Runtime 9.5 on Windows Server 2003 x86">
      <extend_definition comment="Microsoft Windows Server 2003 (32-bit) is installed" definition_ref="oval:org.mitre.oval:def:1870"/>
      <criterion comment="Wmvcore.dll for Windows Media Format 9.5 is installed." test_ref="oval:org.mitre.oval:tst:115"/>
      <criterion comment="the version of Wmvcore.dll is less than 10.0.0.4005" test_ref="oval:org.mitre.oval:tst:10704"/>
    </criteria>
    <criteria operator="AND" comment="Windows Media Format Runtime 11 on Windows Vista x86/x64">
      <criteria operator="OR" comment="OS Check">
        <extend_definition comment="Microsoft Windows Vista (32-bit) is installed" definition_ref="oval:org.mitre.oval:def:1282"/>
        <extend_definition comment="Microsoft Windows Vista x64 Edition is installed" definition_ref="oval:org.mitre.oval:def:2041"/>
      </criteria>
      <criterion comment="Wmvcore.dll for Windows Media Format 11.0 is installed." test_ref="oval:org.mitre.oval:tst:6765"/>
      <criterion comment="the version of Wmvcore.dll is less than 11.0.5721.5265" test_ref="oval:org.mitre.oval:tst:10337"/>
    </criteria>
    <criteria operator="AND" comment="Windows Media Format Runtime 11 on Windows Vista x86/x64, Windows Server 2008 x86/x64">
      <criteria operator="OR" comment="OS Check">
        <extend_definition comment="Microsoft Windows Vista (32-bit) is installed" definition_ref="oval:org.mitre.oval:def:1282"/>
        <extend_definition comment="Microsoft Windows Vista x64 Edition is installed" definition_ref="oval:org.mitre.oval:def:2041"/>
        <extend_definition comment="Microsoft Windows Server 2008 (32-bit) is installed" definition_ref="oval:org.mitre.oval:def:4870"/>
        <extend_definition comment="Microsoft Windows Server 2008 (64-bit) is installed" definition_ref="oval:org.mitre.oval:def:5356"/>
      </criteria>
      <criterion comment="Wmvcore.dll for Windows Media Format 11.0 is installed." test_ref="oval:org.mitre.oval:tst:6765"/>
      <criterion comment="the version of Wmvcore.dll is less than 11.0.6001.7006" test_ref="oval:org.mitre.oval:tst:10211"/>
    </criteria>
    <criteria operator="AND" comment="Windows Media Format Runtime 11 on Windows Vista x86/x64, Windows Server 2008 x86/x64">
      <criteria operator="OR" comment="OS Check">
        <extend_definition comment="Microsoft Windows Vista (32-bit) is installed" definition_ref="oval:org.mitre.oval:def:1282"/>
        <extend_definition comment="Microsoft Windows Vista x64 Edition is installed" definition_ref="oval:org.mitre.oval:def:2041"/>
        <extend_definition comment="Microsoft Windows Server 2008 (32-bit) is installed" definition_ref="oval:org.mitre.oval:def:4870"/>
        <extend_definition comment="Microsoft Windows Server 2008 (64-bit) is installed" definition_ref="oval:org.mitre.oval:def:5356"/>
      </criteria>
      <criterion comment="Wmvcore.dll for Windows Media Format 11.0 is installed." test_ref="oval:org.mitre.oval:tst:6765"/>
      <criteria operator="OR" comment="GDR or LDR Service branch">
        <criterion comment="the version of Wmvcore.dll is less than 11.0.6002.18049" test_ref="oval:org.mitre.oval:tst:44381"/>
        <criteria operator="AND" comment="LDR">
          <criterion comment="the version of Wmvcore.dll is greater than or equal 11.0.6002.22000" test_ref="oval:org.mitre.oval:tst:43500"/>
          <criterion comment="the version of Wmvcore.dll is less than 11.0.6002.22150" test_ref="oval:org.mitre.oval:tst:44186"/>
        </criteria>
      </criteria>
    </criteria>
    <criteria operator="AND" comment="Windows Media Services 9.1 on Windows Server 2003 x86/x64">
      <criteria operator="OR" comment="OS Check">
        <extend_definition comment="Microsoft Windows Server 2003 (32-bit) is installed" definition_ref="oval:org.mitre.oval:def:1870"/>
        <extend_definition comment="Microsoft Windows Server 2003 (x64) is installed" definition_ref="oval:org.mitre.oval:def:730"/>
      </criteria>
      <criterion comment="wmsserver.dll for Windows Media Services 9.1 is installed." test_ref="oval:org.mitre.oval:tst:6184"/>
      <criterion comment="the version of wmsserver.dll is less than 9.1.1.5001" test_ref="oval:org.mitre.oval:tst:10306"/>
    </criteria>
    <criteria operator="AND" comment="Windows Media Services 2008">
      <criteria operator="OR" comment="OS Check">
        <extend_definition comment="Microsoft Windows Server 2008 (32-bit) is installed" definition_ref="oval:org.mitre.oval:def:4870"/>
        <extend_definition comment="Microsoft Windows Server 2008 (64-bit) is installed" definition_ref="oval:org.mitre.oval:def:5356"/>
      </criteria>
      <extend_definition comment="Microsoft Media Services 9 is installed" definition_ref="oval:org.mitre.oval:def:5844"/>
      <criterion comment="Wmsserver.dll version is less than 9.5.6001.18281" test_ref="oval:org.mitre.oval:tst:10413"/>
    </criteria>
  </criteria>
</definition>