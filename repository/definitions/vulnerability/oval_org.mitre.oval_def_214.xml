<definition xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5" class="vulnerability" id="oval:org.mitre.oval:def:214" version="24">
  <metadata>
    <title>Vulnerability in Microsoft Data Access Components Could Allow Remote Code Execution</title>
    <affected family="windows">
      <platform>Microsoft Windows 2000</platform>
      <platform>Microsoft Windows XP</platform>
      <platform>Microsoft Windows Server 2003</platform>
    </affected>
    <reference ref_id="CVE-2006-5559" ref_url="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-5559" source="CVE" />
    <description>The Execute method in the ADODB.Connection 2.7 and 2.8 ActiveX control objects (ADODB.Connection.2.7 and ADODB.Connection.2.8) in the Microsoft Data Access Components (MDAC) 2.5 SP3, 2.7 SP1, 2.8, and 2.8 SP1 does not properly track freed memory when the second argument is a BSTR, which allows remote attackers to cause a denial of service (Internet Explorer crash) and possibly execute arbitrary code via certain strings in the second and third arguments.</description>
    <oval_repository>
      <dates>
        <submitted date="2007-02-13T14:38:21">
          <contributor organization="Secure Elements, Inc.">Sudhir Gandhe</contributor>
        </submitted>
        <status_change date="2007-02-20T13:20:00.000-04:00">DRAFT</status_change>
        <modified comment="Corrected XP and S03 tests to look for versions of Msado15.dll instead of Msadco.dll." date="2007-03-02T12:18:00.315-05:00">
          <contributor organization="ThreatGuard, Inc.">Robert L. Hollis</contributor>
        </modified>
        <status_change date="2007-03-21T16:17:11.974-04:00">INTERIM</status_change>
        <status_change date="2007-04-10T13:44:23.320-04:00">ACCEPTED</status_change>
        <modified comment="References registry value for Common Files directory due to multilingual support" date="2008-04-14T11:07:00.042-04:00">
          <contributor organization="GFI Software">Clifford Farrugia</contributor>
        </modified>
        <status_change date="2008-04-14T12:24:53.469-04:00">INTERIM</status_change>
        <modified comment="References registry value for Common Files directory due to multilingual support" date="2008-04-14T11:07:00.270-04:00">
          <contributor organization="GFI Software">Clifford Farrugia</contributor>
        </modified>
        <status_change date="2008-05-05T04:00:17.294-04:00">ACCEPTED</status_change>
        <modified comment="EDITED oval:org.mitre.oval:def:214 - Modified the test for MDAC 2.8 SP1" date="2011-02-28T09:34:00.995-05:00">
          <contributor organization="Symantec Corporation">Josh Turpin</contributor>
        </modified>
        <status_change date="2011-02-28T09:35:53.876-05:00">INTERIM</status_change>
        <status_change date="2011-03-21T04:00:14.317-04:00">ACCEPTED</status_change>
      </dates>
      <status>ACCEPTED</status>
      <min_schema_version>5.10</min_schema_version>
    </oval_repository>
  </metadata>
  <criteria operator="OR">
    <criteria comment="Windows 2000 SP4 with Microsoft Data Access Components 2.5 SP3" operator="AND">
      <extend_definition comment="Microsoft Windows 2000 SP4 or later is installed" definition_ref="oval:org.mitre.oval:def:229" />
      <criterion comment="Microsoft Data Access Components 2.5 (SP3) is installed" test_ref="oval:org.mitre.oval:tst:729" />
      <criterion comment="the version of msadco.dll is less than 2.53.6307.0" test_ref="oval:org.mitre.oval:tst:4137" />
    </criteria>
    <criteria comment="Windows 2000 SP4 with Microsoft Data Access Components 2.7 SP1" operator="AND">
      <extend_definition comment="Microsoft Windows 2000 SP4 or later is installed" definition_ref="oval:org.mitre.oval:def:229" />
      <criterion comment="Microsoft Data Access Components 2.7 (SP1) is installed" test_ref="oval:org.mitre.oval:tst:2382" />
      <criterion comment="the version of msadco.dll is less than 2.71.9054.0" test_ref="oval:org.mitre.oval:tst:4020" />
    </criteria>
    <criteria comment="Windows 2000 SP4 with Microsoft Data Access Components 2.8" operator="AND">
      <extend_definition comment="Microsoft Windows 2000 SP4 or later is installed" definition_ref="oval:org.mitre.oval:def:229" />
      <criterion comment="Microsoft Data Access Components 2.8 (RTM) is installed" test_ref="oval:org.mitre.oval:tst:2363" />
      <criterion comment="the version of msadco.dll is less than 2.80.1064.0" test_ref="oval:org.mitre.oval:tst:3591" />
    </criteria>
    <criteria comment="Windows 2000 SP4 with Microsoft Data Access Components 2.8 SP1" operator="AND">
      <extend_definition comment="Microsoft Windows 2000 SP4 or later is installed" definition_ref="oval:org.mitre.oval:def:229" />
      <criterion comment="Microsoft Data Access Components 2.8 (SP1) is installed" test_ref="oval:org.mitre.oval:tst:725" />
      <criterion comment="the version of msadco.dll is less than 2.81.1128.0" test_ref="oval:org.mitre.oval:tst:3619" />
    </criteria>
    <criteria comment="Windows XP SP2 with Microsoft Data Access Components 2.8 SP1" operator="AND">
      <extend_definition comment="Microsoft Windows XP SP2 or later is installed" definition_ref="oval:org.mitre.oval:def:521" />
      <criterion comment="Microsoft Data Access Components 2.8 (SP1) is installed" test_ref="oval:org.mitre.oval:tst:725" />
      <criterion comment="Msado15.dll version is less than 2.81.1128.0" test_ref="oval:org.mitre.oval:tst:3821" />
    </criteria>
    <criteria comment="Windows Server 2003 with Microsoft Data Access Components 2.8" operator="AND">
      <extend_definition comment="Microsoft Windows Server 2003 (x86) Gold is installed" definition_ref="oval:org.mitre.oval:def:165" />
      <criterion comment="Microsoft Data Access Components 2.8 (RTM) is installed" test_ref="oval:org.mitre.oval:tst:2363" />
      <criterion comment="the version of msado15.dll is less than 2.80.1064.0" test_ref="oval:org.mitre.oval:tst:3787" />
    </criteria>
  </criteria>
</definition>
