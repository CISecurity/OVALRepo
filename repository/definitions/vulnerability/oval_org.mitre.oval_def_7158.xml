<?xml version="1.0" encoding="UTF-8"?>
<definition id="oval:org.mitre.oval:def:7158" version="11" class="vulnerability">
  <metadata>
    <title>XML Signature HMAC Truncation Authentication Bypass Vulnerability</title>
    <affected family="windows">
      <platform>Microsoft Windows 2000</platform>
      <platform>Microsoft Windows XP</platform>
      <platform>Microsoft Windows Vista</platform>
      <platform>Microsoft Windows 7</platform>
      <platform>Microsoft Windows Server 2003</platform>
      <platform>Microsoft Windows Server 2008</platform>
      <platform>Microsoft Windows Server 2008 R2</platform>
      <product>Microsoft .NET Framework</product>
    </affected>
    <reference source="CVE" ref_id="CVE-2009-0217" ref_url="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-0217"/>
    <description>The design of the W3C XML Signature Syntax and Processing (XMLDsig) recommendation, as implemented in products including (1) the Oracle Security Developer Tools component in Oracle Application Server 10.1.2.3, 10.1.3.4, and 10.1.4.3IM; (2) the WebLogic Server component in BEA Product Suite 10.3, 10.0 MP1, 9.2 MP3, 9.1, 9.0, and 8.1 SP6; (3) Mono before 2.4.2.2; (4) XML Security Library before 1.2.12; (5) IBM WebSphere Application Server Versions 6.0 through 6.0.2.33, 6.1 through 6.1.0.23, and 7.0 through 7.0.0.1; (6) Sun JDK and JRE Update 14 and earlier; (7) Microsoft .NET Framework 3.0 through 3.0 SP2, 3.5, and 4.0; and other products uses a parameter that defines an HMAC truncation length (HMACOutputLength) but does not require a minimum for this length, which allows attackers to spoof HMAC-based signatures and bypass authentication by specifying a truncation length with a small number of bits.</description>
    <oval_repository>
      <dates>
        <submitted date="2010-06-08T13:00:00">
          <contributor organization="Symantec Corporation">Dragos Prisaca</contributor>
        </submitted>
        <status_change date="2010-06-14T11:33:22.713-04:00">DRAFT</status_change>
        <status_change date="2010-06-29T11:49:28.102-04:00">INTERIM</status_change>
        <status_change date="2010-07-19T04:00:29.682-04:00">ACCEPTED</status_change>
        <modified comment="Removed the Windows Server 2003 SP2 (x86) extended def reference in the larger .Net Framework 1.1 criteria section.  The proper test for .Net Framework 1.1 on 2003 x86 was already broken out separately." date="2010-07-28T13:32:00.593-04:00">
          <contributor organization="DTCC">J. Daniel Brown</contributor>
        </modified>
        <status_change date="2010-07-28T13:33:31.800-04:00">INTERIM</status_change>
        <status_change date="2010-08-16T04:10:49.309-04:00">ACCEPTED</status_change>
        <status_change date="2012-03-05T14:23:57.243-05:00">INTERIM</status_change>
        <modified comment="Added Windows Server 2008 R2 platform" date="2012-03-05T14:23:57.243-05:00">
          <contributor organization="Symantec Corporation">Dragos Prisaca</contributor>
        </modified>
        <status_change date="2012-03-26T04:03:46.216-04:00">ACCEPTED</status_change>
        <modified comment="EDITED oval:org.mitre.oval:def:7158 - Submitting updated MS10-041 bulletin. def:7158 - updated to include LDR support." date="2013-05-29T15:56:00.291-04:00">
          <contributor organization="SecPod Technologies">Sharath S</contributor>
        </modified>
        <status_change date="2013-05-29T15:59:21.130-04:00">INTERIM</status_change>
        <status_change date="2013-06-17T04:00:30.601-04:00">ACCEPTED</status_change>
        <modified comment="EDITED oval:org.mitre.oval:def:7158 - extended definitions of OS are without SP checks" date="2014-07-28T17:44:00.322-04:00">
          <contributor organization="ALTX-SOFT">Maria Mikhno</contributor>
        </modified>
        <status_change date="2014-07-28T17:46:27.851-04:00">INTERIM</status_change>
        <status_change date="2014-08-18T04:06:24.788-04:00">ACCEPTED</status_change>
      </dates>
      <status>ACCEPTED</status>
    </oval_repository>
  </metadata>
  <criteria operator="OR">
    <criteria operator="AND" comment=".NET Framework 1.1 SP1">
      <criteria operator="OR" comment="For OS Check">
        <extend_definition comment="Microsoft Windows 2000 is installed" definition_ref="oval:org.mitre.oval:def:85"/>
        <extend_definition comment="Microsoft Windows XP (32-bit) is installed" definition_ref="oval:org.mitre.oval:def:1353"/>
        <extend_definition comment="Microsoft Windows XP x64 is installed" definition_ref="oval:org.mitre.oval:def:15247"/>
        <extend_definition comment="Microsoft Windows Server 2003 (x64) is installed" definition_ref="oval:org.mitre.oval:def:730"/>
        <extend_definition comment="Microsoft Windows Server 2003 (ia64) Gold is installed" definition_ref="oval:org.mitre.oval:def:396"/>
        <extend_definition comment="Microsoft Windows Vista (32-bit) is installed" definition_ref="oval:org.mitre.oval:def:1282"/>
        <extend_definition comment="Microsoft Windows Vista x64 Edition is installed" definition_ref="oval:org.mitre.oval:def:2041"/>
        <extend_definition comment="Microsoft Windows Server 2008 (32-bit) is installed" definition_ref="oval:org.mitre.oval:def:4870"/>
        <extend_definition comment="Microsoft Windows Server 2008 (64-bit) is installed" definition_ref="oval:org.mitre.oval:def:5356"/>
        <extend_definition comment="Microsoft Windows Server 2008 (ia-64) is installed" definition_ref="oval:org.mitre.oval:def:5667"/>
      </criteria>
      <extend_definition comment="Microsoft .NET Framework 1.1 Service Pack 1 is Installed" definition_ref="oval:org.mitre.oval:def:1834"/>
      <criterion comment="the version of Mscorlib.dll is less than 1.1.4322.2463" test_ref="oval:org.mitre.oval:tst:27588"/>
    </criteria>
    <criteria operator="AND" comment=".NET Framework 1.1 Service Pack 1">
      <extend_definition comment="Microsoft Windows Server 2003 (32-bit) is installed" definition_ref="oval:org.mitre.oval:def:1870"/>
      <extend_definition comment="Microsoft .NET Framework 1.1 Service Pack 1 is Installed" definition_ref="oval:org.mitre.oval:def:1834"/>
      <criterion comment="the version of System.Security.dll is less than 1.1.4322.2460" test_ref="oval:org.mitre.oval:tst:27732"/>
    </criteria>
    <criteria operator="AND" comment=".NET Framework 3.5">
      <criteria operator="OR" comment="For OS Check">
        <extend_definition comment="Microsoft Windows Vista (32-bit) is installed" definition_ref="oval:org.mitre.oval:def:1282"/>
        <extend_definition comment="Microsoft Windows Vista x64 Edition is installed" definition_ref="oval:org.mitre.oval:def:2041"/>
        <extend_definition comment="Microsoft Windows Server 2008 (32-bit) is installed" definition_ref="oval:org.mitre.oval:def:4870"/>
        <extend_definition comment="Microsoft Windows Server 2008 (64-bit) is installed" definition_ref="oval:org.mitre.oval:def:5356"/>
        <extend_definition comment="Microsoft Windows Server 2008 (ia-64) is installed" definition_ref="oval:org.mitre.oval:def:5667"/>
      </criteria>
      <extend_definition comment="Microsoft .NET Framework 3.5 Original Release is installed" definition_ref="oval:org.mitre.oval:def:6689"/>
      <criterion comment="System.web.dll version is less than 2.0.50727.1878" test_ref="oval:org.mitre.oval:tst:27523"/>
    </criteria>
    <criteria operator="AND" comment=".NET Framework 2.0 SP2 or 3.5 SP1">
      <criteria operator="OR" comment="For OS Check">
        <extend_definition comment="Microsoft Windows 2000 is installed" definition_ref="oval:org.mitre.oval:def:85"/>
        <extend_definition comment="Microsoft Windows XP (32-bit) is installed" definition_ref="oval:org.mitre.oval:def:1353"/>
        <extend_definition comment="Microsoft Windows XP x64 is installed" definition_ref="oval:org.mitre.oval:def:15247"/>
        <extend_definition comment="Microsoft Windows Server 2003 (32-bit) is installed" definition_ref="oval:org.mitre.oval:def:1870"/>
        <extend_definition comment="Microsoft Windows Server 2003 (x64) is installed" definition_ref="oval:org.mitre.oval:def:730"/>
        <extend_definition comment="Microsoft Windows Server 2003 (ia64) Gold is installed" definition_ref="oval:org.mitre.oval:def:396"/>
        <extend_definition comment="Microsoft Windows Vista (32-bit) is installed" definition_ref="oval:org.mitre.oval:def:1282"/>
        <extend_definition comment="Microsoft Windows Vista x64 Edition is installed" definition_ref="oval:org.mitre.oval:def:2041"/>
        <extend_definition comment="Microsoft Windows Server 2008 (32-bit) is installed" definition_ref="oval:org.mitre.oval:def:4870"/>
        <extend_definition comment="Microsoft Windows Server 2008 (64-bit) is installed" definition_ref="oval:org.mitre.oval:def:5356"/>
        <extend_definition comment="Microsoft Windows Server 2008 (ia-64) is installed" definition_ref="oval:org.mitre.oval:def:5667"/>
      </criteria>
      <criteria operator="OR" comment="Check for Microsoft .NET Framework 2.0 Service Pack 2 or 3.5 SP1">
        <extend_definition comment="Microsoft .NET Framework 2.0 Service Pack 2 is installed" definition_ref="oval:org.mitre.oval:def:6158"/>
        <extend_definition comment="Microsoft .NET Framework 3.5 SP1 is installed" definition_ref="oval:org.mitre.oval:def:12542"/>
      </criteria>
      <criteria operator="OR" comment="Check for GDR and LDR versions">
        <criterion comment="the version of System.Security.dll is less than 2.0.50727.3613" test_ref="oval:org.mitre.oval:tst:27623"/>
        <criteria operator="AND" comment="Check for LDR version">
          <criterion comment="Check if System.Security.dll version is greater than or equal to 2.0.50727.4000" test_ref="oval:org.mitre.oval:tst:81021"/>
          <criterion comment="Check if System.Security.dll version is less than 2.0.50727.4434" test_ref="oval:org.mitre.oval:tst:81257"/>
        </criteria>
      </criteria>
    </criteria>
    <criteria operator="AND" comment=".NET Framework 3.5">
      <criteria operator="OR" comment="For OS Check">
        <extend_definition comment="Microsoft Windows XP (32-bit) is installed" definition_ref="oval:org.mitre.oval:def:1353"/>
        <extend_definition comment="Microsoft Windows XP x64 is installed" definition_ref="oval:org.mitre.oval:def:15247"/>
        <extend_definition comment="Microsoft Windows Server 2003 (32-bit) is installed" definition_ref="oval:org.mitre.oval:def:1870"/>
        <extend_definition comment="Microsoft Windows Server 2003 (x64) is installed" definition_ref="oval:org.mitre.oval:def:730"/>
        <extend_definition comment="Microsoft Windows Server 2003 (ia64) Gold is installed" definition_ref="oval:org.mitre.oval:def:396"/>
      </criteria>
      <extend_definition comment="Microsoft .NET Framework 3.5 Original Release is installed" definition_ref="oval:org.mitre.oval:def:6689"/>
      <criterion comment="the version of System.Security.dll is less than 2.0.50727.1879" test_ref="oval:org.mitre.oval:tst:27098"/>
    </criteria>
    <criteria operator="AND" comment=".NET Framework 3.5 SP1 on Vista x86/x64, Windows Server 2008 x86/x64/ia64">
      <criteria operator="OR" comment="For OS Check">
        <extend_definition comment="Microsoft Windows Vista (32-bit) is installed" definition_ref="oval:org.mitre.oval:def:1282"/>
        <extend_definition comment="Microsoft Windows Vista x64 Edition is installed" definition_ref="oval:org.mitre.oval:def:2041"/>
        <extend_definition comment="Microsoft Windows Server 2008 (32-bit) is installed" definition_ref="oval:org.mitre.oval:def:4870"/>
        <extend_definition comment="Microsoft Windows Server 2008 (64-bit) is installed" definition_ref="oval:org.mitre.oval:def:5356"/>
        <extend_definition comment="Microsoft Windows Server 2008 (ia-64) is installed" definition_ref="oval:org.mitre.oval:def:5667"/>
      </criteria>
      <extend_definition comment="Microsoft .NET Framework 3.5 SP1 is installed" definition_ref="oval:org.mitre.oval:def:12542"/>
      <criteria operator="OR" comment="Check for GDR and LDR versions">
        <criterion comment="the version of system.security.dll is less than 2.0.50727.4204" test_ref="oval:org.mitre.oval:tst:27451"/>
        <criteria operator="AND" comment="Check for LDR versions">
          <criterion comment="Check if System.Security.dll version is greater than or equal to 2.0.50727.4300" test_ref="oval:org.mitre.oval:tst:80770"/>
          <criterion comment="Check if System.Security.dll version is less than 2.0.50727.4434" test_ref="oval:org.mitre.oval:tst:81257"/>
        </criteria>
      </criteria>
    </criteria>
    <criteria operator="AND" comment="Microsoft .NET Framework 3.5.1 on Windows 7 x86/x64, Server 2008 R2 x64/ia64">
      <criteria operator="OR" comment="For OS Check">
        <extend_definition comment="Microsoft Windows 7 (32-bit) is installed" definition_ref="oval:org.mitre.oval:def:6165"/>
        <extend_definition comment="Microsoft Windows 7 x64 Edition is installed" definition_ref="oval:org.mitre.oval:def:5950"/>
        <extend_definition comment="Microsoft Windows Server 2008 R2 x64 Edition is installed" definition_ref="oval:org.mitre.oval:def:6438"/>
        <extend_definition comment="Microsoft Windows Server 2008 R2 Itanium-Based Edition is installed" definition_ref="oval:org.mitre.oval:def:5954"/>
      </criteria>
      <extend_definition comment="Microsoft .NET Framework 3.5 SP1 is installed" definition_ref="oval:org.mitre.oval:def:12542"/>
      <criteria operator="OR" comment="Check for GDR and LDR versions">
        <criterion comment="the version of system.security.dll is less than 2.0.50727.4951" test_ref="oval:org.mitre.oval:tst:27053"/>
        <criteria operator="AND" comment="Check for LDR versions">
          <criterion comment="Check if System.Security.dll version is greater than or equal to 2.0.50727.5000" test_ref="oval:org.mitre.oval:tst:80869"/>
          <criterion comment="Check if system.security.dll version is less than 2.0.50727.5007" test_ref="oval:org.mitre.oval:tst:81083"/>
        </criteria>
      </criteria>
    </criteria>
  </criteria>
</definition>