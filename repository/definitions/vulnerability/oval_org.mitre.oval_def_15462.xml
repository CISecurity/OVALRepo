<?xml version="1.0" encoding="UTF-8"?>
<definition id="oval:org.mitre.oval:def:15462" version="10" class="vulnerability">
  <metadata>
    <title>MSCOMCTL.OCX RCE Vulnerability</title>
    <affected family="windows">
      <platform>Microsoft Windows XP</platform>
      <platform>Microsoft Windows Server 2003</platform>
      <platform>Microsoft Windows Vista</platform>
      <platform>Microsoft Windows Server 2008</platform>
      <platform>Microsoft Windows Server 2008 R2</platform>
      <platform>Microsoft Windows 7</platform>
      <product>Microsoft Office 2003</product>
      <product>Microsoft Office 2003 Web Components</product>
      <product>Microsoft Office 2007</product>
      <product>Microsoft Office 2010</product>
      <product>Microsoft SQL Server 2000 Analysis Services</product>
      <product>Microsoft SQL Server 2000</product>
      <product>Microsoft SQL Server 2005 Express Edition</product>
      <product>Microsoft SQL Server 2005</product>
      <product>Microsoft SQL Server 2008</product>
      <product>Microsoft SQL Server 2008 R2</product>
      <product>Microsoft BizTalk Server 2002</product>
      <product>Microsoft Commerce Server 2002</product>
      <product>Microsoft Commerce Server 2007</product>
      <product>Microsoft Commerce Server 2009</product>
      <product>Microsoft Commerce Server 2009 R2</product>
      <product>Microsoft Visual FoxPro 8.0</product>
      <product>Microsoft Visual FoxPro 9.0</product>
      <product>Visual Basic 6.0 Runtime</product>
    </affected>
    <reference source="CVE" ref_id="CVE-2012-0158" ref_url="http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-0158"/>
    <description>The (1) ListView, (2) ListView2, (3) TreeView, and (4) TreeView2 ActiveX controls in MSCOMCTL.OCX in the Common Controls in Microsoft Office 2003 SP3, 2007 SP2 and SP3, and 2010 Gold and SP1; Office 2003 Web Components SP3; SQL Server 2000 SP4, 2005 SP4, and 2008 SP2, SP3, and R2; BizTalk Server 2002 SP1; Commerce Server 2002 SP4, 2007 SP2, and 2009 Gold and R2; Visual FoxPro 8.0 SP1 and 9.0 SP2; and Visual Basic 6.0 Runtime allow remote attackers to execute arbitrary code via a crafted (a) web site, (b) Office document, or (c) .rtf file that triggers "system state" corruption, as exploited in the wild in April 2012, aka "MSCOMCTL.OCX RCE Vulnerability."</description>
    <oval_repository>
      <dates>
        <submitted date="2012-04-10T13:00:00">
          <contributor organization="Symantec Corporation">Dragos Prisaca</contributor>
        </submitted>
        <status_change date="2012-04-16T20:32:55.063-04:00">DRAFT</status_change>
        <status_change date="2012-05-07T04:02:27.892-04:00">INTERIM</status_change>
        <status_change date="2012-05-28T04:01:08.369-04:00">ACCEPTED</status_change>
        <modified comment="EDITED oval:org.mitre.oval:obj:23620 - New Microsoft Patch Tuesday August 2012 definitions." date="2012-08-21T16:16:00.261-04:00">
          <contributor organization="SecPod Technologies">Chandan S</contributor>
        </modified>
        <status_change date="2012-08-21T17:03:48.137-04:00">INTERIM</status_change>
        <status_change date="2012-09-10T04:00:21.804-04:00">ACCEPTED</status_change>
        <modified comment="EDITED oval:org.mitre.oval:def:15462 - New inventory definition for VB6, and updates to definitions incorrectly checking VBA inventory instead of VB6." date="2012-10-25T16:38:00.742-04:00">
          <contributor organization="SecPod Technologies">Pradeep R B</contributor>
        </modified>
        <status_change date="2012-10-25T16:58:30.880-04:00">INTERIM</status_change>
        <status_change date="2012-11-12T04:00:11.802-05:00">ACCEPTED</status_change>
        <modified comment="EDITED oval:org.mitre.oval:def:15462 - Several defs updated with respect to MS Office 2007" date="2014-05-23T10:23:00.884-04:00">
          <contributor organization="ALTX-SOFT">Maria Mikhno</contributor>
        </modified>
        <status_change date="2014-05-23T10:26:30.503-04:00">INTERIM</status_change>
        <modified comment="EDITED oval:org.mitre.oval:obj:23554 - fixes false negative Office 32bit is installed on a 64bit OS" date="2014-05-23T10:37:00.086-04:00">
          <contributor organization="G2, Inc.">Dragos Prisaca</contributor>
        </modified>
        <status_change date="2014-06-09T04:00:14.623-04:00">ACCEPTED</status_change>
      </dates>
      <status>ACCEPTED</status>
    </oval_repository>
  </metadata>
  <criteria operator="OR">
    <criteria operator="AND" comment="Vulnerable version of Mscomctl.Ocx">
      <criteria operator="OR" comment="Multiple Affected Software">
        <extend_definition comment="Microsoft Office 2003 SP3 is installed" definition_ref="oval:org.mitre.oval:def:15626"/>
        <extend_definition comment="Microsoft Office 2003 Web Components SP3 is installed" definition_ref="oval:org.mitre.oval:def:15325"/>
        <extend_definition comment="Microsoft Office 2007 SP2 is installed" definition_ref="oval:org.mitre.oval:def:15607"/>
        <extend_definition comment="Microsoft Office 2007 SP3 is installed" definition_ref="oval:org.mitre.oval:def:15704"/>
        <extend_definition comment="Microsoft Office 2010 SP1 x86 is installed" definition_ref="oval:org.mitre.oval:def:20819"/>
        <criteria operator="AND" comment="Microsoft Office 2010 SP0 x86">
          <extend_definition comment="Microsoft Office 2010 is installed" definition_ref="oval:org.mitre.oval:def:12061"/>
          <criterion comment="an architecture of Office 2010 is x86" test_ref="oval:org.mitre.oval:tst:88785"/>
          <extend_definition negate="true" comment="Microsoft Office 2010 SP1 is installed" definition_ref="oval:org.mitre.oval:def:15198"/>
          <extend_definition negate="true" comment="Microsoft Office 2010 SP2 is installed" definition_ref="oval:org.mitre.oval:def:17121"/>
        </criteria>
        <extend_definition comment="Microsoft SQL Server 2005 SP4 is installed" definition_ref="oval:org.mitre.oval:def:12442"/>
        <extend_definition comment="Microsoft SQL Server 2008 SP2 is installed" definition_ref="oval:org.mitre.oval:def:12310"/>
        <extend_definition comment="Microsoft SQL Server 2008 SP3 is installed" definition_ref="oval:org.mitre.oval:def:15497"/>
        <criteria operator="AND" comment="SQL Server 2008 R2 SP0 and SP1">
          <extend_definition negate="true" comment="Microsoft SQL Server 2008 R2 SP2 is installed" definition_ref="oval:org.mitre.oval:def:15803"/>
          <extend_definition comment="Microsoft SQL Server 2008 R2 is installed" definition_ref="oval:org.mitre.oval:def:12596"/>
        </criteria>
        <extend_definition comment="Microsoft BizTalk Server 2002 is installed" definition_ref="oval:org.mitre.oval:def:15292"/>
        <extend_definition comment="Microsoft Commerce Server 2002 is installed" definition_ref="oval:org.mitre.oval:def:15304"/>
        <extend_definition comment="Microsoft Commerce Server 2007 is installed" definition_ref="oval:org.mitre.oval:def:15514"/>
        <extend_definition comment="Microsoft Commerce Server 2009 is installed" definition_ref="oval:org.mitre.oval:def:15443"/>
        <extend_definition comment="Microsoft Visual FoxPro is installed" definition_ref="oval:org.mitre.oval:def:14198"/>
        <extend_definition comment="Microsoft Visual Basic 6.0 is installed" definition_ref="oval:org.mitre.oval:def:15369"/>
      </criteria>
      <criterion comment="Mscomctl.Ocx version is less than 6.01.98.33" test_ref="oval:org.mitre.oval:tst:79815"/>
    </criteria>
    <criteria operator="AND" comment="Microsoft SQL Server 2000 Analysis Services Service">
      <extend_definition comment="Microsoft SQL Server 2000 Analysis Services SP4 is installed" definition_ref="oval:org.mitre.oval:def:15730"/>
      <criterion comment="The version of Msmdsrv.exe is less than 8.0.2302.0" test_ref="oval:org.mitre.oval:tst:78982"/>
    </criteria>
    <criteria operator="AND" comment="SQL Server 2000 SP4 32-bit editions">
      <extend_definition comment="Microsoft SQL Server 2000 SP4 is installed" definition_ref="oval:org.mitre.oval:def:15762"/>
      <criteria operator="OR" comment="GDR or QFE Service branch">
        <criterion comment="the version of sqlservr.exe is less than 2000.80.2065.0" test_ref="oval:org.mitre.oval:tst:79697"/>
        <criteria operator="AND" comment="QFE">
          <criterion comment="SQL Server 2000 QFE - the version of sqlservr.exe is greater than 2000.80.2200.0" test_ref="oval:org.mitre.oval:tst:79589"/>
          <criterion comment="the version of sqlservr.exe is less than 2000.80.2301.0" test_ref="oval:org.mitre.oval:tst:79594"/>
        </criteria>
      </criteria>
    </criteria>
  </criteria>
</definition>