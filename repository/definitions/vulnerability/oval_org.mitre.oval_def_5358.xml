<?xml version="1.0" encoding="UTF-8"?>
<definition id="oval:org.mitre.oval:def:5358" version="3" class="vulnerability" xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:oval="http://oval.mitre.org/XMLSchema/oval-common-5" xmlns:oval-def="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <metadata>
    <title>VMware Tools Input Validation Flaw in Windows Guest OS Lets Local Users Gain Elevated Privileges</title>
    <affected family="unix">
      <platform>VMWare ESX Server 3</platform>
      <platform>VMWare ESX Server 2</platform>
    </affected>
    <reference source="CVE" ref_id="CVE-2007-5671" ref_url="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-5671"/>
    <description>HGFS.sys in the VMware Tools package in VMware Workstation 5.x before 5.5.6 build 80404, VMware Player before 1.0.6 build 80404, VMware ACE before 1.0.5 build 79846, VMware Server before 1.0.5 build 80187, and VMware ESX 2.5.4 through 3.0.2 does not properly validate arguments in user-mode METHOD_NEITHER IOCTLs to the \\.\hgfs device, which allows guest OS users to modify arbitrary memory locations in guest kernel memory and gain privileges.</description>
    <oval_repository>
      <dates>
        <submitted date="2008-06-10T15:10:44.000-05:00">
          <contributor organization="Hewlett-Packard">Michael Wood</contributor>
        </submitted>
        <status_change date="2008-06-16T18:08:12.690-04:00">DRAFT</status_change>
        <status_change date="2008-07-07T04:00:21.390-04:00">INTERIM</status_change>
        <status_change date="2008-07-28T04:00:11.564-04:00">ACCEPTED</status_change>
        <modified comment="Changed referenced definition from deprecated def:5230 to def:5613" date="2010-04-16T18:34:00.020-04:00">
          <contributor organization="DTCC">J. Daniel Brown</contributor>
        </modified>
        <status_change date="2010-04-16T18:36:12.151-04:00">INTERIM</status_change>
        <status_change date="2010-05-17T04:00:02.929-04:00">ACCEPTED</status_change>
      </dates>
      <status>ACCEPTED</status>
      <min_schema_version>5.4</min_schema_version>
    </oval_repository>
  </metadata>
  <criteria operator="OR">
    <criteria operator="AND" comment="VMWare ESX Server 3.0.2 meets CVE-2007-5671">
      <extend_definition comment="VMWare ESX Server 3.0.2 is installed" definition_ref="oval:org.mitre.oval:def:5613"/>
      <criteria operator="OR" comment="All patches must be installed to not be vulnerable">
        <criterion comment="Patch ESX-1004727 is not installed" test_ref="oval:org.mitre.oval:tst:7967"/>
        <criterion comment="Patch ESX-1004821 is not installed" test_ref="oval:org.mitre.oval:tst:8090"/>
        <criterion comment="Patch ESX-1004216 is not installed" test_ref="oval:org.mitre.oval:tst:7844"/>
        <criterion comment="Patch ESX-1004726 is not installed" test_ref="oval:org.mitre.oval:tst:7991"/>
        <criterion comment="Patch ESX-1004722 is not installed" test_ref="oval:org.mitre.oval:tst:7927"/>
        <criterion comment="Patch ESX-1004724 is not installed" test_ref="oval:org.mitre.oval:tst:7166"/>
        <criterion comment="Patch ESX-1004719 is not installed" test_ref="oval:org.mitre.oval:tst:7593"/>
        <criterion comment="Patch ESX-1004219 is not installed" test_ref="oval:org.mitre.oval:tst:7865"/>
      </criteria>
    </criteria>
    <criteria operator="AND" comment="VMWare ESX Server 3.0.1 meets CVE-2007-5671">
      <extend_definition comment="VMWare ESX Server 3.0.1 is installed" definition_ref="oval:org.mitre.oval:def:5367"/>
      <criteria operator="OR" comment="All patches must be installed to not be vulnerable">
        <criterion comment="Patch ESX-1004186 is not installed" test_ref="oval:org.mitre.oval:tst:8077"/>
        <criterion comment="Patch ESX-1004728 is not installed" test_ref="oval:org.mitre.oval:tst:7762"/>
        <criterion comment="Patch ESX-1004725 is not installed" test_ref="oval:org.mitre.oval:tst:7898"/>
        <criterion comment="Patch ESX-1004721 is not installed" test_ref="oval:org.mitre.oval:tst:7214"/>
        <criterion comment="Patch ESX-1004723 is not installed" test_ref="oval:org.mitre.oval:tst:8030"/>
        <criterion comment="Patch ESX-1004190 is not installed" test_ref="oval:org.mitre.oval:tst:8095"/>
        <criterion comment="Patch ESX-1004189 is not installed" test_ref="oval:org.mitre.oval:tst:8110"/>
      </criteria>
    </criteria>
    <criteria operator="AND" comment="VMWare ESX Server 2.5.5 meets CVE-2007-5671">
      <criterion comment="VMWare ESX Server 2.5.5 build 57619 or higher is installed" test_ref="oval:org.mitre.oval:tst:7790"/>
      <criterion comment="VMWare ESX Server 2.5.5 upgrade patch 8 is not installed" test_ref="oval:org.mitre.oval:tst:7168"/>
    </criteria>
    <criteria operator="AND" comment="VMWare ESX Server 2.5.4 meets CVE-2007-5671">
      <criterion comment="VMWare ESX Server 2.5.4 build 32233 or higher is installed" test_ref="oval:org.mitre.oval:tst:7933"/>
      <criterion comment="VMWare ESX Server 2.5.4 upgrade patch 19 is not installed" test_ref="oval:org.mitre.oval:tst:7998"/>
    </criteria>
  </criteria>
</definition>