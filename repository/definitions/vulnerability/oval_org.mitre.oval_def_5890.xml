<definition xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5" class="vulnerability" id="oval:org.mitre.oval:def:5890" version="81">
  <metadata>
    <title>LSASS Recursive Stack Overflow Vulnerability</title>
    <affected family="windows">
      <platform>Microsoft Windows XP</platform>
      <platform>Microsoft Windows 2000</platform>
      <platform>Microsoft Windows Server 2003</platform>
      <platform>Microsoft Windows Server 2008</platform>
    </affected>
    <reference ref_id="CVE-2009-1928" ref_url="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-1928" source="CVE" />
    <description>Stack consumption vulnerability in the LDAP service in Active Directory on Microsoft Windows 2000 SP4, Server 2003 SP2, and Server 2008 Gold and SP2; Active Directory Application Mode (ADAM) on Windows XP SP2 and SP3 and Server 2003 SP2; and Active Directory Lightweight Directory Service (AD LDS) on Windows Server 2008 Gold and SP2 allows remote attackers to cause a denial of service (system hang) via a malformed (1) LDAP or (2) LDAPS request, aka "LSASS Recursive Stack Overflow Vulnerability."</description>
    <oval_repository>
      <dates>
        <submitted date="2009-11-10T13:00:00">
          <contributor organization="Gideon Technologies, Inc.">Dragos Prisaca</contributor>
        </submitted>
        <status_change date="2009-11-12T15:32:32.104-05:00">DRAFT</status_change>
        <status_change date="2009-11-30T04:00:13.755-05:00">INTERIM</status_change>
        <status_change date="2009-12-21T04:00:42.176-05:00">ACCEPTED</status_change>
        <modified comment="EDITED oval:org.mitre.oval:obj:5285 - obj:5285 is pointing to windows\system32 directory. But, adamdsa.dll file by default will be in windows\ADAM directory" date="2011-07-14T10:24:00.833-04:00">
          <contributor organization="SecPod Technologies">Sharath S</contributor>
        </modified>
        <status_change date="2011-07-14T10:26:46.362-04:00">INTERIM</status_change>
        <status_change date="2011-08-01T04:00:56.259-04:00">ACCEPTED</status_change>
        <modified comment="EDITED oval:org.mitre.oval:def:5890 - def:5890 - &quot;Added Microsoft Windows Server 2003 SP2 itanium criteria.&quot;" date="2011-10-27T10:15:00.814-04:00">
          <contributor organization="SecPod Technologies">Rachana Shetty</contributor>
        </modified>
        <status_change date="2011-10-27T10:17:33.916-04:00">INTERIM</status_change>
        <status_change date="2011-11-14T04:00:49.430-05:00">ACCEPTED</status_change>
        <modified comment="EDITED oval:org.mitre.oval:def:5890 - modified vulnerabilities which check the version of file adamdsa.dll" date="2013-12-18T16:36:00.218-05:00">
          <contributor organization="ALTX-SOFT">Maria Kedovskaya</contributor>
        </modified>
        <status_change date="2013-12-18T16:44:40.876-05:00">INTERIM</status_change>
        <status_change date="2014-01-06T04:00:47.950-05:00">ACCEPTED</status_change>
        <modified comment="EDITED oval:org.mitre.oval:tst:89195 - bulletin MS14-016, for the month of Mar 2014." date="2014-03-18T14:40:00.553-04:00">
          <contributor organization="SecPod Technologies">Pooja Shetty</contributor>
        </modified>
        <status_change date="2014-03-18T14:42:04.593-04:00">INTERIM</status_change>
        <status_change date="2014-04-07T04:06:55.345-04:00">ACCEPTED</status_change>
      </dates>
      <status>ACCEPTED</status>
      <min_schema_version>5.10</min_schema_version>
    </oval_repository>
  </metadata>
  <criteria operator="OR">
    <criteria comment="Check for Windows 2000 and Vulnerable file" operator="AND">
      <extend_definition comment="Microsoft Windows 2000 SP4 or later is installed" definition_ref="oval:org.mitre.oval:def:229" />
      <criterion comment="NTDS Service is installed" test_ref="oval:org.mitre.oval:tst:42615" />
      <criterion comment="Ntdsa.dll version is less than 5.0.2195.7313" test_ref="oval:org.mitre.oval:tst:10398" />
      <criterion comment="the system is being used as AD - DomainRole is 4 or 5" test_ref="oval:org.mitre.oval:tst:10696" />
    </criteria>
    <criteria comment="Check for Vulnerable OS and file" operator="AND">
      <criteria comment="Check for Windows 2003 (x86/x64)" operator="OR">
        <extend_definition comment="Microsoft Windows Server 2003 SP2 (x86) is installed" definition_ref="oval:org.mitre.oval:def:1935" />
        <extend_definition comment="Microsoft Windows Server 2003 SP2 (x64) is installed" definition_ref="oval:org.mitre.oval:def:2161" />
      </criteria>
      <criteria comment="Active Directory or ADAM" operator="OR">
        <criteria comment="Check for Vulnerable file" operator="AND">
          <criterion comment="NTDS Service is installed" test_ref="oval:org.mitre.oval:tst:42615" />
          <criterion comment="the system is being used as AD - DomainRole is 4 or 5" test_ref="oval:org.mitre.oval:tst:10696" />
          <criterion comment="ntdsa.dll version is less than 5.2.3790.4568" test_ref="oval:org.mitre.oval:tst:11019" />
        </criteria>
        <criteria comment="Vulnerable ADAM" operator="AND">
          <criterion comment="Check if ADAM service is installed" test_ref="oval:org.mitre.oval:tst:89195" />
          <criterion comment="adamdsa.dll version is less than 1.1.3790.4569" test_ref="oval:org.mitre.oval:tst:10537" />
        </criteria>
      </criteria>
    </criteria>
    <criteria comment="Check for Windows 2003 (ia64) and Vulnerable file" operator="AND">
      <extend_definition comment="Microsoft Windows Server 2003 (ia64) SP2 is installed" definition_ref="oval:org.mitre.oval:def:1442" />
      <criterion comment="NTDS Service is installed" test_ref="oval:org.mitre.oval:tst:42615" />
      <criterion comment="the system is being used as AD - DomainRole is 4 or 5" test_ref="oval:org.mitre.oval:tst:10696" />
      <criterion comment="ntdsa.dll version is less than 5.2.3790.4568" test_ref="oval:org.mitre.oval:tst:11019" />
    </criteria>
    <criteria comment="Check for Vulnerable OS and file" operator="AND">
      <criteria comment="Check for Windows XP (x86/x64)" operator="OR">
        <extend_definition comment="Microsoft Windows XP (x86) SP2 is installed" definition_ref="oval:org.mitre.oval:def:754" />
        <extend_definition comment="Microsoft Windows XP (x86) SP3 is installed" definition_ref="oval:org.mitre.oval:def:5631" />
        <extend_definition comment="Microsoft Windows XP x64 Edition SP2 is installed" definition_ref="oval:org.mitre.oval:def:4193" />
      </criteria>
      <criterion comment="Check if ADAM service is installed" test_ref="oval:org.mitre.oval:tst:89195" />
      <criterion comment="adamdsa.dll version is less than 1.1.3790.4569" test_ref="oval:org.mitre.oval:tst:10537" />
    </criteria>
    <criteria comment="Check for Vulnerable OS and file" operator="AND">
      <criteria comment="Check for Windows 2008 (x86/x64)" operator="OR">
        <extend_definition comment="Microsoft Windows Server 2008 (32-bit) is installed" definition_ref="oval:org.mitre.oval:def:4870" />
        <extend_definition comment="Microsoft Windows Server 2008 (64-bit) is installed" definition_ref="oval:org.mitre.oval:def:5356" />
      </criteria>
      <criteria comment="Check for Domain Role and vulnerable file" operator="AND">
        <criterion comment="the system is being used as AD - DomainRole is 4 or 5" test_ref="oval:org.mitre.oval:tst:10696" />
        <criteria comment="Check for file GDR or LDR" operator="OR">
          <criterion comment="ntdsai.dll version is less than 6.0.6001.18281" test_ref="oval:org.mitre.oval:tst:10858" />
          <criteria comment="Check for LDR" operator="AND">
            <criterion comment="ntdsai.dll version is less than 6.0.6001.22461" test_ref="oval:org.mitre.oval:tst:11031" />
            <criterion comment="ntdsai.dll is greater than or equal 6.0.6001.22000" test_ref="oval:org.mitre.oval:tst:10907" />
          </criteria>
        </criteria>
      </criteria>
    </criteria>
    <criteria comment="Check for Vulnerable OS and file" operator="AND">
      <criteria comment="Check for Windows 2008 (x86/x64) SP2" operator="OR">
        <extend_definition comment="Microsoft Windows Server 2008 (32-bit) Service Pack 2 is installed" definition_ref="oval:org.mitre.oval:def:5653" />
        <extend_definition comment="Microsoft Windows Server 2008 x64 Edition Service Pack 2 is installed" definition_ref="oval:org.mitre.oval:def:6216" />
      </criteria>
      <criteria comment="Check for Domain Role and vulnerable file" operator="AND">
        <criterion comment="the system is being used as AD - DomainRole is 4 or 5" test_ref="oval:org.mitre.oval:tst:10696" />
        <criteria comment="Check for file GDR or LDR" operator="OR">
          <criterion comment="ntdsai.dll version is less than 6.0.6002.18058" test_ref="oval:org.mitre.oval:tst:11092" />
          <criteria comment="Check for LDR" operator="AND">
            <criterion comment="ntdsai.dll version is less than 6.0.6002.22162" test_ref="oval:org.mitre.oval:tst:10845" />
            <criterion comment="ntdsai.dll is greater than or equal 6.0.6002.22000" test_ref="oval:org.mitre.oval:tst:10980" />
          </criteria>
        </criteria>
      </criteria>
    </criteria>
  </criteria>
</definition>
