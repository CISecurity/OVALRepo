<definition xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5" class="vulnerability" id="oval:org.mitre.oval:def:5881" version="19">
  <metadata>
    <title>GDI+ BMP Integer Overflow Vulnerability</title>
    <affected family="windows">
      <platform>Microsoft Windows 2000</platform>
      <platform>Microsoft Windows XP</platform>
      <platform>Microsoft Windows Server 2003</platform>
      <platform>Microsoft Windows Vista</platform>
      <platform>Microsoft Windows Server 2008</platform>
      <product>Microsoft Office 2003</product>
      <product>Microsoft Office 2007</product>
      <product>Microsoft Office Visio 2002</product>
      <product>Microsoft Office XP</product>
      <product>Microsoft PowerPoint Viewer</product>
      <product>Microsoft SQL Server 2005</product>
    </affected>
    <reference ref_id="CVE-2008-3015" ref_url="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-3015" source="CVE" />
    <description>Integer overflow in gdiplus.dll in GDI+ in Microsoft Office XP SP3, Office 2003 SP2 and SP3, 2007 Microsoft Office System Gold and SP1, Visio 2002 SP2, PowerPoint Viewer 2003, Works 8, Digital Image Suite 2006, SQL Server 2000 Reporting Services SP2, SQL Server 2005 SP2, Report Viewer 2005 SP1 and 2008, and Forefront Client Security 1.0 allows remote attackers to execute arbitrary code via a BMP image file with a malformed BitMapInfoHeader that triggers a buffer overflow, aka "GDI+ BMP Integer Overflow Vulnerability."</description>
    <oval_repository>
      <dates>
        <submitted date="2008-09-09T13:58:00">
          <contributor organization="Secure Elements, Inc.">Sudhir Gandhe</contributor>
        </submitted>
        <status_change date="2008-09-12T12:49:06.488-04:00">DRAFT</status_change>
        <status_change date="2008-09-29T04:00:47.054-04:00">INTERIM</status_change>
        <status_change date="2008-10-20T04:00:24.376-04:00">ACCEPTED</status_change>
        <modified comment="Changed product &quot;Office 2002&quot; to &quot;Office XP&quot;" date="2010-01-14T15:49:00.152-05:00">
          <contributor organization="The MITRE Corporation">Mike Lah</contributor>
        </modified>
        <status_change date="2010-01-14T15:49:21.160-05:00">INTERIM</status_change>
        <status_change date="2010-02-01T04:00:13.923-05:00">ACCEPTED</status_change>
        <modified comment="EDITED oval:org.mitre.oval:def:5881 - Added LDR support for WinVista and Win2008, MSSQL 2005 SP2 inclusion &amp; updated version in ste:4158" date="2011-12-05T13:24:00.281-05:00">
          <contributor organization="SecPod Technologies">Pradeep R B</contributor>
        </modified>
        <status_change date="2011-12-05T13:29:05.296-05:00">INTERIM</status_change>
        <status_change date="2011-12-26T04:02:50.026-05:00">ACCEPTED</status_change>
        <modified comment="EDITED oval:org.mitre.oval:obj:12103 - Fixed several false positives by setting negate = true.  Also fixed several style issues." date="2011-12-28T21:13:00.551-05:00">
          <contributor organization="Symantec Corporation">Dragos Prisaca</contributor>
        </modified>
        <status_change date="2011-12-28T21:21:37.424-05:00">INTERIM</status_change>
        <status_change date="2012-01-16T04:03:03.906-05:00">ACCEPTED</status_change>
        <modified comment="EDITED oval:org.mitre.oval:obj:309 - New Microsoft Patch Tuesday May 2012 definitions." date="2012-05-18T15:40:00.554-04:00">
          <contributor organization="Symantec Corporation">Josh Turpin</contributor>
        </modified>
        <status_change date="2012-05-18T15:47:34.306-04:00">INTERIM</status_change>
        <status_change date="2012-06-04T04:01:43.471-04:00">ACCEPTED</status_change>
        <modified comment="EDITED oval:org.mitre.oval:def:5881 - Fixed Definitions with missing platforms." date="2012-12-12T17:14:00.907-05:00">
          <contributor organization="SecPod Technologies">Chandan S</contributor>
        </modified>
        <status_change date="2012-12-12T17:21:16.223-05:00">INTERIM</status_change>
        <status_change date="2012-12-31T04:02:08.837-05:00">ACCEPTED</status_change>
        <modified comment="EDITED oval:org.mitre.oval:obj:12081 - string var_check=&quot;all&quot; was replaced with var_check=&quot;at least one&quot;" date="2013-09-19T17:46:00.990-04:00">
          <contributor organization="ALTX-SOFT">Maria Kedovskaya</contributor>
        </modified>
        <status_change date="2013-09-19T17:49:07.747-04:00">INTERIM</status_change>
        <status_change date="2013-10-07T04:11:42.430-04:00">ACCEPTED</status_change>
        <modified comment="EDITED oval:org.mitre.oval:obj:309 - Modified criteria to match MS bulletin" date="2014-06-13T14:52:00.642-04:00">
          <contributor organization="ALTX-SOFT">Maria Mikhno</contributor>
        </modified>
        <status_change date="2014-06-13T14:56:02.983-04:00">INTERIM</status_change>
        <status_change date="2014-06-30T04:11:08.854-04:00">ACCEPTED</status_change>
      </dates>
      <status>ACCEPTED</status>
      <min_schema_version>5.10</min_schema_version>
    </oval_repository>
  </metadata>
  <criteria operator="OR">
    <criteria comment="Vulnerable Office XP" operator="AND">
      <extend_definition comment="Microsoft Office XP is installed" definition_ref="oval:org.mitre.oval:def:663" />
      <criterion comment="Mso.dll version is less than 10.0.6844.0" test_ref="oval:org.mitre.oval:tst:9255" />
    </criteria>
    <criteria comment="Vulnerable Office 2003" operator="AND">
      <extend_definition comment="Microsoft Office 2003 is installed" definition_ref="oval:org.mitre.oval:def:233" />
      <criterion comment="GDIPlus.dll version is less than 11.0.8230.0" test_ref="oval:org.mitre.oval:tst:9205" />
    </criteria>
    <criteria comment="Vulnerable Office 2007" operator="AND">
      <extend_definition comment="Microsoft Office 2007 is installed" definition_ref="oval:org.mitre.oval:def:1211" />
      <criterion comment="Ogl.dll version is less than 12.0.6325.5000" test_ref="oval:org.mitre.oval:tst:9231" />
    </criteria>
    <criteria comment="Vulnerable Office Visio 2002 SP2" operator="AND">
      <extend_definition comment="Microsoft Office Visio 2002 SP2 is installed" definition_ref="oval:org.mitre.oval:def:692" />
      <criterion comment="Mso.dll version is less than 10.0.6844.0" test_ref="oval:org.mitre.oval:tst:9255" />
    </criteria>
    <criteria comment="Vulnerable PowerPoint Viewer" operator="AND">
      <extend_definition comment="Microsoft PowerPoint Viewer is installed" definition_ref="oval:org.mitre.oval:def:6014" />
      <criterion comment="GDIPlus.dll version is less than 11.0.8230.0" test_ref="oval:org.mitre.oval:tst:9205" />
    </criteria>
    <criteria comment="Vulnerable SQL Server 2005 SP2" operator="AND">
      <criteria comment="SQL Server 2005 SP2" operator="OR">
        <criteria comment="SQL Server 2005 SP2" operator="AND">
          <extend_definition comment="Microsoft SQL Server 2005 is installed" definition_ref="oval:org.mitre.oval:def:6082" />
          <criterion comment="HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Microsoft SQL Server\90\DTS\Setup\\SP equals 2" test_ref="oval:org.mitre.oval:tst:9558" />
        </criteria>
        <extend_definition comment="Microsoft SQL Server 2005 SP2 is installed" definition_ref="oval:org.mitre.oval:def:8397" />
      </criteria>
      <criteria comment="Vulnerable version of SP2 or hotfix" operator="OR">
        <criterion comment="Check if version of Sqlservr.exe is less than 2005.90.3073.0 (GDR)" test_ref="oval:org.mitre.oval:tst:77831" />
        <criterion comment="Check if version of Sqlwb.exe is less than 2005.90.3282.0 (Hotfix/QFE)" test_ref="oval:org.mitre.oval:tst:77584" />
      </criteria>
    </criteria>
  </criteria>
</definition>
