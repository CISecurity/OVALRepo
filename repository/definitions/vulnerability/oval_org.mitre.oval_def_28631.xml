<definition xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5" class="vulnerability" id="oval:org.mitre.oval:def:28631" version="29">
  <metadata>
    <title>Microsoft office component use after free vulnerability - CVE-2015-0085 (MS15-022)</title>
    <affected family="windows">
      <platform>Microsoft Windows Server 2003</platform>
      <platform>Microsoft Windows Vista</platform>
      <platform>Microsoft Windows Server 2008</platform>
      <platform>Microsoft Windows 7</platform>
      <platform>Microsoft Windows Server 2008 R2</platform>
      <platform>Microsoft Windows 8</platform>
      <platform>Microsoft Windows 8.1</platform>
      <platform>Microsoft Windows Server 2012</platform>
      <platform>Microsoft Windows Server 2012 R2</platform>
      <product>Microsoft Excel 2007</product>
      <product>Microsoft Excel 2010</product>
      <product>Microsoft Excel Viewer 2007</product>
      <product>Microsoft Office 2007</product>
      <product>Microsoft Office 2010</product>
      <product>Microsoft Office 2013</product>
      <product>Microsoft Office Compatibility Pack</product>
      <product>Microsoft Office Web Apps 2010</product>
      <product>Microsoft Office Web Apps Server 2013</product>
      <product>Microsoft PowerPoint 2007</product>
      <product>Microsoft PowerPoint 2010</product>
      <product>Microsoft SharePoint Foundation 2010</product>
      <product>Microsoft SharePoint Foundation 2013</product>
      <product>Microsoft SharePoint Server 2007</product>
      <product>Microsoft SharePoint Server 2010</product>
      <product>Microsoft SharePoint Server 2013</product>
      <product>Microsoft SharePoint Services 3.0</product>
      <product>Microsoft Word 2007</product>
      <product>Microsoft Word 2010</product>
      <product>Microsoft Word 2013</product>
    </affected>
    <reference ref_id="CVE-2015-0085" ref_url="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-0085" source="CVE" />
    <description>Use-after-free vulnerability in Microsoft Office 2007 SP3, Excel 2007 SP3, PowerPoint 2007 SP3, Word 2007 SP3, Office 2010 SP2, Excel 2010 SP2, PowerPoint 2010 SP2, Word 2010 SP2, Office 2013 Gold and SP1, Word 2013 Gold and SP1, Office 2013 RT Gold and SP1, Word 2013 RT Gold and SP1, Excel Viewer, Office Compatibility Pack SP3, Word Automation Services on SharePoint Server 2010 SP2, Excel Services on SharePoint Server 2013 Gold and SP1, Word Automation Services on SharePoint Server 2013 Gold and SP1, Web Applications 2010 SP2, Office Web Apps Server 2010 SP2, Web Apps Server 2013 Gold and SP1, SharePoint Server 2007 SP3, Windows SharePoint Services 3.0 SP3, SharePoint Foundation 2010 SP2, SharePoint Server 2010 SP2, SharePoint Foundation 2013 Gold and SP1, and SharePoint Server 2013 Gold and SP1 allows remote attackers to execute arbitrary code via a crafted Office document, aka "Microsoft Office Component Use After Free Vulnerability."</description>
    <oval_repository>
      <dates>
        <submitted date="2015-03-17T17:47:04">
          <contributor organization="SecPod Technologies">SecPod Team</contributor>
        </submitted>
        <status_change date="2015-03-18T10:00:02.801-04:00">DRAFT</status_change>
        <status_change date="2015-04-06T04:00:10.403-04:00">INTERIM</status_change>
        <status_change date="2015-04-27T04:00:18.230-04:00">ACCEPTED</status_change>
        <modified comment="EDITED oval:org.mitre.oval:var:1569 - MS Bulletins - May 2015" date="2015-05-28T14:06:00.511-04:00">
          <contributor organization="SecPod Technologies">Kumarswamy S</contributor>
        </modified>
        <status_change date="2015-05-28T14:09:56.374-04:00">INTERIM</status_change>
        <status_change date="2015-06-15T04:00:19.971-04:00">ACCEPTED</status_change>
      </dates>
      <status>ACCEPTED</status>
      <min_schema_version>5.10</min_schema_version>
    </oval_repository>
  </metadata>
  <criteria operator="OR">
    <criteria comment="Office 2007 and vulnerable file version" operator="AND">
      <extend_definition comment="Microsoft Office 2007 is installed" definition_ref="oval:org.mitre.oval:def:1211" />
      <criterion comment="Check if the version of mso.dll is less than 12.0.6718.5000" test_ref="oval:org.mitre.oval:tst:138001" />
    </criteria>
    <criteria comment="Excel 2007 and vulnerable file version" operator="AND">
      <extend_definition comment="Microsoft Excel 2007 is installed" definition_ref="oval:org.mitre.oval:def:1745" />
      <criterion comment="Check if the version of excel.exe is less than 12.0.6718.5000" test_ref="oval:org.mitre.oval:tst:138267" />
    </criteria>
    <criteria comment="Powerpoint 2007 and vulnerable file version" operator="AND">
      <extend_definition comment="Microsoft PowerPoint 2007 is installed" definition_ref="oval:org.mitre.oval:def:5937" />
      <criterion comment="Check if the version of ppcore.dll is less than 12.0.6718.5000" test_ref="oval:org.mitre.oval:tst:137963" />
    </criteria>
    <criteria comment="Word 2007 and vulnerable file version" operator="AND">
      <extend_definition comment="Microsoft Word 2007 is installed" definition_ref="oval:org.mitre.oval:def:2074" />
      <criterion comment="Check if the version of winword.exe is less than 12.0.6718.5000" test_ref="oval:org.mitre.oval:tst:138427" />
    </criteria>
    <criteria comment="Office 2010 and vulnerable file version" operator="AND">
      <extend_definition comment="Microsoft Office 2010 is installed" definition_ref="oval:org.mitre.oval:def:12061" />
      <criteria comment="Check for vulnerable versions" operator="OR">
        <criterion comment="Check if the version of mso.dll is less than 14.0.7145.5000" test_ref="oval:org.mitre.oval:tst:138142" />
        <criterion comment="Check if the version of oart.dll is less than 14.0.7134.5000" test_ref="oval:org.mitre.oval:tst:137799" />
        <criterion comment="Check if the version of oartconv.dll is less than 14.0.7134.5000" test_ref="oval:org.mitre.oval:tst:138129" />
      </criteria>
    </criteria>
    <criteria comment="Excel 2010 and vulnerable file version" operator="AND">
      <extend_definition comment="Microsoft Excel 2010 is installed" definition_ref="oval:org.mitre.oval:def:12658" />
      <criterion comment="Check if the version of excel.exe is less than 14.0.7145.5001" test_ref="oval:org.mitre.oval:tst:138349" />
    </criteria>
    <criteria comment="Powerpoint 2010 and vulnerable file version" operator="AND">
      <extend_definition comment="Microsoft PowerPoint 2010 is installed" definition_ref="oval:org.mitre.oval:def:12376" />
      <criterion comment="Check if the version of ppcore.dll is less than 14.0.7145.5001" test_ref="oval:org.mitre.oval:tst:138204" />
    </criteria>
    <criteria comment="Word 2010 and vulnerable file version" operator="AND">
      <extend_definition comment="Microsoft Word 2010 is installed" definition_ref="oval:org.mitre.oval:def:7631" />
      <criterion comment="Check if the version of winword.exe is less than 14.0.7145.5001" test_ref="oval:org.mitre.oval:tst:138219" />
    </criteria>
    <criteria comment="Word 2013  and vulnerable file version" operator="AND">
      <extend_definition comment="Microsoft Word 2013 is installed" definition_ref="oval:org.mitre.oval:def:15560" />
      <criterion comment="Check if the version of winword.exe is less than 15.0.4701.1001" test_ref="oval:org.mitre.oval:tst:138394" />
    </criteria>
    <criteria comment="Excel Viewer and vulnerable file version" operator="AND">
      <extend_definition comment="Microsoft Excel Viewer 2007 is installed" definition_ref="oval:org.mitre.oval:def:6006" />
      <criterion comment="Check if the version of xlview.exe is less than 12.0.6717.5000" test_ref="oval:org.mitre.oval:tst:137955" />
    </criteria>
    <criteria comment="Office Compatibility Pack 2007 and vulnerable version" operator="AND">
      <extend_definition comment="Microsoft Office Compatibility Pack is installed" definition_ref="oval:org.mitre.oval:def:1853" />
      <criteria comment="Check for vulnerable versions" operator="OR">
        <criterion comment="Check if the version of wordcnv.dll is less than 12.0.6717.5000" test_ref="oval:org.mitre.oval:tst:138291" />
        <criterion comment="Check if the version of excelcnv.exe is less than 12.0.6717.5000" test_ref="oval:org.mitre.oval:tst:138030" />
      </criteria>
    </criteria>
    <criteria comment="Sharepoint Server 2010 and vulnerable file version" operator="AND">
      <extend_definition comment="Microsoft Office SharePoint Server 2010 is installed." definition_ref="oval:org.mitre.oval:def:12880" />
      <criterion comment="Check if the version of msoserver.dll is less than 14.0.7145.5000" test_ref="oval:org.mitre.oval:tst:138365" />
    </criteria>
    <criteria comment="Office Web Apps 2010 and vulnerable file version" operator="AND">
      <extend_definition comment="Microsoft Office Web Apps 2010 is installed" definition_ref="oval:org.mitre.oval:def:15787" />
      <criterion comment="Check if the version of msoserver.dll is less than 14.0.7145.5000" test_ref="oval:org.mitre.oval:tst:137599" />
    </criteria>
    <criteria comment="Office Web Apps 2013 and vulnerable file version" operator="AND">
      <extend_definition comment="Microsoft Office Web Apps Server 2013 is installed" definition_ref="oval:org.mitre.oval:def:22312" />
      <criterion comment="Check if the version of msoserver.dll is less than 15.0.4701.1000" test_ref="oval:org.mitre.oval:tst:137966" />
    </criteria>
    <criteria comment="Sharepoint Foundation Server 2013 and vulnerable file version" operator="AND">
      <extend_definition comment="Microsoft SharePoint Foundation 2013 is installed" definition_ref="oval:org.mitre.oval:def:19090" />
      <criterion comment="Check if the version of stswel.dll is less than 15.0.4701.1000" test_ref="oval:org.mitre.oval:tst:138170" />
    </criteria>
    <criteria comment="Sharepoint Server 2013 and vulnerable file version" operator="AND">
      <extend_definition comment="Microsoft SharePoint Server 2013 is installed" definition_ref="oval:org.mitre.oval:def:16325" />
      <criteria comment="Check for vulnerable versions" operator="OR">
        <criterion comment="Check if the version of xlsrv.dll is less than 15.0.4701.1000" test_ref="oval:org.mitre.oval:tst:138254" />
        <criterion comment="Check if the version of wwintl.dll is less than 15.0.4631.1000" test_ref="oval:org.mitre.oval:tst:138441" />
        <criterion comment="Check if the version of vutils.dll is less than 15.0.4701.1000" test_ref="oval:org.mitre.oval:tst:138393" />
        <criterion comment="Check if the version of microsoft.office.infopath.server.dll is less than 15.0.4701.1000" test_ref="oval:org.mitre.oval:tst:138339" />
        <criterion comment="Check if the version of ascalc.dll is less than 15.0.4699.1000" test_ref="oval:org.mitre.oval:tst:138351" />
        <criterion comment="Check if the version of msoserverintl.dll is less than 15.0.4697.1000" test_ref="oval:org.mitre.oval:tst:138449" />
      </criteria>
    </criteria>
    <criteria comment="Sharepoint Server 2007 and Services 3.0 and vulnerable file version" operator="AND">
      <criteria comment="Sharepoint Server 2007/Sharepoint Services 3.0" operator="OR">
        <extend_definition comment="Microsoft Office SharePoint Server 2007 is installed." definition_ref="oval:org.mitre.oval:def:2313" />
        <extend_definition comment="Microsoft Windows SharePoint Services 3.0 is installed" definition_ref="oval:org.mitre.oval:def:15189" />
      </criteria>
      <criterion comment="Check if the version of offparser.dll is less than 12.0.6717.5000" test_ref="oval:org.mitre.oval:tst:138422" />
    </criteria>
    <criteria comment="Office 2013 and vulnerable file version" operator="AND">
      <extend_definition comment="Microsoft Office 2013 is installed" definition_ref="oval:org.mitre.oval:def:15381" />
      <criterion comment="Check if the version of msores.dll is less than 15.0.4697.1000" test_ref="oval:org.mitre.oval:tst:137996" />
    </criteria>
    <criteria comment="Sharepoint Foundation Server 2010 and vulnerable file version" operator="AND">
      <extend_definition comment="Microsoft SharePoint Foundation 2010 is installed" definition_ref="oval:org.mitre.oval:def:12224" />
      <criterion comment="Check if the version of onetutil.dll is less than 14.0.7145.5000" test_ref="oval:org.mitre.oval:tst:138454" />
    </criteria>
  </criteria>
</definition>
