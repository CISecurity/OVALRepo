<?xml version="1.0" encoding="UTF-8"?>
<definition id="oval:org.mitre.oval:def:5794" version="5" class="vulnerability">
  <metadata>
    <title>Masked Edit Control Memory Corruption Vulnerability</title>
    <affected family="windows">
      <platform>Microsoft Windows 2000</platform>
      <platform>Microsoft Windows Server 2003</platform>
      <platform>Microsoft Windows Server 2008</platform>
      <platform>Microsoft Windows Vista</platform>
      <platform>Microsoft Windows XP</platform>
      <product>Microsoft Visual Basic 6.0</product>
      <product>Microsoft Visual FoxPro</product>
      <product>Microsoft Visual Studio .NET 2002</product>
      <product>Microsoft Visual Studio .NET 2003</product>
    </affected>
    <reference source="CVE" ref_id="CVE-2008-3704" ref_url="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-3704"/>
    <description>Heap-based buffer overflow in the MaskedEdit ActiveX control in Msmask32.ocx 6.0.81.69, and possibly other versions before 6.0.84.18, in Microsoft Visual Studio 6.0, Visual Basic 6.0, Visual Studio .NET 2002 SP1 and 2003 SP1, and Visual FoxPro 8.0 SP1 and 9.0 SP1 and SP2 allows remote attackers to execute arbitrary code via a long Mask parameter, related to not "validating property values with boundary checks," as exploited in the wild in August 2008, aka "Masked Edit Control Memory Corruption Vulnerability."</description>
    <oval_repository>
      <dates>
        <submitted date="2008-12-09T13:31:00">
          <contributor organization="Secure Elements, Inc.">Sudhir Gandhe</contributor>
        </submitted>
        <status_change date="2008-12-12T16:42:49.009-05:00">DRAFT</status_change>
        <status_change date="2008-12-29T04:00:25.494-05:00">INTERIM</status_change>
        <status_change date="2009-01-19T04:00:10.644-05:00">ACCEPTED</status_change>
        <modified comment="EDITED oval:org.mitre.oval:def:5794 - updated by including Visual FoxPro Inventory criteria" date="2011-11-14T13:22:00.233-05:00">
          <contributor organization="SecPod Technologies">Pradeep R B</contributor>
        </modified>
        <status_change date="2011-11-14T13:23:36.384-05:00">INTERIM</status_change>
        <status_change date="2011-12-05T04:00:31.514-05:00">ACCEPTED</status_change>
        <modified comment="EDITED oval:org.mitre.oval:def:5794 - New inventory definition for VB6, and updates to definitions incorrectly checking VBA inventory instead of VB6." date="2012-10-25T16:38:00.742-04:00">
          <contributor organization="SecPod Technologies">Pradeep R B</contributor>
        </modified>
        <status_change date="2012-10-25T16:58:29.715-04:00">INTERIM</status_change>
        <status_change date="2012-11-12T04:00:33.420-05:00">ACCEPTED</status_change>
      </dates>
      <status>ACCEPTED</status>
    </oval_repository>
  </metadata>
  <criteria operator="OR">
    <criteria operator="AND" comment="Vulnerable Visual Studio .NET 2002 SP1 /2003 SP1">
      <criteria operator="OR" comment="Visual Studio .NET 2002 SP1 /2003 SP1">
        <extend_definition comment="Microsoft Visual Studio .NET 2002 SP1 is installed" definition_ref="oval:org.mitre.oval:def:981"/>
        <extend_definition comment="Microsoft Visual Studio .NET 2003 SP1 is installed" definition_ref="oval:org.mitre.oval:def:168"/>
      </criteria>
      <criterion comment="Mschrt20.ocx version is less than 6.1.98.12" test_ref="oval:org.mitre.oval:tst:9283"/>
    </criteria>
    <criteria operator="AND" comment="Vulnerable Visual Basic 6.0 or VisualFoxPro">
      <criteria operator="OR" comment="Visual Basic 6.0 or VisualFoxPro">
        <extend_definition comment="Microsoft Visual FoxPro is installed" definition_ref="oval:org.mitre.oval:def:14198"/>
        <extend_definition comment="Microsoft Visual Basic 6.0 is installed" definition_ref="oval:org.mitre.oval:def:15369"/>
      </criteria>
      <criterion comment="Mscomct2.ocx version is less than 6.1.98.12" test_ref="oval:org.mitre.oval:tst:9209"/>
    </criteria>
  </criteria>
</definition>