<?xml version="1.0" encoding="UTF-8"?>
<definition id="oval:org.mitre.oval:def:7120" version="17" class="vulnerability" xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:oval="http://oval.mitre.org/XMLSchema/oval-common-5" xmlns:oval-def="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <metadata>
    <title>LSASS Heap Overflow Vulnerability</title>
    <affected family="windows">
      <platform>Microsoft Windows XP</platform>
      <platform>Microsoft Windows Vista</platform>
      <platform>Microsoft Windows Server 2003</platform>
      <platform>Microsoft Windows Server 2008</platform>
      <platform>Microsoft Windows Server 2008 R2</platform>
    </affected>
    <reference source="CVE" ref_id="CVE-2010-0820" ref_url="http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-0820"/>
    <description>Heap-based buffer overflow in the Local Security Authority Subsystem Service (LSASS), as used in Active Directory in Microsoft Windows Server 2003 SP2 and Windows Server 2008 Gold, SP2, and R2; Active Directory Application Mode (ADAM) in Windows XP SP2 and SP3 and Windows Server 2003 SP2; and Active Directory Lightweight Directory Service (AD LDS) in Windows Vista SP2, Windows Server 2008 Gold, SP2, and R2, and Windows 7, allows remote authenticated users to execute arbitrary code via malformed LDAP messages, aka "LSASS Heap Overflow Vulnerability."</description>
    <oval_repository>
      <dates>
        <submitted date="2010-09-14T13:00:00">
          <contributor organization="Symantec Corporation">Dragos Prisaca</contributor>
        </submitted>
        <status_change date="2010-09-16T11:39:59.519-04:00">DRAFT</status_change>
        <modified comment="Replaced the tst:10696 with tst:10634 to check also for Member Servers." date="2010-09-17T14:57:00.688-04:00">
          <contributor organization="Symantec Corporation">Dragos Prisaca</contributor>
        </modified>
        <status_change date="2010-10-04T04:00:39.679-04:00">INTERIM</status_change>
        <status_change date="2010-10-25T04:00:23.034-04:00">ACCEPTED</status_change>
        <modified comment="EDITED oval:org.mitre.oval:def:7120 - Added an additional test for Windows Server 2003 platforms to test for the existence of the NT Directory Services" date="2011-04-25T14:34:00.432-04:00">
          <contributor organization="Telos">Sudhir Gandhe</contributor>
        </modified>
        <status_change date="2011-04-25T14:40:49.403-04:00">INTERIM</status_change>
        <modified comment="EDITED oval:org.mitre.oval:obj:15869 - Reverted mistaken switch of obj:717 (Service Pack) and obj:15869 (NT Directory Services)" date="2011-04-26T11:53:00.464-04:00">
          <contributor organization="G2, Inc.">Shane Shaffer</contributor>
        </modified>
        <status_change date="2011-05-16T04:03:22.853-04:00">ACCEPTED</status_change>
        <modified comment="EDITED oval:org.mitre.oval:obj:15869 - Fixed false positive when checking NTDS registry key.  Replaced withe object that checks ImagePath name." date="2011-07-08T16:56:00.948-04:00">
          <contributor organization="Hewlett-Packard">R, Yamini Mohan</contributor>
        </modified>
        <status_change date="2011-07-08T16:57:05.997-04:00">INTERIM</status_change>
        <modified comment="EDITED oval:org.mitre.oval:obj:5285 - obj:5285 is pointing to windows\system32 directory. But, adamdsa.dll file by default will be in windows\ADAM directory" date="2011-07-14T10:24:00.833-04:00">
          <contributor organization="SecPod Technologies">Sharath S</contributor>
        </modified>
        <modified comment="EDITED oval:org.mitre.oval:obj:15869 - corrected to use a valid key &amp; nil name" date="2011-07-14T10:26:00.623-04:00">
          <contributor organization="SecPod Technologies">Sharath S</contributor>
        </modified>
        <status_change date="2011-08-01T04:00:57.368-04:00">ACCEPTED</status_change>
        <status_change date="2012-03-05T14:23:46.259-05:00">INTERIM</status_change>
        <modified comment="Added Windows Server 2008 R2 platform" date="2012-03-05T14:23:46.259-05:00">
          <contributor organization="Symantec Corporation">Dragos Prisaca</contributor>
        </modified>
        <status_change date="2012-03-26T04:03:40.738-04:00">ACCEPTED</status_change>
        <modified comment="EDITED oval:org.mitre.oval:def:7120 - modified vulnerabilities which check the version of file adamdsa.dll" date="2013-12-18T16:36:00.218-05:00">
          <contributor organization="ALTX-SOFT">Maria Kedovskaya</contributor>
        </modified>
        <status_change date="2013-12-18T16:44:39.818-05:00">INTERIM</status_change>
        <status_change date="2014-01-06T04:00:48.493-05:00">ACCEPTED</status_change>
        <modified comment="EDITED oval:org.mitre.oval:tst:89195 - bulletin MS14-016, for the month of Mar 2014." date="2014-03-18T14:40:00.553-04:00">
          <contributor organization="SecPod Technologies">Pooja Shetty</contributor>
        </modified>
        <status_change date="2014-03-18T14:42:03.969-04:00">INTERIM</status_change>
        <status_change date="2014-04-07T04:06:56.758-04:00">ACCEPTED</status_change>
      </dates>
      <status>ACCEPTED</status>
      <min_schema_version>5.4</min_schema_version>
    </oval_repository>
  </metadata>
  <criteria operator="OR">
    <criteria operator="AND" comment="Vulnerable Windows XP (x86) SP3, Windows XP (x64) SP2, Windows Server 2003 x64/x86/ia64 SP2">
      <criteria operator="OR">
        <extend_definition comment="Microsoft Windows XP (x86) SP3 is installed" definition_ref="oval:org.mitre.oval:def:5631"/>
        <extend_definition comment="Microsoft Windows XP x64 Edition SP2 is installed" definition_ref="oval:org.mitre.oval:def:4193"/>
      </criteria>
      <criterion comment="Check if ADAM service is installed" test_ref="oval:org.mitre.oval:tst:89195"/>
      <criterion comment="adamdsa.dll version is less than 1.1.3790.4722" test_ref="oval:org.mitre.oval:tst:11125"/>
    </criteria>
    <criteria operator="AND" comment="Vulnerable Windows Server 2003 x64/x86/ia64 SP2">
      <criteria operator="OR">
        <extend_definition comment="Microsoft Windows Server 2003 SP2 (x86) is installed" definition_ref="oval:org.mitre.oval:def:1935"/>
        <extend_definition comment="Microsoft Windows Server 2003 SP2 (x64) is installed" definition_ref="oval:org.mitre.oval:def:2161"/>
        <extend_definition comment="Microsoft Windows Server 2003 (ia64) SP2 is installed" definition_ref="oval:org.mitre.oval:def:1442"/>
      </criteria>
      <criteria operator="OR" comment="Active Directory or ADAM">
        <criteria operator="AND">
          <criterion comment="the system is being used as: Member Server, BDC or PDC (DomainRole is 3, 4 or 5)" test_ref="oval:org.mitre.oval:tst:10634"/>
          <criterion comment="NTDS Service is installed" test_ref="oval:org.mitre.oval:tst:42615"/>
          <criterion comment="ntdsa.dll version is less than 5.2.3790.4754" test_ref="oval:org.mitre.oval:tst:11434"/>
        </criteria>
        <criteria operator="AND">
          <criterion comment="Check if ADAM service is installed" test_ref="oval:org.mitre.oval:tst:89195"/>
          <criterion comment="adamdsa.dll version is less than 1.1.3790.4722" test_ref="oval:org.mitre.oval:tst:11125"/>
        </criteria>
      </criteria>
    </criteria>
    <criteria operator="AND" comment="Vulnerable Windows Vista x86/x64 SP1, Windows Server 2008 x86/x64/ia64 SP1">
      <criteria operator="OR">
        <extend_definition comment="Microsoft Windows Vista (32-bit) Service Pack 1 is installed" definition_ref="oval:org.mitre.oval:def:4873"/>
        <extend_definition comment="Microsoft Windows Vista x64 Edition Service Pack 1 is installed" definition_ref="oval:org.mitre.oval:def:5254"/>
        <extend_definition comment="Microsoft Windows Server 2008 (32-bit) is installed" definition_ref="oval:org.mitre.oval:def:4870"/>
        <extend_definition comment="Microsoft Windows Server 2008 (64-bit) is installed" definition_ref="oval:org.mitre.oval:def:5356"/>
      </criteria>
      <criteria operator="OR" comment="GDR or LDR Service branch">
        <criterion comment="ntdsai.dll version is less than 6.0.6001.18461" test_ref="oval:org.mitre.oval:tst:10991"/>
        <criteria operator="AND" comment="LDR">
          <criterion comment="ntdsai.dll version is less than 6.0.6001.22672" test_ref="oval:org.mitre.oval:tst:11431"/>
          <criterion comment="ntdsai.dll is greater than or equal 6.0.6001.22000" test_ref="oval:org.mitre.oval:tst:10907"/>
        </criteria>
      </criteria>
    </criteria>
    <criteria operator="AND" comment="Vulnerable Microsoft Windows Vista SP2 x86/x64, Server 2008 SP2 32bit/x64/ia64">
      <criteria operator="OR">
        <extend_definition comment="Microsoft Windows Vista (32-bit) Service Pack 2 is installed" definition_ref="oval:org.mitre.oval:def:6124"/>
        <extend_definition comment="Microsoft Windows Vista x64 Edition Service Pack 2 is installed" definition_ref="oval:org.mitre.oval:def:5594"/>
        <extend_definition comment="Microsoft Windows Server 2008 (32-bit) Service Pack 2 is installed" definition_ref="oval:org.mitre.oval:def:5653"/>
        <extend_definition comment="Microsoft Windows Server 2008 x64 Edition Service Pack 2 is installed" definition_ref="oval:org.mitre.oval:def:6216"/>
        <extend_definition comment="Microsoft Windows Server 2008 Itanium-Based Edition Service Pack 2 is installed" definition_ref="oval:org.mitre.oval:def:6150"/>
      </criteria>
      <criteria operator="OR" comment="GDR or LDR Service branch">
        <criterion comment="ntdsai.dll version is less than 6.0.6002.18244" test_ref="oval:org.mitre.oval:tst:11192"/>
        <criteria operator="AND" comment="LDR">
          <criterion comment="ntdsai.dll version is less than 6.0.6002.22384" test_ref="oval:org.mitre.oval:tst:11413"/>
          <criterion comment="ntdsai.dll is greater than or equal 6.0.6002.22000" test_ref="oval:org.mitre.oval:tst:10980"/>
        </criteria>
      </criteria>
    </criteria>
    <criteria operator="AND" comment="Vulnerable Windows 7 x86/x64, Windows Server 2008 R2 x86/x64/ia64">
      <criteria operator="OR">
        <extend_definition comment="Microsoft Windows 7 (32-bit) is installed" definition_ref="oval:org.mitre.oval:def:6165"/>
        <extend_definition comment="Microsoft Windows 7 x64 Edition is installed" definition_ref="oval:org.mitre.oval:def:5950"/>
        <extend_definition comment="Microsoft Windows Server 2008 R2 x64 Edition is installed" definition_ref="oval:org.mitre.oval:def:6438"/>
        <extend_definition comment="Microsoft Windows Server 2008 R2 Itanium-Based Edition is installed" definition_ref="oval:org.mitre.oval:def:5954"/>
      </criteria>
      <criteria operator="OR" comment="GDR or LDR Service branch">
        <criterion comment="ntdsai.dll version is less than 6.1.7600.16612" test_ref="oval:org.mitre.oval:tst:11808"/>
        <criteria operator="AND" comment="LDR">
          <criterion comment="ntdsai.dll version is less than 6.1.7600.20735" test_ref="oval:org.mitre.oval:tst:11314"/>
          <criterion comment="ntdsai.dll is greater than or equal 6.1.7600.20000" test_ref="oval:org.mitre.oval:tst:11632"/>
        </criteria>
      </criteria>
    </criteria>
  </criteria>
</definition>