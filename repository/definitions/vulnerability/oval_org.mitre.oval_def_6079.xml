<definition xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5" class="vulnerability" id="oval:org.mitre.oval:def:6079" version="51">
  <metadata>
    <title>Web Services on Devices API Memory Corruption Vulnerability</title>
    <affected family="windows">
      <platform>Microsoft Windows Vista</platform>
      <platform>Microsoft Windows Server 2008</platform>
      <product>SMBv2</product>
    </affected>
    <reference ref_id="CVE-2009-2512" ref_url="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-2512" source="CVE" />
    <description>The Web Services on Devices API (WSDAPI) in Windows Vista Gold, SP1, and SP2 and Server 2008 Gold and SP2 does not properly process the headers of WSD messages, which allows remote attackers to execute arbitrary code via a crafted (1) message or (2) response, aka "Web Services on Devices API Memory Corruption Vulnerability."</description>
    <oval_repository>
      <dates>
        <submitted date="2009-11-10T13:00:00">
          <contributor organization="Gideon Technologies, Inc.">Dragos Prisaca</contributor>
        </submitted>
        <status_change date="2009-11-12T15:32:24.336-05:00">DRAFT</status_change>
        <status_change date="2009-11-30T04:00:19.351-05:00">INTERIM</status_change>
        <status_change date="2009-12-21T04:00:45.985-05:00">ACCEPTED</status_change>
      </dates>
      <status>ACCEPTED</status>
      <min_schema_version>5.10</min_schema_version>
    </oval_repository>
  </metadata>
  <criteria operator="OR">
    <criteria comment="Windows Vista x86/x64" operator="AND">
      <criteria comment="Windows Vista" operator="OR">
        <extend_definition comment="Microsoft Windows Vista (32-bit) is installed" definition_ref="oval:org.mitre.oval:def:1282" />
        <extend_definition comment="Microsoft Windows Vista x64 Edition is installed" definition_ref="oval:org.mitre.oval:def:2041" />
      </criteria>
      <criterion comment="the version of wsdapi.dll is greater than or equal 6.0.6000.16000" test_ref="oval:org.mitre.oval:tst:10814" />
      <criterion comment="the version of wsdapi.dll is less than 6.0.6000.16903" test_ref="oval:org.mitre.oval:tst:10941" />
    </criteria>
    <criteria comment="Windows Vista x86/x64" operator="AND">
      <criteria comment="Windows Vista" operator="OR">
        <extend_definition comment="Microsoft Windows Vista (32-bit) is installed" definition_ref="oval:org.mitre.oval:def:1282" />
        <extend_definition comment="Microsoft Windows Vista x64 Edition is installed" definition_ref="oval:org.mitre.oval:def:2041" />
      </criteria>
      <criterion comment="the version of wsdapi.dll is greater than or equal 6.0.6000.20000" test_ref="oval:org.mitre.oval:tst:11109" />
      <criterion comment="the version of wsdapi.dll is less than 6.0.6000.21103" test_ref="oval:org.mitre.oval:tst:10723" />
    </criteria>
    <criteria comment="Windows Vista x86/x64 SP1, Windows Server 2008 x86/x64/ia64" operator="AND">
      <criteria comment="OS section" operator="OR">
        <extend_definition comment="Microsoft Windows Vista (32-bit) Service Pack 1 is installed" definition_ref="oval:org.mitre.oval:def:4873" />
        <extend_definition comment="Microsoft Windows Vista x64 Edition Service Pack 1 is installed" definition_ref="oval:org.mitre.oval:def:5254" />
        <extend_definition comment="Microsoft Windows Server 2008 (32-bit) is installed" definition_ref="oval:org.mitre.oval:def:4870" />
        <extend_definition comment="Microsoft Windows Server 2008 (64-bit) is installed" definition_ref="oval:org.mitre.oval:def:5356" />
        <extend_definition comment="Microsoft Windows Server 2008 (ia-64) is installed" definition_ref="oval:org.mitre.oval:def:5667" />
      </criteria>
      <criterion comment="the version of wsdapi.dll is greater than or equal 6.0.6001.18000" test_ref="oval:org.mitre.oval:tst:10596" />
      <criterion comment="the version of wsdapi.dll is less than 6.0.6001.18306" test_ref="oval:org.mitre.oval:tst:10929" />
    </criteria>
    <criteria comment="Windows Vista x86/x64 SP1, Windows Server 2008 x86/x64/ia64" operator="AND">
      <criteria comment="OS section" operator="OR">
        <extend_definition comment="Microsoft Windows Vista (32-bit) Service Pack 1 is installed" definition_ref="oval:org.mitre.oval:def:4873" />
        <extend_definition comment="Microsoft Windows Vista x64 Edition Service Pack 1 is installed" definition_ref="oval:org.mitre.oval:def:5254" />
        <extend_definition comment="Microsoft Windows Server 2008 (32-bit) is installed" definition_ref="oval:org.mitre.oval:def:4870" />
        <extend_definition comment="Microsoft Windows Server 2008 (64-bit) is installed" definition_ref="oval:org.mitre.oval:def:5356" />
        <extend_definition comment="Microsoft Windows Server 2008 (ia-64) is installed" definition_ref="oval:org.mitre.oval:def:5667" />
      </criteria>
      <criterion comment="the version of wsdapi.dll is greater than or equal 6.0.6001.22000" test_ref="oval:org.mitre.oval:tst:10490" />
      <criterion comment="the version of wsdapi.dll is less than 6.0.6001.22491" test_ref="oval:org.mitre.oval:tst:10948" />
    </criteria>
    <criteria comment="Windows Vista x86/x64 SP2, Windows Server 2008 x86/x64/ia64 SP2" operator="AND">
      <criteria comment="OS section" operator="OR">
        <extend_definition comment="Microsoft Windows Vista (32-bit) Service Pack 2 is installed" definition_ref="oval:org.mitre.oval:def:6124" />
        <extend_definition comment="Microsoft Windows Vista x64 Edition Service Pack 2 is installed" definition_ref="oval:org.mitre.oval:def:5594" />
        <extend_definition comment="Microsoft Windows Server 2008 (32-bit) Service Pack 2 is installed" definition_ref="oval:org.mitre.oval:def:5653" />
        <extend_definition comment="Microsoft Windows Server 2008 x64 Edition Service Pack 2 is installed" definition_ref="oval:org.mitre.oval:def:6216" />
        <extend_definition comment="Microsoft Windows Server 2008 Itanium-Based Edition Service Pack 2 is installed" definition_ref="oval:org.mitre.oval:def:6150" />
      </criteria>
      <criterion comment="the version of wsdapi.dll is greater than or equal 6.0.6002.18000" test_ref="oval:org.mitre.oval:tst:10912" />
      <criterion comment="the version of wsdapi.dll is less than 6.0.6002.18085" test_ref="oval:org.mitre.oval:tst:10217" />
    </criteria>
    <criteria comment="Windows Vista x86/x64 SP2, Windows Server 2008 x86/x64/ia64 SP2" operator="AND">
      <criteria comment="OS section" operator="OR">
        <extend_definition comment="Microsoft Windows Vista (32-bit) Service Pack 2 is installed" definition_ref="oval:org.mitre.oval:def:6124" />
        <extend_definition comment="Microsoft Windows Vista x64 Edition Service Pack 2 is installed" definition_ref="oval:org.mitre.oval:def:5594" />
        <extend_definition comment="Microsoft Windows Server 2008 (32-bit) Service Pack 2 is installed" definition_ref="oval:org.mitre.oval:def:5653" />
        <extend_definition comment="Microsoft Windows Server 2008 x64 Edition Service Pack 2 is installed" definition_ref="oval:org.mitre.oval:def:6216" />
        <extend_definition comment="Microsoft Windows Server 2008 Itanium-Based Edition Service Pack 2 is installed" definition_ref="oval:org.mitre.oval:def:6150" />
      </criteria>
      <criterion comment="the version of wsdapi.dll is greater than or equal 6.0.6002.22000" test_ref="oval:org.mitre.oval:tst:10842" />
      <criterion comment="the version of wsdapi.dll is less than 6.0.6002.22194" test_ref="oval:org.mitre.oval:tst:10794" />
    </criteria>
  </criteria>
</definition>
