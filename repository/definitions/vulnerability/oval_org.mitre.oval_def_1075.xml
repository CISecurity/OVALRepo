<?xml version="1.0" encoding="UTF-8"?>
<definition id="oval:org.mitre.oval:def:1075" version="7" class="vulnerability">
  <metadata>
    <title>Windows XP TAPI Buffer Overflow</title>
    <affected family="windows">
      <platform>Microsoft Windows XP</platform>
      <product>Telephony Service</product>
    </affected>
    <reference source="CVE" ref_id="CVE-2005-0058" ref_url="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-0058"/>
    <description>Buffer overflow in the Telephony Application Programming Interface (TAPI) for Microsoft Windows 98, Windows 98 SE, Windows ME, Windows 2000, Windows XP, and Windows Server 2003 allows attackers elevate privileges or execute arbitrary code via a crafted message.</description>
    <oval_repository>
      <dates>
        <submitted date="2005-08-11T04:00:00.000-04:00">
          <contributor organization="The MITRE Corporation">Andrew Buttner</contributor>
        </submitted>
        <status_change date="2005-08-19T10:05:00.000-04:00">DRAFT</status_change>
        <status_change date="2005-09-21T01:33:00.000-04:00">INTERIM</status_change>
        <status_change date="2005-10-12T05:49:00.000-04:00">ACCEPTED</status_change>
        <modified comment="Updated comment to include Vista and Server 2008" date="2009-05-07T10:32:00.713-04:00">
          <contributor organization="Gideon Technologies, Inc.">Dragos Prisaca</contributor>
        </modified>
        <status_change date="2009-05-07T10:34:01.705-04:00">INTERIM</status_change>
        <status_change date="2009-05-25T04:00:42.205-04:00">ACCEPTED</status_change>
        <modified comment="Multiple corrections and update to POSIX compatibility for ste:2656" date="2010-11-29T16:12:00.873-05:00">
          <contributor organization="G2, Inc.">Shane Shaffer</contributor>
        </modified>
        <status_change date="2010-11-29T16:13:03.118-05:00">INTERIM</status_change>
        <status_change date="2010-12-20T04:00:08.511-05:00">ACCEPTED</status_change>
        <modified comment="EDITED oval:org.mitre.oval:obj:717 - Added an additional test for Windows Server 2003 platforms to test for the existence of the NT Directory Services" date="2011-04-25T14:34:00.432-04:00">
          <contributor organization="Telos">Sudhir Gandhe</contributor>
        </modified>
        <status_change date="2011-04-25T14:46:13.993-04:00">INTERIM</status_change>
        <modified comment="EDITED oval:org.mitre.oval:obj:717 - Reverted mistaken switch of obj:717 (Service Pack) and obj:15869 (NT Directory Services)" date="2011-04-26T11:53:00.464-04:00">
          <contributor organization="G2, Inc.">Shane Shaffer</contributor>
        </modified>
        <status_change date="2011-05-16T04:00:17.131-04:00">ACCEPTED</status_change>
      </dates>
      <status>ACCEPTED</status>
    </oval_repository>
  </metadata>
  <criteria operator="AND">
    <criteria operator="AND" comment="Software section">
      <criterion comment="Windows XP is installed" test_ref="oval:org.mitre.oval:tst:2838"/>
      <criteria operator="OR" comment=" a vulnerable version of tapisrv.dll exists">
        <criteria operator="AND" comment="32-bit version of windows with SP1 or earlier is installed and vulnerable version of tapisrv.dll exists">
          <criterion comment="32-Bit version of Windows is installed" test_ref="oval:org.mitre.oval:tst:2748"/>
          <criterion negate="true" comment="Win2K/XP/2003 service pack 2 (or later) is installed" test_ref="oval:org.mitre.oval:tst:2837"/>
          <criterion comment="the version of tapisrv.dll is less than 5.1.2600.1715" test_ref="oval:org.mitre.oval:tst:1195"/>
        </criteria>
        <criteria operator="AND" comment="32-bit version of windows with SP2 is installed and vulnerable version of tapisrv.dll exists">
          <criterion comment="32-Bit version of Windows is installed" test_ref="oval:org.mitre.oval:tst:2748"/>
          <criterion comment="Win2K/XP/2003/Vista/2008 Service Pack 2 is installed" test_ref="oval:org.mitre.oval:tst:3019"/>
          <criterion comment="the version of tapisrv.dll is less than 5.1.2600.2716" test_ref="oval:org.mitre.oval:tst:1194"/>
        </criteria>
        <criteria operator="AND" comment=" for 64-bit (x64 arch) Windows (gold edition) a vulnerable version of tapisrv.dll exists">
          <criterion comment="64-Bit (x64 architecture) version of Windows is installed" test_ref="oval:org.mitre.oval:tst:2744"/>
          <criterion negate="true" comment="Win2K/XP/2003 is patched" test_ref="oval:org.mitre.oval:tst:2437"/>
          <criterion comment="the version of tapisrv.dll is less than 5.2.3790.2483" test_ref="oval:org.mitre.oval:tst:1193"/>
        </criteria>
      </criteria>
      <criterion negate="true" comment="the patch kb893756 is installed (Hotfix key)" test_ref="oval:org.mitre.oval:tst:1192"/>
    </criteria>
    <criteria operator="AND" comment="Configuration section">
      <criterion comment="the Telephony service is enabled" test_ref="oval:org.mitre.oval:tst:1191"/>
    </criteria>
  </criteria>
</definition>